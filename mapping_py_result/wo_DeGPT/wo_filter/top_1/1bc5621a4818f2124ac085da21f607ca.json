{
  "FUN_140001af0_1": [],
  "FUN_140001a4c_1": [],
  "FUN_140001b10_1": [],
  "FUN_140001bf0_1": [],
  "FUN_140001c00_1": [],
  "FUN_140001c40_1": [],
  "FUN_140001f20_1": [],
  "FUN_140001c60_1": [],
  "FUN_140002060_1": [],
  "FUN_140001f80_1": [],
  "FUN_140002090_1": [],
  "FUN_140001cb0_1": [],
  "std::ctype<char>::do_tolower_1": [],
  "FUN_1400020b0_1": [],
  "FUN_1400020e0_1": [],
  "FUN_14000231f_1": [],
  "FUN_140002300_1": [],
  "FUN_1400022af_1": [],
  "FUN_140002370_1": [],
  "std::ctype<char>::`scalar_deleting_destructor'_1": [],
  "FUN_1400025d0_1": [],
  "FUN_140002630_1": [],
  "FUN_140002420_1": [],
  "FUN_1400024f0_1": [],
  "std::ios_base::`scalar_deleting_destructor'_1": [],
  "FUN_1400029b0_1": [],
  "FUN_140002d00_1": [],
  "FUN_140002aa0_1": [],
  "FUN_140002730_1": [
    {
      "ATT&CK ID": "T1055.015",
      "Indicator": "Able to visualize and control listed components (API string): Found reference to API \"SendMessageW\" (Indicator: \"sendmessage\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API \"SendMessageW\" (Indicator: \"sendmessage\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")",
      "Comment": "The function initializes and registers a custom window class named \"CertInstallerProgressBar\" with specific visual styles, icons, and a window procedure. It then creates a centered top-level window titled \"Certificate Installation\" using this class. Within this parent window, it creates a progress bar control (\"msctls_progress32\") positioned near the top-left corner. The progress bar is initialized to a starting position via a `SendMessageW` call.\n\nAfter setting up the UI elements, the function displays and updates the parent window. It then spawns a new thread to perform background work associated with the progress bar window, likely to update the progress asynchronously. Finally, the function enters a standard message loop, retrieving and dispatching window messages to handle user interactions and window events until the application terminates.\n\nKey system components involved include the Windows GUI subsystem APIs such as `InitCommonControlsEx` for initializing common controls, `RegisterClassExW` for window class registration, `CreateWindowExW` for window and control creation, `SendMessageW` for control message handling, and `CreateThread` for concurrent execution. The function uses system metrics to center the window on the screen and loads standard cursors and icons to enhance the UI. Overall, the function’s behavior centers on creating a graphical progress interface for a certificate installation process, managing its display, and handling user or system messages in a responsive manner.",
      "Matched Sentence": "The progress bar is initialized to a starting position via a `SendMessageW` call.",
      "Similarity": 0.801168
    },
    {
      "ATT&CK ID": "T1082",
      "Indicator": "Attempts to call APIs to gather system and hardware detail: \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"GetSystemMetrics\" with parameters (UID: 00000000-00003620)\n \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"GetSystemInfo\" with parameters (UID: 00000000-00003620)",
      "Comment": "The function initializes and registers a custom window class named \"CertInstallerProgressBar\" with specific visual styles, icons, and a window procedure. It then creates a centered top-level window titled \"Certificate Installation\" using this class. Within this parent window, it creates a progress bar control (\"msctls_progress32\") positioned near the top-left corner. The progress bar is initialized to a starting position via a `SendMessageW` call.\n\nAfter setting up the UI elements, the function displays and updates the parent window. It then spawns a new thread to perform background work associated with the progress bar window, likely to update the progress asynchronously. Finally, the function enters a standard message loop, retrieving and dispatching window messages to handle user interactions and window events until the application terminates.\n\nKey system components involved include the Windows GUI subsystem APIs such as `InitCommonControlsEx` for initializing common controls, `RegisterClassExW` for window class registration, `CreateWindowExW` for window and control creation, `SendMessageW` for control message handling, and `CreateThread` for concurrent execution. The function uses system metrics to center the window on the screen and loads standard cursors and icons to enhance the UI. Overall, the function’s behavior centers on creating a graphical progress interface for a certificate installation process, managing its display, and handling user or system messages in a responsive manner.",
      "Matched Sentence": "The function uses system metrics to center the window on the screen and loads standard cursors and icons to enhance the UI.",
      "Similarity": 0.792827
    }
  ],
  "FUN_140002b60_1": [],
  "FUN_1400029e0_1": [
    {
      "ATT&CK ID": "T1497.003",
      "Indicator": "Contains ability to delay the execution of current thread: Sleep@KERNEL32.dll at 40298-609-00000001400029F2\n WaitForSingleObject@KERNEL32.dll at 40298-612-0000000140002D20",
      "Comment": "The function begins by pausing execution for 3 seconds using `Sleep(3000)`, likely to delay its activity or evade immediate detection. It then calls a subroutine twice with different data pointers and parameters, capturing their return values to determine subsequent behavior. Based on these return values, it sets specific status codes (e.g., `1` or `0xd`, `2` or `0xe`) and passes them to another function, which likely handles state updates or signaling.\n\nFollowing these conditional checks and status updates, the function sequentially invokes a series of internal routines (`FUN_140002fe0`, `FUN_140004150`, `FUN_140005d80`, `FUN_140006a30`), which appear to perform further initialization or setup tasks, possibly related to system configuration, resource allocation, or preparing the environment for its main operation.\n\nFinally, the function sends a `WM_DESTROY` message (`SendMessageW(param_1, 2, 0, 0)`) to the window handle passed as a parameter, indicating it signals the closure or cleanup of a window or UI component before returning a success indicator (`1`).\n\nOverall, the function orchestrates a delayed startup sequence that performs conditional checks on specific data regions, updates internal states accordingly, executes a chain of setup routines, and then triggers a window destruction message, suggesting its role in controlled initialization and graceful shutdown or transition within a larger application or system context.",
      "Matched Sentence": "The function begins by pausing execution for 3 seconds using `Sleep(3000)`, likely to delay its activity or evade immediate detection.",
      "Similarity": 0.80859
    }
  ],
  "FUN_140002fe0_1": [],
  "FUN_140002d20_1": [
    {
      "ATT&CK ID": "T1005",
      "Indicator": "Writes files in a temp directory: \"1bc5621a4818f2124ac085da21f607ca.exe\" writes to a file \"C:\\Users\\%OSUSER%\\AppData\\Local\\Temp\\crt87D3.tmp\"\n \"1bc5621a4818f2124ac085da21f607ca.exe\" writes to a file \"C:\\Users\\%OSUSER%\\AppData\\Local\\Temp\\crt894B.tmp\"",
      "Comment": "The function creates a temporary file in the system’s temporary directory (or the current directory if the temp path retrieval fails) and writes the provided data buffer into this file. It uses `GetTempPathW` to obtain the temporary directory path and `GetTempFileNameW` to generate a unique temporary filename with a \"crt\" prefix. The file is then opened with `CreateFileW` for writing, and the input data is written using `WriteFile`. \n\nAfter successfully writing the data, the function constructs a command line string to invoke the Windows utility `certutil.exe` with the `-addstore` option, targeting either the \"root\" or \"ca\" certificate store depending on the input parameter. This command imports the temporary file as a certificate into the specified certificate store. The command is executed via `CreateProcessW` with a 20-second wait for completion, ensuring the certificate import process finishes before proceeding.\n\nFinally, the function cleans up by closing handles, deleting the temporary certificate file, and performing a security cookie check to protect against stack corruption. This behavior indicates the function’s primary objective is to install a certificate into the Windows certificate store by writing certificate data to a temporary file and invoking `certutil.exe` to perform the import.",
      "Matched Sentence": "It uses `GetTempPathW` to obtain the temporary directory path and `GetTempFileNameW` to generate a unique temporary filename with a \"crt\" prefix.",
      "Similarity": 0.858266
    },
    {
      "ATT&CK ID": "T1106",
      "Indicator": "Calls an API typically used to create a process: \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"CreateProcessW\" with parameter \"certutil.exe -f -Enterprise -addstore root \"%TEMP%\\crt87D3.tmp\"\" - (UID: 00000000-00003620)\n \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"CreateProcessW\" with parameter \"certutil.exe -f -Enterprise -addstore ca \"%TEMP%\\crt894B.tmp\"\" - (UID: 00000000-00003620)",
      "Comment": "The function creates a temporary file in the system’s temporary directory (or the current directory if the temp path retrieval fails) and writes the provided data buffer into this file. It uses `GetTempPathW` to obtain the temporary directory path and `GetTempFileNameW` to generate a unique temporary filename with a \"crt\" prefix. The file is then opened with `CreateFileW` for writing, and the input data is written using `WriteFile`. \n\nAfter successfully writing the data, the function constructs a command line string to invoke the Windows utility `certutil.exe` with the `-addstore` option, targeting either the \"root\" or \"ca\" certificate store depending on the input parameter. This command imports the temporary file as a certificate into the specified certificate store. The command is executed via `CreateProcessW` with a 20-second wait for completion, ensuring the certificate import process finishes before proceeding.\n\nFinally, the function cleans up by closing handles, deleting the temporary certificate file, and performing a security cookie check to protect against stack corruption. This behavior indicates the function’s primary objective is to install a certificate into the Windows certificate store by writing certificate data to a temporary file and invoking `certutil.exe` to perform the import.",
      "Matched Sentence": "After successfully writing the data, the function constructs a command line string to invoke the Windows utility `certutil.exe` with the `-addstore` option, targeting either the \"root\" or \"ca\" certificate store depending on the input parameter.",
      "Similarity": 0.860268
    },
    {
      "ATT&CK ID": "T1057",
      "Indicator": "Spawns new processes: Spawned process \"certutil.exe\" with commandline \"-f -Enterprise -addstore root \"%TEMP%\\\\crt87D3.tmp\"\" (UID: 00000000-00008012)\n Spawned process \"certutil.exe\" with commandline \"-f -Enterprise -addstore ca \"%TEMP%\\\\crt894B.tmp\"\" (UID: 00000000-00003800)",
      "Comment": "The function creates a temporary file in the system’s temporary directory (or the current directory if the temp path retrieval fails) and writes the provided data buffer into this file. It uses `GetTempPathW` to obtain the temporary directory path and `GetTempFileNameW` to generate a unique temporary filename with a \"crt\" prefix. The file is then opened with `CreateFileW` for writing, and the input data is written using `WriteFile`. \n\nAfter successfully writing the data, the function constructs a command line string to invoke the Windows utility `certutil.exe` with the `-addstore` option, targeting either the \"root\" or \"ca\" certificate store depending on the input parameter. This command imports the temporary file as a certificate into the specified certificate store. The command is executed via `CreateProcessW` with a 20-second wait for completion, ensuring the certificate import process finishes before proceeding.\n\nFinally, the function cleans up by closing handles, deleting the temporary certificate file, and performing a security cookie check to protect against stack corruption. This behavior indicates the function’s primary objective is to install a certificate into the Windows certificate store by writing certificate data to a temporary file and invoking `certutil.exe` to perform the import.",
      "Matched Sentence": "This command imports the temporary file as a certificate into the specified certificate store.",
      "Similarity": 0.802473
    },
    {
      "ATT&CK ID": "T1105",
      "Indicator": "Drops temp files: \"crt894B.tmp\" has type \"PEM certificate\" - Location: [%TEMP%\\crt894B.tmp]\n \"crt87D3.tmp\" has type \"PEM certificate\" - Location: [%TEMP%\\crt87D3.tmp]",
      "Comment": "The function creates a temporary file in the system’s temporary directory (or the current directory if the temp path retrieval fails) and writes the provided data buffer into this file. It uses `GetTempPathW` to obtain the temporary directory path and `GetTempFileNameW` to generate a unique temporary filename with a \"crt\" prefix. The file is then opened with `CreateFileW` for writing, and the input data is written using `WriteFile`. \n\nAfter successfully writing the data, the function constructs a command line string to invoke the Windows utility `certutil.exe` with the `-addstore` option, targeting either the \"root\" or \"ca\" certificate store depending on the input parameter. This command imports the temporary file as a certificate into the specified certificate store. The command is executed via `CreateProcessW` with a 20-second wait for completion, ensuring the certificate import process finishes before proceeding.\n\nFinally, the function cleans up by closing handles, deleting the temporary certificate file, and performing a security cookie check to protect against stack corruption. This behavior indicates the function’s primary objective is to install a certificate into the Windows certificate store by writing certificate data to a temporary file and invoking `certutil.exe` to perform the import.",
      "Matched Sentence": "Finally, the function cleans up by closing handles, deleting the temporary certificate file, and performing a security cookie check to protect against stack corruption.",
      "Similarity": 0.768256
    }
  ],
  "FUN_140002dbe_1": [],
  "FUN_140003b50_1": [
    {
      "ATT&CK ID": "T1074.001",
      "Indicator": "Contains ability to create directories: CreateDirectoryW@KERNEL32.dll at 40298-561-0000000140003B50",
      "Comment": "The function processes a wide-character string representing a file system path and attempts to create the entire directory hierarchy specified by that path. It iteratively parses the input path by locating each backslash (`\\`) delimiter to isolate individual directory components. For each directory segment, it constructs the partial path and calls `CreateDirectoryW` to create that directory if it does not already exist.\n\nThe function handles cases where directories already exist by checking the error code returned from `CreateDirectoryW` and continuing without failure if the error indicates the directory is present (`ERROR_ALREADY_EXISTS`, code 0xB7). It performs this step-by-step directory creation from the root towards the full path, ensuring all intermediate directories are created in sequence.\n\nIf any directory creation fails with an unexpected error, the function triggers error handling routines, which include calls to other internal functions (likely for logging or cleanup) and ultimately leads to a forced program termination via a software interrupt (`swi 3`).\n\nKey system interactions include:\n- Parsing and manipulating wide-character strings representing file paths.\n- Repeated calls to `CreateDirectoryW` to establish directory structures.\n- Use of `GetLastError` to verify the success or failure reason of directory creation.\n- Invocation of internal error handling functions upon failure.\n- Use of a security cookie to verify stack integrity before normal return.\n\nOverall, the function’s behavioral objective is to ensure the existence of a full directory path by creating all necessary intermediate directories, handling existing directories gracefully, and enforcing strict error handling to prevent silent failures.",
      "Matched Sentence": "The function handles cases where directories already exist by checking the error code returned from `CreateDirectoryW` and continuing without failure if the error indicates the directory is present (`ERROR_ALREADY_EXISTS`, code 0xB7).",
      "Similarity": 0.862801
    },
    {
      "ATT&CK ID": "T1074.001",
      "Indicator": "Contains ability to create directories (API string): Found reference to API \"CreateDirectoryW\" (Indicator: \"CreateDirectory\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API \"CreateDirectoryW\" (Indicator: \"CreateDirectory\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")",
      "Comment": "The function processes a wide-character string representing a file system path and attempts to create the entire directory hierarchy specified by that path. It iteratively parses the input path by locating each backslash (`\\`) delimiter to isolate individual directory components. For each directory segment, it constructs the partial path and calls `CreateDirectoryW` to create that directory if it does not already exist.\n\nThe function handles cases where directories already exist by checking the error code returned from `CreateDirectoryW` and continuing without failure if the error indicates the directory is present (`ERROR_ALREADY_EXISTS`, code 0xB7). It performs this step-by-step directory creation from the root towards the full path, ensuring all intermediate directories are created in sequence.\n\nIf any directory creation fails with an unexpected error, the function triggers error handling routines, which include calls to other internal functions (likely for logging or cleanup) and ultimately leads to a forced program termination via a software interrupt (`swi 3`).\n\nKey system interactions include:\n- Parsing and manipulating wide-character strings representing file paths.\n- Repeated calls to `CreateDirectoryW` to establish directory structures.\n- Use of `GetLastError` to verify the success or failure reason of directory creation.\n- Invocation of internal error handling functions upon failure.\n- Use of a security cookie to verify stack integrity before normal return.\n\nOverall, the function’s behavioral objective is to ensure the existence of a full directory path by creating all necessary intermediate directories, handling existing directories gracefully, and enforcing strict error handling to prevent silent failures.",
      "Matched Sentence": "It performs this step-by-step directory creation from the root towards the full path, ensuring all intermediate directories are created in sequence.",
      "Similarity": 0.78542
    }
  ],
  "FUN_140004150_1": [
    {
      "ATT&CK ID": "T1136.001",
      "Indicator": "Calls an API typically used to add a user account: \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"NetUserAdd\" (UID: 00000000-00003620)",
      "Comment": "The function constructs and manipulates wide-character strings in memory, applying XOR-based transformations to obfuscated global data before copying it into local buffers. It then prepares a `USER_INFO_1` structure with these strings and attempts to add a new user account to the system by calling the `NetUserAdd` API with level 1 information. The function handles various outcomes of this call: on success, it triggers a series of follow-up operations involving additional function calls that likely perform further configuration or persistence actions related to the newly created user. On specific error codes such as `ERROR_INVALID_PARAMETER` (0x57) or `ERROR_INVALID_LEVEL` (0x8B0), it invokes error handling routines that log or respond to these conditions. The function also performs boundary and integrity checks on the constructed strings, invoking termination or cleanup routines if suspicious conditions are detected, indicating a defensive mechanism against malformed or tampered data.\n\nOverall, the function’s primary behavioral objective is to programmatically create a new user account on the system with carefully crafted credentials or attributes derived from obfuscated data. It interacts closely with system APIs related to user management (`NetUserAdd`), performs memory and string operations to prepare the necessary data structures, and includes error handling and security checks to ensure robustness. The presence of XOR obfuscation and integrity validations suggests an attempt to conceal the user account details and protect against unauthorized modification, which may indicate a persistence mechanism or stealthy system modification.",
      "Matched Sentence": "It then prepares a `USER_INFO_1` structure with these strings and attempts to add a new user account to the system by calling the `NetUserAdd` API with level 1 information.",
      "Similarity": 0.86544
    },
    {
      "ATT&CK ID": "T1564.002",
      "Indicator": "Tries to hide user accounts: \"1bc5621a4818f2124ac085da21f607ca.exe\" (Access type: \"SETVAL\"; Path: \"HKLM\\SOFTWARE\\MICROSOFT\\WINDOWS NT\\CURRENTVERSION\\WINLOGON\\SPECIALACCOUNTS\\USERLIST\"; Key: \"UPDATUSUSER\")",
      "Comment": "The function constructs and manipulates wide-character strings in memory, applying XOR-based transformations to obfuscated global data before copying it into local buffers. It then prepares a `USER_INFO_1` structure with these strings and attempts to add a new user account to the system by calling the `NetUserAdd` API with level 1 information. The function handles various outcomes of this call: on success, it triggers a series of follow-up operations involving additional function calls that likely perform further configuration or persistence actions related to the newly created user. On specific error codes such as `ERROR_INVALID_PARAMETER` (0x57) or `ERROR_INVALID_LEVEL` (0x8B0), it invokes error handling routines that log or respond to these conditions. The function also performs boundary and integrity checks on the constructed strings, invoking termination or cleanup routines if suspicious conditions are detected, indicating a defensive mechanism against malformed or tampered data.\n\nOverall, the function’s primary behavioral objective is to programmatically create a new user account on the system with carefully crafted credentials or attributes derived from obfuscated data. It interacts closely with system APIs related to user management (`NetUserAdd`), performs memory and string operations to prepare the necessary data structures, and includes error handling and security checks to ensure robustness. The presence of XOR obfuscation and integrity validations suggests an attempt to conceal the user account details and protect against unauthorized modification, which may indicate a persistence mechanism or stealthy system modification.",
      "Matched Sentence": "The presence of XOR obfuscation and integrity validations suggests an attempt to conceal the user account details and protect against unauthorized modification, which may indicate a persistence mechanism or stealthy system modification.",
      "Similarity": 0.829982
    }
  ],
  "FUN_140005c80_1": [
    {
      "ATT&CK ID": "T1012",
      "Indicator": "Able to query registry keys (API string): Found registry query API: \"RegOpenKeyW\" in file \"1bc5621a4818f2124ac085da21f607ca\"\n Found registry query API: \"RegEnumValueW\" in file \"1bc5621a4818f2124ac085da21f607ca\"\n Found registry query API: \"RegOpenKeyExW\" in file \"1bc5621a4818f2124ac085da21f607ca\"\n Found registry query API: \"RegEnumValueW\" in \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\"\n Found registry query API: \"RegOpenKeyW\" in \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\"\n Found registry query API: \"RegOpenKeyExW\" in \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\"",
      "Comment": "The function attempts to open a specified registry key under the `HKEY_LOCAL_MACHINE` hive using `RegOpenKeyW`. If the key does not exist (indicated by an error code of 2), it creates the key with full access permissions via `RegCreateKeyExW`. Upon successfully opening or creating the key, the function sets a named value within that key using `RegSetKeyValueW`, storing a 4-byte data value provided as a parameter. Finally, it closes the registry key handle with `RegCloseKey`. Throughout this process, the function carefully handles input parameters that may be pointers to strings or structures containing strings, ensuring the correct registry path and value names are used. The primary behavioral objective is to establish or modify a registry key and value, likely for configuration or persistence purposes, by interacting directly with the Windows registry APIs under the local machine scope.",
      "Matched Sentence": "The function attempts to open a specified registry key under the `HKEY_LOCAL_MACHINE` hive using `RegOpenKeyW`.",
      "Similarity": 0.842531
    },
    {
      "ATT&CK ID": "T1112",
      "Indicator": "Able to create/load registry keys (API string): Found registry modification API: \"RegCreateKeyExW\" in file \"1bc5621a4818f2124ac085da21f607ca\"\n Found registry modification API: \"RegCreateKeyExW\" in \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\"",
      "Comment": "The function attempts to open a specified registry key under the `HKEY_LOCAL_MACHINE` hive using `RegOpenKeyW`. If the key does not exist (indicated by an error code of 2), it creates the key with full access permissions via `RegCreateKeyExW`. Upon successfully opening or creating the key, the function sets a named value within that key using `RegSetKeyValueW`, storing a 4-byte data value provided as a parameter. Finally, it closes the registry key handle with `RegCloseKey`. Throughout this process, the function carefully handles input parameters that may be pointers to strings or structures containing strings, ensuring the correct registry path and value names are used. The primary behavioral objective is to establish or modify a registry key and value, likely for configuration or persistence purposes, by interacting directly with the Windows registry APIs under the local machine scope.",
      "Matched Sentence": "If the key does not exist (indicated by an error code of 2), it creates the key with full access permissions via `RegCreateKeyExW`.",
      "Similarity": 0.830969
    },
    {
      "ATT&CK ID": "T1112",
      "Indicator": "Contains ability to disable/close registry key (API string): Found reference to API \"RegCloseKey\" (Indicator: \"RegCloseKey\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API \"RegCloseKey\" (Indicator: \"RegCloseKey\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")",
      "Comment": "The function attempts to open a specified registry key under the `HKEY_LOCAL_MACHINE` hive using `RegOpenKeyW`. If the key does not exist (indicated by an error code of 2), it creates the key with full access permissions via `RegCreateKeyExW`. Upon successfully opening or creating the key, the function sets a named value within that key using `RegSetKeyValueW`, storing a 4-byte data value provided as a parameter. Finally, it closes the registry key handle with `RegCloseKey`. Throughout this process, the function carefully handles input parameters that may be pointers to strings or structures containing strings, ensuring the correct registry path and value names are used. The primary behavioral objective is to establish or modify a registry key and value, likely for configuration or persistence purposes, by interacting directly with the Windows registry APIs under the local machine scope.",
      "Matched Sentence": "Finally, it closes the registry key handle with `RegCloseKey`.",
      "Similarity": 0.824541
    }
  ],
  "FUN_140003990_1": [
    {
      "ATT&CK ID": "T1083",
      "Indicator": "Contains ability to retrieve file and directory information (API string): Found reference to API \"GetFileAttributesW\" (Indicator: \"GetFileAttributes\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API \"GetTempPathW\" (Indicator: \"GetTempPath\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API \"GetTempFileNameW\" (Indicator: \"GetTempFileName\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API \"GetFileInformationByHandleEx\" (Indicator: \"GetFileInformationByHandle\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API \"GetFileInformationByHandleEx\" (Indicator: \"GetFileInformationByHandle\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API \"GetTempPathW\" (Indicator: \"GetTempPath\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API \"GetFileAttributesW\" (Indicator: \"GetFileAttributes\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API \"GetTempFileNameW\" (Indicator: \"GetTempFileName\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")",
      "Comment": "The function begins by performing an XOR-based transformation on several global or static variables, likely as a form of simple obfuscation or state modification. It then calls another function (`FUN_1400081f0`) passing the input parameter and a transformed value, possibly to initialize or process some data structure.\n\nNext, the function determines a file path to check: if a certain length field at offset 0xC in the input structure exceeds 7, it uses a pointer stored at the start of the input parameter as the path; otherwise, it uses the input parameter itself. It then calls `GetFileAttributesW` on this path to check the existence and attributes of the file or directory.\n\nIf `GetFileAttributesW` returns `INVALID_FILE_ATTRIBUTES` (0xFFFFFFFF), indicating the file or directory does not exist or is inaccessible, the function retrieves the last error code. If the error code is greater than 3 (i.e., not `ERROR_FILE_NOT_FOUND` or `ERROR_PATH_NOT_FOUND`), it logs or processes an error message by calling `FUN_140001b60` and `FUN_14000c234` with specific parameters, then triggers a software interrupt (`swi 3`), which likely causes a breakpoint or program termination.\n\nIf the error code is 2 or less, it calls `FUN_140003b50` with the original parameter, possibly to handle the missing file scenario gracefully.\n\nIf the file attributes are valid but the path does not point to a directory (checked by testing the `FILE_ATTRIBUTE_DIRECTORY` flag), the function again logs or processes an error and triggers the software interrupt, terminating execution.\n\nIf the path exists and is a directory, the function simply returns the original input parameter.\n\nIn summary, this function validates that a given path (either directly from the input or indirectly via a pointer) exists and is a directory. It uses `GetFileAttributesW` to perform this check and handles error conditions by logging messages and terminating execution via a software interrupt. The function’s behavior centers on path validation and error handling, ensuring that the input corresponds to an accessible directory before proceeding.",
      "Matched Sentence": "It then calls `GetFileAttributesW` on this path to check the existence and attributes of the file or directory.",
      "Similarity": 0.849966
    }
  ],
  "FUN_140004720_1": [
    {
      "ATT&CK ID": "T1134.001",
      "Indicator": "Imports system security related APIs: Observed import api \"CreateWellKnownSid\" which can \"create a SID for predefined aliases\" [Source: 1bc5621a4818f2124ac085da21f607ca]",
      "Comment": "The function attempts to create and manipulate a security identifier (SID) representing the built-in Administrators group on a Windows system. It begins by calling `CreateWellKnownSid` with the `WinBuiltinAdministratorsSid` constant to obtain the size required for the SID buffer. If the initial call indicates the buffer is too small, it allocates the necessary memory using `NetApiBufferAllocate` and calls `CreateWellKnownSid` again to retrieve the actual SID.\n\nOnce the SID is successfully created, the function initializes several variables and uses `LookupAccountSidW` to query the account name and domain associated with the SID. It carefully manages buffer sizes and ensures that the buffers are large enough to hold the returned strings, resizing them if necessary by invoking a helper function (`FUN_140008520`) to handle buffer expansion and zero-filling.\n\nThe function then copies and null-terminates the retrieved account name and domain strings, ensuring proper string termination to prevent buffer overflows or data corruption. It performs a second call to `LookupAccountSidW` to actually retrieve the account name and domain into the prepared buffers.\n\nIf any of the API calls fail, the function frees allocated memory using `NetApiBufferFree` to avoid memory leaks. It also includes security cookie checks to detect stack corruption before returning.\n\nOverall, the function’s behavior centers on securely obtaining and preparing the SID and corresponding account information for the built-in Administrators group. It interacts primarily with Windows security APIs (`CreateWellKnownSid`, `LookupAccountSidW`), memory management APIs (`NetApiBufferAllocate`, `NetApiBufferFree`), and performs careful buffer management and string handling to safely retrieve and store account-related data. This functionality is typically used in scenarios requiring verification or manipulation of administrative privileges or access control.",
      "Matched Sentence": "It begins by calling `CreateWellKnownSid` with the `WinBuiltinAdministratorsSid` constant to obtain the size required for the SID buffer.",
      "Similarity": 0.840023
    },
    {
      "ATT&CK ID": "T1033",
      "Indicator": "Calls an API typically used to retrieve account information for specified SID: \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"LookupAccountSidW\" (UID: 00000000-00003620)\n \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"LookupAccountSidW\" with param Name Administrators (UID: 00000000-00003620)",
      "Comment": "The function attempts to create and manipulate a security identifier (SID) representing the built-in Administrators group on a Windows system. It begins by calling `CreateWellKnownSid` with the `WinBuiltinAdministratorsSid` constant to obtain the size required for the SID buffer. If the initial call indicates the buffer is too small, it allocates the necessary memory using `NetApiBufferAllocate` and calls `CreateWellKnownSid` again to retrieve the actual SID.\n\nOnce the SID is successfully created, the function initializes several variables and uses `LookupAccountSidW` to query the account name and domain associated with the SID. It carefully manages buffer sizes and ensures that the buffers are large enough to hold the returned strings, resizing them if necessary by invoking a helper function (`FUN_140008520`) to handle buffer expansion and zero-filling.\n\nThe function then copies and null-terminates the retrieved account name and domain strings, ensuring proper string termination to prevent buffer overflows or data corruption. It performs a second call to `LookupAccountSidW` to actually retrieve the account name and domain into the prepared buffers.\n\nIf any of the API calls fail, the function frees allocated memory using `NetApiBufferFree` to avoid memory leaks. It also includes security cookie checks to detect stack corruption before returning.\n\nOverall, the function’s behavior centers on securely obtaining and preparing the SID and corresponding account information for the built-in Administrators group. It interacts primarily with Windows security APIs (`CreateWellKnownSid`, `LookupAccountSidW`), memory management APIs (`NetApiBufferAllocate`, `NetApiBufferFree`), and performs careful buffer management and string handling to safely retrieve and store account-related data. This functionality is typically used in scenarios requiring verification or manipulation of administrative privileges or access control.",
      "Matched Sentence": "Once the SID is successfully created, the function initializes several variables and uses `LookupAccountSidW` to query the account name and domain associated with the SID.",
      "Similarity": 0.850673
    },
    {
      "ATT&CK ID": "T1033",
      "Indicator": "Contains ability to retrieve usernames and/or user information (API string): Found reference to API \"LookupAccountSidW\" (Indicator: \"LookupAccountSid\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API \"NetUserGetInfo\" (Indicator: \"NetUserGetInfo\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API \"NetUserGetInfo\" (Indicator: \"NetUserGetInfo\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API \"LookupAccountSidW\" (Indicator: \"LookupAccountSid\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")",
      "Comment": "The function attempts to create and manipulate a security identifier (SID) representing the built-in Administrators group on a Windows system. It begins by calling `CreateWellKnownSid` with the `WinBuiltinAdministratorsSid` constant to obtain the size required for the SID buffer. If the initial call indicates the buffer is too small, it allocates the necessary memory using `NetApiBufferAllocate` and calls `CreateWellKnownSid` again to retrieve the actual SID.\n\nOnce the SID is successfully created, the function initializes several variables and uses `LookupAccountSidW` to query the account name and domain associated with the SID. It carefully manages buffer sizes and ensures that the buffers are large enough to hold the returned strings, resizing them if necessary by invoking a helper function (`FUN_140008520`) to handle buffer expansion and zero-filling.\n\nThe function then copies and null-terminates the retrieved account name and domain strings, ensuring proper string termination to prevent buffer overflows or data corruption. It performs a second call to `LookupAccountSidW` to actually retrieve the account name and domain into the prepared buffers.\n\nIf any of the API calls fail, the function frees allocated memory using `NetApiBufferFree` to avoid memory leaks. It also includes security cookie checks to detect stack corruption before returning.\n\nOverall, the function’s behavior centers on securely obtaining and preparing the SID and corresponding account information for the built-in Administrators group. It interacts primarily with Windows security APIs (`CreateWellKnownSid`, `LookupAccountSidW`), memory management APIs (`NetApiBufferAllocate`, `NetApiBufferFree`), and performs careful buffer management and string handling to safely retrieve and store account-related data. This functionality is typically used in scenarios requiring verification or manipulation of administrative privileges or access control.",
      "Matched Sentence": "It interacts primarily with Windows security APIs (`CreateWellKnownSid`, `LookupAccountSidW`), memory management APIs (`NetApiBufferAllocate`, `NetApiBufferFree`), and performs careful buffer management and string handling to safely retrieve and store account-related data.",
      "Similarity": 0.840765
    },
    {
      "ATT&CK ID": "T1112",
      "Indicator": "Tries to disable UAC remote restrictions: \"1bc5621a4818f2124ac085da21f607ca.exe\" (Path: \"HKLM\\SOFTWARE\\MICROSOFT\\WINDOWS\\CURRENTVERSION\\POLICIES\\SYSTEM\"; Key: \"LOCALACCOUNTTOKENFILTERPOLICY\"; Value: \"01000000\")",
      "Comment": "The function attempts to create and manipulate a security identifier (SID) representing the built-in Administrators group on a Windows system. It begins by calling `CreateWellKnownSid` with the `WinBuiltinAdministratorsSid` constant to obtain the size required for the SID buffer. If the initial call indicates the buffer is too small, it allocates the necessary memory using `NetApiBufferAllocate` and calls `CreateWellKnownSid` again to retrieve the actual SID.\n\nOnce the SID is successfully created, the function initializes several variables and uses `LookupAccountSidW` to query the account name and domain associated with the SID. It carefully manages buffer sizes and ensures that the buffers are large enough to hold the returned strings, resizing them if necessary by invoking a helper function (`FUN_140008520`) to handle buffer expansion and zero-filling.\n\nThe function then copies and null-terminates the retrieved account name and domain strings, ensuring proper string termination to prevent buffer overflows or data corruption. It performs a second call to `LookupAccountSidW` to actually retrieve the account name and domain into the prepared buffers.\n\nIf any of the API calls fail, the function frees allocated memory using `NetApiBufferFree` to avoid memory leaks. It also includes security cookie checks to detect stack corruption before returning.\n\nOverall, the function’s behavior centers on securely obtaining and preparing the SID and corresponding account information for the built-in Administrators group. It interacts primarily with Windows security APIs (`CreateWellKnownSid`, `LookupAccountSidW`), memory management APIs (`NetApiBufferAllocate`, `NetApiBufferFree`), and performs careful buffer management and string handling to safely retrieve and store account-related data. This functionality is typically used in scenarios requiring verification or manipulation of administrative privileges or access control.",
      "Matched Sentence": "This functionality is typically used in scenarios requiring verification or manipulation of administrative privileges or access control.",
      "Similarity": 0.781887
    }
  ],
  "FUN_140004460_1": [
    {
      "ATT&CK ID": "T1087.001",
      "Indicator": "Imports network management related APIs: Observed import api \"NetGroupGetInfo\" which can \"retrieve information about a particular global group in the security database.\" [Source: 1bc5621a4818f2124ac085da21f607ca]\n Observed import api \"NetLocalGroupAdd\" which can \"create a local group in the security database.\" [Source: 1bc5621a4818f2124ac085da21f607ca]\n Observed import api \"NetUserAdd\" which can \"add a user account and assigns a password and privilege level.\" [Source: 1bc5621a4818f2124ac085da21f607ca]\n Observed import api \"NetUserGetGroups\" which can \"retrieve a list of global groups to which a specified user belongs.\" [Source: 1bc5621a4818f2124ac085da21f607ca]\n Observed import api \"NetUserGetInfo\" which can \"retrieve information about a particular user account on a server.\" [Source: 1bc5621a4818f2124ac085da21f607ca]",
      "Comment": "The function primarily interacts with Windows network management APIs to query and manipulate user group memberships. It begins by invoking a helper function to initialize or retrieve a username or identifier stored in a local wide-character buffer. Using this identifier, the function calls `NetUserGetGroups` to obtain the list of global groups associated with the specified user account.\n\nIt then iterates over each group retrieved, calling `NetGroupGetInfo` to fetch detailed information about each group, specifically at information level 3, which includes group names. The function performs string comparisons on these group names against the initially obtained identifier, using custom logic to determine if the user belongs to a particular group of interest. If a match is found, it triggers a specific action via a call to another internal function and immediately frees the allocated buffers using `NetApiBufferFree` to release system resources.\n\nAfter processing all groups, the function calls `NetUserGetInfo` at information level 4 to retrieve additional user information, including the user's security identifier (SID). It then attempts to add the user to a local group by calling `NetLocalGroupAddMember`, passing the local group name and the user's SID. This step suggests the function aims to modify local group memberships, potentially to escalate privileges or establish persistence.\n\nThroughout its execution, the function carefully manages memory by freeing buffers allocated by the network APIs. It also includes security checks to detect stack corruption before returning. The control flow is driven by conditional checks on API call success and loops iterating over group entries.\n\nIn summary, the function’s behavioral objective is to inspect a user’s global group memberships, compare them against a target group, and if conditions are met, add the user to a local group. This involves querying network user and group information, performing string comparisons on group names, and modifying local group memberships, indicating a focus on privilege manipulation or access control modification within the Windows environment.",
      "Matched Sentence": "The function primarily interacts with Windows network management APIs to query and manipulate user group memberships.",
      "Similarity": 0.837253
    },
    {
      "ATT&CK ID": "T1087.001",
      "Indicator": "Contains ability to retrieve information about user accounts on a server (API string): Found reference to API \"NetUserGetInfo\" (Indicator: \"NetUserGetInfo\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API \"NetGroupGetInfo\" (Indicator: \"NetGroupGetInfo\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API \"NetUserGetGroups\" (Indicator: \"NetUserGetGroups\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API \"NetUserGetGroups\" (Indicator: \"NetUserGetGroups\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API \"NetGroupGetInfo\" (Indicator: \"NetGroupGetInfo\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API \"NetUserGetInfo\" (Indicator: \"NetUserGetInfo\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")",
      "Comment": "The function primarily interacts with Windows network management APIs to query and manipulate user group memberships. It begins by invoking a helper function to initialize or retrieve a username or identifier stored in a local wide-character buffer. Using this identifier, the function calls `NetUserGetGroups` to obtain the list of global groups associated with the specified user account.\n\nIt then iterates over each group retrieved, calling `NetGroupGetInfo` to fetch detailed information about each group, specifically at information level 3, which includes group names. The function performs string comparisons on these group names against the initially obtained identifier, using custom logic to determine if the user belongs to a particular group of interest. If a match is found, it triggers a specific action via a call to another internal function and immediately frees the allocated buffers using `NetApiBufferFree` to release system resources.\n\nAfter processing all groups, the function calls `NetUserGetInfo` at information level 4 to retrieve additional user information, including the user's security identifier (SID). It then attempts to add the user to a local group by calling `NetLocalGroupAddMember`, passing the local group name and the user's SID. This step suggests the function aims to modify local group memberships, potentially to escalate privileges or establish persistence.\n\nThroughout its execution, the function carefully manages memory by freeing buffers allocated by the network APIs. It also includes security checks to detect stack corruption before returning. The control flow is driven by conditional checks on API call success and loops iterating over group entries.\n\nIn summary, the function’s behavioral objective is to inspect a user’s global group memberships, compare them against a target group, and if conditions are met, add the user to a local group. This involves querying network user and group information, performing string comparisons on group names, and modifying local group memberships, indicating a focus on privilege manipulation or access control modification within the Windows environment.",
      "Matched Sentence": "After processing all groups, the function calls `NetUserGetInfo` at information level 4 to retrieve additional user information, including the user's security identifier (SID).",
      "Similarity": 0.822966
    },
    {
      "ATT&CK ID": "T1098",
      "Indicator": "Contains ability to add users to a group (API string): Found reference to API \"NetLocalGroupAddMember\" (Indicator: \"NetLocalGroupAdd\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API \"NetLocalGroupAddMember\" (Indicator: \"NetLocalGroupAdd\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")",
      "Comment": "The function primarily interacts with Windows network management APIs to query and manipulate user group memberships. It begins by invoking a helper function to initialize or retrieve a username or identifier stored in a local wide-character buffer. Using this identifier, the function calls `NetUserGetGroups` to obtain the list of global groups associated with the specified user account.\n\nIt then iterates over each group retrieved, calling `NetGroupGetInfo` to fetch detailed information about each group, specifically at information level 3, which includes group names. The function performs string comparisons on these group names against the initially obtained identifier, using custom logic to determine if the user belongs to a particular group of interest. If a match is found, it triggers a specific action via a call to another internal function and immediately frees the allocated buffers using `NetApiBufferFree` to release system resources.\n\nAfter processing all groups, the function calls `NetUserGetInfo` at information level 4 to retrieve additional user information, including the user's security identifier (SID). It then attempts to add the user to a local group by calling `NetLocalGroupAddMember`, passing the local group name and the user's SID. This step suggests the function aims to modify local group memberships, potentially to escalate privileges or establish persistence.\n\nThroughout its execution, the function carefully manages memory by freeing buffers allocated by the network APIs. It also includes security checks to detect stack corruption before returning. The control flow is driven by conditional checks on API call success and loops iterating over group entries.\n\nIn summary, the function’s behavioral objective is to inspect a user’s global group memberships, compare them against a target group, and if conditions are met, add the user to a local group. This involves querying network user and group information, performing string comparisons on group names, and modifying local group memberships, indicating a focus on privilege manipulation or access control modification within the Windows environment.",
      "Matched Sentence": "It then attempts to add the user to a local group by calling `NetLocalGroupAddMember`, passing the local group name and the user's SID.",
      "Similarity": 0.841458
    },
    {
      "ATT&CK ID": "T1016",
      "Indicator": "Contains ability to free the memory used by network management functions (API string): Found reference to API \"NetApiBufferFree\" (Indicator: \"NetApiBufferFree\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API \"NetApiBufferFree\" (Indicator: \"NetApiBufferFree\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")",
      "Comment": "The function primarily interacts with Windows network management APIs to query and manipulate user group memberships. It begins by invoking a helper function to initialize or retrieve a username or identifier stored in a local wide-character buffer. Using this identifier, the function calls `NetUserGetGroups` to obtain the list of global groups associated with the specified user account.\n\nIt then iterates over each group retrieved, calling `NetGroupGetInfo` to fetch detailed information about each group, specifically at information level 3, which includes group names. The function performs string comparisons on these group names against the initially obtained identifier, using custom logic to determine if the user belongs to a particular group of interest. If a match is found, it triggers a specific action via a call to another internal function and immediately frees the allocated buffers using `NetApiBufferFree` to release system resources.\n\nAfter processing all groups, the function calls `NetUserGetInfo` at information level 4 to retrieve additional user information, including the user's security identifier (SID). It then attempts to add the user to a local group by calling `NetLocalGroupAddMember`, passing the local group name and the user's SID. This step suggests the function aims to modify local group memberships, potentially to escalate privileges or establish persistence.\n\nThroughout its execution, the function carefully manages memory by freeing buffers allocated by the network APIs. It also includes security checks to detect stack corruption before returning. The control flow is driven by conditional checks on API call success and loops iterating over group entries.\n\nIn summary, the function’s behavioral objective is to inspect a user’s global group memberships, compare them against a target group, and if conditions are met, add the user to a local group. This involves querying network user and group information, performing string comparisons on group names, and modifying local group memberships, indicating a focus on privilege manipulation or access control modification within the Windows environment.",
      "Matched Sentence": "Throughout its execution, the function carefully manages memory by freeing buffers allocated by the network APIs.",
      "Similarity": 0.834694
    },
    {
      "ATT&CK ID": "T1069.002",
      "Indicator": "Able to enumerate permission groups in the domain: Found reference string \"NetGroupGetInfo\" (Indicator: \"netgroupgetinfo\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference string \"NetUserGetGroups\" (Indicator: \"netusergetgroups\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference string \"NetUserGetGroups\" (Indicator: \"netusergetgroups\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference string \"NetGroupGetInfo\" (Indicator: \"netgroupgetinfo\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")",
      "Comment": "The function primarily interacts with Windows network management APIs to query and manipulate user group memberships. It begins by invoking a helper function to initialize or retrieve a username or identifier stored in a local wide-character buffer. Using this identifier, the function calls `NetUserGetGroups` to obtain the list of global groups associated with the specified user account.\n\nIt then iterates over each group retrieved, calling `NetGroupGetInfo` to fetch detailed information about each group, specifically at information level 3, which includes group names. The function performs string comparisons on these group names against the initially obtained identifier, using custom logic to determine if the user belongs to a particular group of interest. If a match is found, it triggers a specific action via a call to another internal function and immediately frees the allocated buffers using `NetApiBufferFree` to release system resources.\n\nAfter processing all groups, the function calls `NetUserGetInfo` at information level 4 to retrieve additional user information, including the user's security identifier (SID). It then attempts to add the user to a local group by calling `NetLocalGroupAddMember`, passing the local group name and the user's SID. This step suggests the function aims to modify local group memberships, potentially to escalate privileges or establish persistence.\n\nThroughout its execution, the function carefully manages memory by freeing buffers allocated by the network APIs. It also includes security checks to detect stack corruption before returning. The control flow is driven by conditional checks on API call success and loops iterating over group entries.\n\nIn summary, the function’s behavioral objective is to inspect a user’s global group memberships, compare them against a target group, and if conditions are met, add the user to a local group. This involves querying network user and group information, performing string comparisons on group names, and modifying local group memberships, indicating a focus on privilege manipulation or access control modification within the Windows environment.",
      "Matched Sentence": "This involves querying network user and group information, performing string comparisons on group names, and modifying local group memberships, indicating a focus on privilege manipulation or access control modification within the Windows environment.",
      "Similarity": 0.842101
    }
  ],
  "FUN_1400064f0_1": [
    {
      "ATT&CK ID": "T1012",
      "Indicator": "Checks warning level of secure to non-secure traffic redirection: \"1bc5621a4818f2124ac085da21f607ca.exe\" (Path: \"HKCU\\SOFTWARE\\MICROSOFT\\WINDOWS\\CURRENTVERSION\\INTERNET SETTINGS\"; Key: \"WARNONHTTPSTOHTTPREDIRECT\")",
      "Comment": "The function processes an input byte array and a length parameter to construct and manipulate internal data structures, likely representing serialized or encoded data. It begins by initializing a fixed-size buffer and related structures, then iterates over the input bytes, performing repeated transformations and appending operations on a dynamically managed buffer. This involves calls to internal helper functions that appear to handle memory allocation, buffer resizing, and data encoding or formatting.\n\nAfter processing the input array, the function accesses global or static data pointers and conditionally copies memory regions based on bitmask flags and pointer comparisons. It uses these pointers to determine the size and source of data to copy into a local structure, ensuring that the copied data respects certain size constraints. The function then performs integrity or boundary checks on the resulting data buffers, invoking security or validation routines to prevent buffer overflows or memory corruption. If these checks fail, it triggers a controlled exception to halt execution.\n\nFinally, the function updates the caller-provided structure with pointers and size information reflecting the newly constructed data buffer. It cleans up allocated resources before returning, ensuring no memory leaks occur. Throughout its execution, the function relies on low-level memory operations and custom buffer management routines, indicating its role in preparing or validating serialized data blocks, possibly for cryptographic, compression, or inter-process communication purposes.",
      "Matched Sentence": "If these checks fail, it triggers a controlled exception to halt execution.",
      "Similarity": 0.751997
    }
  ],
  "FUN_140005d80_1": [
    {
      "ATT&CK ID": "T1012",
      "Indicator": "Queries TCP/IP interface details: \"1bc5621a4818f2124ac085da21f607ca.exe\" (Access type: \"QUERY\"; Path: \"HKLM\\SYSTEM\\CONTROLSET001\\SERVICES\\TCPIP\\PARAMETERS\\INTERFACES\"; Key: \"\"; Value: \"\")\n \"1bc5621a4818f2124ac085da21f607ca.exe\" (Access type: \"QUERYVAL\"; Path: \"HKLM\\SYSTEM\\CONTROLSET001\\SERVICES\\TCPIP\\PARAMETERS\\INTERFACES\\{D27478B9-2058-11E8-B41F-806E6F6E6963}\"; Key: \"ENABLEDHCP\"; Value: \"\")\n \"1bc5621a4818f2124ac085da21f607ca.exe\" (Access type: \"QUERYVAL\"; Path: \"HKLM\\SYSTEM\\CONTROLSET001\\SERVICES\\TCPIP\\PARAMETERS\\INTERFACES\\{D03DB0C1-2729-4674-A875-8625DD784300}\"; Key: \"REGISTRATIONENABLED\"; Value: \"\")\n \"1bc5621a4818f2124ac085da21f607ca.exe\" (Access type: \"QUERYVAL\"; Path: \"HKLM\\SYSTEM\\CONTROLSET001\\SERVICES\\TCPIP\\PARAMETERS\\INTERFACES\\{D03DB0C1-2729-4674-A875-8625DD784300}\"; Key: \"REGISTERADAPTERNAME\"; Value: \"\")\n \"1bc5621a4818f2124ac085da21f607ca.exe\" (Access type: \"QUERYVAL\"; Path: \"HKLM\\SYSTEM\\CONTROLSET001\\SERVICES\\TCPIP\\PARAMETERS\\INTERFACES\\{D03DB0C1-2729-4674-A875-8625DD784300}\"; Key: \"DOMAIN\"; Value: \"\")\n \"1bc5621a4818f2124ac085da21f607ca.exe\" (Access type: \"QUERYVAL\"; Path: \"HKLM\\SYSTEM\\CONTROLSET001\\SERVICES\\TCPIP\\PARAMETERS\\INTERFACES\\{D03DB0C1-2729-4674-A875-8625DD784300}\"; Key: \"DHCPDOMAIN\"; Value: \"\")\n \"1bc5621a4818f2124ac085da21f607ca.exe\" (Access type: \"QUERYVAL\"; Path: \"HKLM\\SYSTEM\\CONTROLSET001\\SERVICES\\TCPIP\\PARAMETERS\\INTERFACES\\{D27478B9-2058-11E8-B41F-806E6F6E6963}\"; Key: \"REGISTRATIONENABLED\"; Value: \"\")\n \"1bc5621a4818f2124ac085da21f607ca.exe\" (Access type: \"QUERYVAL\"; Path: \"HKLM\\SYSTEM\\CONTROLSET001\\SERVICES\\TCPIP\\PARAMETERS\\INTERFACES\\{D27478B9-2058-11E8-B41F-806E6F6E6963}\"; Key: \"REGISTERADAPTERNAME\"; Value: \"\")\n \"1bc5621a4818f2124ac085da21f607ca.exe\" (Access type: \"QUERYVAL\"; Path: \"HKLM\\SYSTEM\\CONTROLSET001\\SERVICES\\TCPIP\\PARAMETERS\\INTERFACES\\{D27478B9-2058-11E8-B41F-806E6F6E6963}\"; Key: \"DOMAIN\"; Value: \"\")\n \"1bc5621a4818f2124ac085da21f607ca.exe\" (Access type: \"QUERYVAL\"; Path: \"HKLM\\SYSTEM\\CONTROLSET001\\SERVICES\\TCPIP\\PARAMETERS\\INTERFACES\\{D27478B9-2058-11E8-B41F-806E6F6E6963}\"; Key: \"DHCPDOMAIN\"; Value: \"\")",
      "Comment": "The function primarily interacts with the Windows network configuration APIs to retrieve and process the system’s IP address table and network interface information. It begins by calling `GetIpAddrTable` to determine the required buffer size for the IP address table. Upon receiving the size, it allocates memory dynamically to hold the IP address entries and calls `GetIpAddrTable` again to populate this buffer.\n\nThe function then iterates over each IP address entry in the table. For each entry, it performs a series of data transformations and buffer preparations, likely formatting or encoding the IP address and related data into internal buffers. It calls `GetIfEntry` with a prepared structure to retrieve detailed information about the corresponding network interface.\n\nThroughout the iteration, the function uses custom helper routines to manipulate and concatenate data buffers, ensuring that the collected network information is aggregated into larger composite buffers. These buffers appear to be carefully sized and checked to prevent overflow, with multiple conditional checks enforcing size constraints and triggering error handling or termination if limits are exceeded.\n\nIf any call to `GetIpAddrTable` fails with an unexpected error code, the function logs or reports the error via a dedicated error-handling routine. After processing all entries, it performs cleanup of allocated memory and final security checks before returning.\n\nOverall, the function’s behavior centers on enumerating the system’s network interfaces and IP addresses, collecting detailed interface data, and assembling this information into structured buffers. This suggests its role is to gather comprehensive network configuration data, potentially for diagnostic, monitoring, or telemetry purposes. The use of low-level Windows IP helper APIs (`GetIpAddrTable`, `GetIfEntry`), dynamic memory allocation, and careful buffer management highlights its focus on precise and robust network data collection.",
      "Matched Sentence": "The function primarily interacts with the Windows network configuration APIs to retrieve and process the system’s IP address table and network interface information.",
      "Similarity": 0.817873
    },
    {
      "ATT&CK ID": "T1071",
      "Indicator": "Found potential IP address in binary/memory: Potential IP \"192.168.0.2\" found in string \"192.168.0.2 0-0P-0V-0-0v-0127.0.0.1\"\n Potential IP \"192.168.0.2\" found in string \"192.168.0.2 0\"\n \"127.0.0.1\"",
      "Comment": "The function primarily interacts with the Windows network configuration APIs to retrieve and process the system’s IP address table and network interface information. It begins by calling `GetIpAddrTable` to determine the required buffer size for the IP address table. Upon receiving the size, it allocates memory dynamically to hold the IP address entries and calls `GetIpAddrTable` again to populate this buffer.\n\nThe function then iterates over each IP address entry in the table. For each entry, it performs a series of data transformations and buffer preparations, likely formatting or encoding the IP address and related data into internal buffers. It calls `GetIfEntry` with a prepared structure to retrieve detailed information about the corresponding network interface.\n\nThroughout the iteration, the function uses custom helper routines to manipulate and concatenate data buffers, ensuring that the collected network information is aggregated into larger composite buffers. These buffers appear to be carefully sized and checked to prevent overflow, with multiple conditional checks enforcing size constraints and triggering error handling or termination if limits are exceeded.\n\nIf any call to `GetIpAddrTable` fails with an unexpected error code, the function logs or reports the error via a dedicated error-handling routine. After processing all entries, it performs cleanup of allocated memory and final security checks before returning.\n\nOverall, the function’s behavior centers on enumerating the system’s network interfaces and IP addresses, collecting detailed interface data, and assembling this information into structured buffers. This suggests its role is to gather comprehensive network configuration data, potentially for diagnostic, monitoring, or telemetry purposes. The use of low-level Windows IP helper APIs (`GetIpAddrTable`, `GetIfEntry`), dynamic memory allocation, and careful buffer management highlights its focus on precise and robust network data collection.",
      "Matched Sentence": "For each entry, it performs a series of data transformations and buffer preparations, likely formatting or encoding the IP address and related data into internal buffers.",
      "Similarity": 0.766007
    }
  ],
  "FUN_140006857_1": [
    {
      "ATT&CK ID": "T1132",
      "Indicator": "PCAP contains base64 strings: Contains base64 encoded string \"DQAAAAAAAAAOAAAAAAAAABMAAAAIAAAABAAAAAIAAAAIAAAAAAAAAA==\" in [Source : PCAP]",
      "Comment": "The function implements a Base64 encoding routine for wide-character strings. It processes input bytes in groups of three, converting each triplet into four Base64 characters using the standard Base64 alphabet `\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\"`. The function handles input of arbitrary length by iterating through the input buffer, encoding each 3-byte block into 4 wide characters, and writing the result to the output buffer pointed to by `unaff_RDI`. For input lengths not divisible by three, it appends the appropriate Base64 padding characters (`'='`) to ensure proper encoding. The function terminates the output string with a null wide character, making it a valid wide-character string suitable for further use in Unicode-aware APIs or file operations. Overall, the function focuses on transforming raw binary data into a Base64-encoded wide string, facilitating safe textual representation for storage, transmission, or further processing within the system.",
      "Matched Sentence": "Overall, the function focuses on transforming raw binary data into a Base64-encoded wide string, facilitating safe textual representation for storage, transmission, or further processing within the system.",
      "Similarity": 0.809235
    }
  ],
  "FUN_140006810_1": [],
  "FUN_140006170_1": [
    {
      "ATT&CK ID": "T1568.002",
      "Indicator": "High entropy domain detected: Contacted domain: \"timestamp.digicert.com\" has high entropy",
      "Comment": "The function processes a 32-bit integer input by extracting each of its four individual bytes and converting each byte into its decimal string representation. For each byte, it performs a division-based conversion to generate the corresponding ASCII digits, storing the result in a local buffer. After conversion, it calls a helper function to further process or transform this string representation.\n\nSubsequently, the function invokes another routine, passing a pointer to the converted string along with a 16-byte data block loaded from a global memory location. This sequence is repeated for each byte of the input integer, effectively serializing the integer into four separate decimal strings and processing each one in turn.\n\nThroughout the process, the function performs boundary and integrity checks on the data sizes and pointers involved. If certain size conditions are violated, it triggers an error handling routine that leads to an immediate program termination via a software interrupt. This indicates a strong emphasis on data validation and security.\n\nThe function also appends a fixed 1-byte value (likely a delimiter or marker) after processing each byte’s string representation, suggesting a structured or delimited output format.\n\nOverall, the function’s behavior centers on decomposing a 32-bit integer into its constituent bytes, converting each byte to a decimal string, applying transformations or encoding via helper functions, and ensuring data integrity through rigorous checks. It interacts primarily with local buffers and global data constants, without direct file, registry, or network operations. The control flow is linear with repeated blocks for each byte, incorporating loops for numeric conversion and conditional checks for error handling.",
      "Matched Sentence": "This indicates a strong emphasis on data validation and security.",
      "Similarity": 0.777688
    }
  ],
  "FUN_14000693e_1": [],
  "FUN_140006965_1": [],
  "FUN_140006d60_1": [],
  "FUN_140006dc0_1": [],
  "FUN_140006a30_1": [
    {
      "ATT&CK ID": "T1071.004",
      "Indicator": "Queries DNS server: \"timestamp.digicert.com\"",
      "Comment": "The function allocates two large memory buffers and populates them by invoking a helper function twice, likely to retrieve or construct encoded or compressed data strings. It then establishes an HTTP session using WinINet APIs, specifically calling `InternetOpenW` and `InternetConnectW` to connect to the host `timestamp.digicert.com` on port 80. The function constructs a URL path beginning with `/registered` and conditionally appends query parameters `code` and `t` with the contents of the previously allocated buffers, separated by `?` or `&` as appropriate.\n\nUsing `HttpOpenRequestW`, it creates an HTTP GET request with the constructed URL and sends it via `HttpSendRequestW`. After sending the request, it closes all open internet handles to clean up resources. The function also performs integrity checks on the allocated buffers, and if certain size conditions are met, it triggers a termination routine, likely as a security or anti-tampering measure.\n\nThroughout its execution, the function interacts primarily with system memory (via dynamic allocation), network components (via WinINet APIs), and string manipulation routines to build the HTTP request. The behavioral objective appears to be sending encoded or obfuscated data to a remote server, potentially for validation, telemetry, or command-and-control communication. The presence of integrity checks and abrupt termination on suspicious conditions suggests anti-debugging or anti-tampering protections embedded within the function.",
      "Matched Sentence": "It then establishes an HTTP session using WinINet APIs, specifically calling `InternetOpenW` and `InternetConnectW` to connect to the host `timestamp.digicert.com` on port 80.",
      "Similarity": 0.846747
    },
    {
      "ATT&CK ID": "T1071.001",
      "Indicator": "Communicates with HTTP webserver (GET/POST requests): Found http requests in header \"GET /registered?code=DQAAAAAAAAAOAAAAAAAAABMAAAAIAAAABAAAAAIAAAAIAAAAAAAAAA==&t=MTkyLjE2OC4wLjIgMAAtMFAtMFYtMJEtMHYtMPgNCjEyNy4wLjAuMSANCi==\"",
      "Comment": "The function allocates two large memory buffers and populates them by invoking a helper function twice, likely to retrieve or construct encoded or compressed data strings. It then establishes an HTTP session using WinINet APIs, specifically calling `InternetOpenW` and `InternetConnectW` to connect to the host `timestamp.digicert.com` on port 80. The function constructs a URL path beginning with `/registered` and conditionally appends query parameters `code` and `t` with the contents of the previously allocated buffers, separated by `?` or `&` as appropriate.\n\nUsing `HttpOpenRequestW`, it creates an HTTP GET request with the constructed URL and sends it via `HttpSendRequestW`. After sending the request, it closes all open internet handles to clean up resources. The function also performs integrity checks on the allocated buffers, and if certain size conditions are met, it triggers a termination routine, likely as a security or anti-tampering measure.\n\nThroughout its execution, the function interacts primarily with system memory (via dynamic allocation), network components (via WinINet APIs), and string manipulation routines to build the HTTP request. The behavioral objective appears to be sending encoded or obfuscated data to a remote server, potentially for validation, telemetry, or command-and-control communication. The presence of integrity checks and abrupt termination on suspicious conditions suggests anti-debugging or anti-tampering protections embedded within the function.",
      "Matched Sentence": "The function constructs a URL path beginning with `/registered` and conditionally appends query parameters `code` and `t` with the contents of the previously allocated buffers, separated by `?` or `&` as appropriate.",
      "Similarity": 0.816982
    },
    {
      "ATT&CK ID": "T1071",
      "Indicator": "Calls an API typically used to create a new HTTP request: \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"HttpOpenRequestW\" with parameter HTTP method:\"GET\" object: /registered?code=DQAAAAAAAAAOAAAAAAAAABMAAAAIAAAABAAAAAIAAAAIAAAAAAAAAA==&t=MTkyLjE2OC4wLjIgMAAtMFAtMFYtMJEtMHYtMPgNCjEyNy4wLjAuMS\" - (UID: 00000000-00003620)",
      "Comment": "The function allocates two large memory buffers and populates them by invoking a helper function twice, likely to retrieve or construct encoded or compressed data strings. It then establishes an HTTP session using WinINet APIs, specifically calling `InternetOpenW` and `InternetConnectW` to connect to the host `timestamp.digicert.com` on port 80. The function constructs a URL path beginning with `/registered` and conditionally appends query parameters `code` and `t` with the contents of the previously allocated buffers, separated by `?` or `&` as appropriate.\n\nUsing `HttpOpenRequestW`, it creates an HTTP GET request with the constructed URL and sends it via `HttpSendRequestW`. After sending the request, it closes all open internet handles to clean up resources. The function also performs integrity checks on the allocated buffers, and if certain size conditions are met, it triggers a termination routine, likely as a security or anti-tampering measure.\n\nThroughout its execution, the function interacts primarily with system memory (via dynamic allocation), network components (via WinINet APIs), and string manipulation routines to build the HTTP request. The behavioral objective appears to be sending encoded or obfuscated data to a remote server, potentially for validation, telemetry, or command-and-control communication. The presence of integrity checks and abrupt termination on suspicious conditions suggests anti-debugging or anti-tampering protections embedded within the function.",
      "Matched Sentence": "Using `HttpOpenRequestW`, it creates an HTTP GET request with the constructed URL and sends it via `HttpSendRequestW`.",
      "Similarity": 0.851945
    },
    {
      "ATT&CK ID": "T1071.001",
      "Indicator": "Calls an API used to connect to internet: \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"InternetOpenA\" (UID: 00000000-00003620)\n \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"InternetOpenW\" (UID: 00000000-00003620)",
      "Comment": "The function allocates two large memory buffers and populates them by invoking a helper function twice, likely to retrieve or construct encoded or compressed data strings. It then establishes an HTTP session using WinINet APIs, specifically calling `InternetOpenW` and `InternetConnectW` to connect to the host `timestamp.digicert.com` on port 80. The function constructs a URL path beginning with `/registered` and conditionally appends query parameters `code` and `t` with the contents of the previously allocated buffers, separated by `?` or `&` as appropriate.\n\nUsing `HttpOpenRequestW`, it creates an HTTP GET request with the constructed URL and sends it via `HttpSendRequestW`. After sending the request, it closes all open internet handles to clean up resources. The function also performs integrity checks on the allocated buffers, and if certain size conditions are met, it triggers a termination routine, likely as a security or anti-tampering measure.\n\nThroughout its execution, the function interacts primarily with system memory (via dynamic allocation), network components (via WinINet APIs), and string manipulation routines to build the HTTP request. The behavioral objective appears to be sending encoded or obfuscated data to a remote server, potentially for validation, telemetry, or command-and-control communication. The presence of integrity checks and abrupt termination on suspicious conditions suggests anti-debugging or anti-tampering protections embedded within the function.",
      "Matched Sentence": "After sending the request, it closes all open internet handles to clean up resources.",
      "Similarity": 0.761119
    }
  ],
  "std::basic_string<wchar_t,struct_std::char_traits<wchar_t>,class_std::allocator<wchar_t>_>::_Tidy_deallocate_1": [],
  "FUN_14000688d_1": [],
  "FUN_140006e60_1": [],
  "FUN_1400072b0_1": [],
  "FUN_140007060_1": [],
  "FUN_140007150_1": [],
  "FUN_140007320_1": [],
  "FUN_140007380_1": [],
  "~basic_istream<>_1": [],
  "FUN_140007750_1": [],
  "FUN_140007814_1": [],
  "FUN_140007580_1": [],
  "FUN_1400077a6_1": [],
  "FUN_140007856_1": [],
  "FUN_140007780_1": [],
  "FUN_1400079a0_1": [],
  "FUN_140007960_1": [],
  "FUN_140007c00_1": [],
  "FUN_140007b80_1": [],
  "FID_conflict:`scalar_deleting_destructor'_1": [],
  "FUN_140007f0b_1": [],
  "FUN_140007f05_1": [
    {
      "ATT&CK ID": "T1055.004",
      "Indicator": "Queues an Asynchronous Procedure Call (APC) in a remote process (injection): \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"NtQueueApcThread\" (UID: 00000000-00003620)",
      "Comment": "The function initiates by calling another internal routine, `FUN_140008a30()`, which likely performs a preparatory or setup task essential for the function’s operation. Immediately following this call, the function triggers a software interrupt (`swi 3`), which corresponds to a breakpoint or debug interrupt in many architectures. This interrupt is invoked through an indirect function pointer call, effectively halting normal execution and transferring control to a debugger or exception handler.\n\nOverall, the function’s behavior is minimal and focused on two key actions: executing a preparatory routine and then deliberately triggering a breakpoint interrupt. This pattern suggests that the function is designed primarily for debugging or diagnostic purposes, possibly to signal a specific execution point or to facilitate debugging during development or analysis. There are no interactions with system resources such as files, registry keys, or network components, nor any complex control flow beyond the sequential call and interrupt invocation.",
      "Matched Sentence": "There are no interactions with system resources such as files, registry keys, or network components, nor any complex control flow beyond the sequential call and interrupt invocation.",
      "Similarity": 0.769402
    }
  ],
  "FUN_140007dc0_1": [],
  "FUN_140007e4a_1": [],
  "FUN_140007c50_1": [],
  "FUN_140007f20_1": [],
  "FUN_140007f82_1": [],
  "FUN_140007f43_1": [],
  "FUN_140007fb0_1": [],
  "FUN_140007fd0_1": [],
  "FUN_1400081f0_1": [],
  "FUN_14000854f_1": [],
  "FUN_1400086bb_1": [],
  "FUN_140008330_1": [
    {
      "ATT&CK ID": "T1140",
      "Indicator": "Shows ability to deobfuscate/decode files or information: The analysis shows use of encryption and can be used to decode file or information. Matched sigs: PCAP contains base64 strings\n Matched sigs: HTTP requests contain Base64 strings\n Matched sigs: HTTP request contains Base64 encoded artifacts\n Matched sigs: Contains XOR operation loops [Stream disassembly]\n Matched sigs: YARA signature match - RC4 Encryption",
      "Comment": "The function processes a data structure referenced by its input parameter, performing iterative byte-level operations through a series of virtual function calls. It first retrieves a count value from a nested offset within the input structure and adjusts it to define the number of iterations for subsequent loops. The function then initializes a local context via a helper call, which appears to prepare or wrap the input data for processing.\n\nDepending on a flag set during initialization, the function either sets a status code directly or enters a loop that repeatedly invokes a virtual method on an internal object pointer, passing individual bytes extracted from the input structure. This loop continues until all bytes are processed or an error condition is encountered, indicated by a special return value (0xFFFFFFFF). The function also manages an internal buffer pointer and a decrementing counter to control how bytes are consumed or stored, suggesting a form of buffered or stateful processing.\n\nAfter the initial loop, the function calls another virtual method to check a condition; if successful, it performs a second similar loop with slightly different parameters, again processing bytes one by one through virtual calls. If any call returns an error, the function sets a failure status code.\n\nBefore completion, the function resets a counter within the input structure and updates a status field by combining existing flags with the current status code. It then invokes a helper function to finalize or commit the processing state, passing the updated status and a null terminator. Exception safety is considered by checking for uncaught exceptions before releasing resources associated with the local context. Finally, if an internal object pointer exists within the local context, the function calls its cleanup or release method.\n\nOverall, the function orchestrates a controlled, stateful byte-wise processing routine on a complex data structure, leveraging virtual method calls to handle the data. It carefully manages iteration counts, error detection, and resource cleanup, indicating its role in decoding, validating, or transforming input data within a larger system component.",
      "Matched Sentence": "It carefully manages iteration counts, error detection, and resource cleanup, indicating its role in decoding, validating, or transforming input data within a larger system component.",
      "Similarity": 0.750134
    }
  ],
  "FUN_140007ff0_1": [],
  "FUN_140008520_1": [],
  "FUN_1400086c1_1": [],
  "FUN_140008847_1": [],
  "FUN_14000884d_1": [],
  "FUN_140008860_1": [],
  "FUN_1400086fe_1": [],
  "FUN_1400088a0_1": [
    {
      "ATT&CK ID": "T1027.007",
      "Indicator": "Looks up many procedures within the same disassembly stream (often used to hide usage): Found 20 calls to GetProcAddress@KERNEL32.dll at 40298-696-000000014000A284",
      "Comment": "The function performs a conditional cleanup and resource release operation based on the current exception state. It first checks whether there is an active uncaught exception using the `__uncaught_exception()` intrinsic. If no exception is active, it calls a cleanup or deallocation routine (`FUN_140008a80`) on a resource referenced by the pointer stored at the address pointed to by the input parameter.\n\nSubsequently, the function retrieves a secondary pointer from a nested data structure derived from the input parameter. This involves dereferencing multiple pointer offsets to locate a function pointer stored at a specific offset within the nested structure. If this secondary pointer is non-null, the function invokes a method or callback through this pointer, likely to perform additional cleanup or finalization.\n\nOverall, the function’s behavior centers on safely releasing or finalizing resources only when no exceptions are pending, ensuring proper cleanup without interfering with exception handling. It interacts primarily with memory pointers and function pointers embedded within complex data structures, invoking cleanup routines conditionally to maintain resource integrity.",
      "Matched Sentence": "This involves dereferencing multiple pointer offsets to locate a function pointer stored at a specific offset within the nested structure.",
      "Similarity": 0.814302
    }
  ],
  "FUN_1400086d0_1": [],
  "FUN_140008a10_1": [],
  "FUN_140008a30_1": [],
  "FUN_140008a50_1": [],
  "FUN_1400088f0_1": [],
  "FUN_140008aff_1": [],
  "FUN_140008b43_1": [],
  "FUN_140008a80_1": [],
  "FUN_140008ed9_1": [],
  "FUN_140008b60_1": [],
  "FUN_140008edf_1": [],
  "FUN_140008db0_1": [],
  "FUN_140008dd1_1": [],
  "FUN_140009046_1": [],
  "FUN_140008ef0_1": [],
  "FUN_14000904c_1": [],
  "FUN_140008f19_1": [],
  "FUN_140009195_1": [],
  "FUN_14000919b_1": [],
  "FUN_140009089_1": [],
  "FUN_140009356_1": [],
  "FUN_1400091b0_1": [],
  "FUN_14000935c_1": [],
  "FUN_1400091de_1": [],
  "FUN_140009060_1": [],
  "FUN_140009370_1": [],
  "FUN_1400094f4_1": [],
  "FUN_1400094ee_1": [],
  "FUN_1400094fc_1": [],
  "FUN_140009508_1": [],
  "FUN_1400093c8_1": [],
  "FUN_140009390_1": [],
  "FUN_1400095b4_1": [],
  "FUN_140009520_1": [],
  "std::_Lockit::~_Lockit_1": [],
  "std::_Init_locks::_Init_locks_1": [],
  "FUN_14000962c_1": [],
  "std::_Lockit::_Lockit_1": [],
  "FUN_140009670_1": [],
  "FUN_140009750_1": [],
  "FUN_1400096cc_1": [],
  "FUN_140009774_1": [],
  "FUN_1400098b4_1": [],
  "std::_Facet_Register_1": [],
  "std::locale::_Locimp::`scalar_deleting_destructor'_1": [],
  "std::_Yarn<char>::operator=_1": [],
  "std::locale::_Init_1": [],
  "std::locale::_Setgloballocale_1": [],
  "std::locale::_Locimp::_Locimp_dtor_1": [],
  "std::_Locinfo::_Locinfo_ctor_1": [],
  "std::_Locinfo::_Locinfo_dtor_1": [],
  "_Deletegloballocale_1": [
    {
      "ATT&CK ID": "T1003",
      "Indicator": "Attempts to invoke APIs commonly associated with credential theft and data exfiltration functionality: \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"NtQueryInformationToken\" with parameters (UID: 00000000-00003620)",
      "Comment": "The function checks whether the pointer passed as a parameter points to a non-null value. If so, it calls a guard dispatch function (likely related to control flow guard or indirect call validation) through a function pointer. Upon receiving a non-zero result from this call, it invokes the same guard dispatch function again with the returned value and an additional argument of 1. This behavior suggests the function is involved in a security or integrity check mechanism, possibly to validate or dispatch a protected indirect call. The function does not perform any other operations or system interactions beyond these guarded calls and the initial null check.",
      "Matched Sentence": "This behavior suggests the function is involved in a security or integrity check mechanism, possibly to validate or dispatch a protected indirect call.",
      "Similarity": 0.789446
    }
  ],
  "FUN_140009c8c_1": [],
  "FUN_140009ca8_1": [],
  "FUN_140009c00_1": [],
  "std::ios_base::_Ios_base_dtor_1": [],
  "FUN_140009cd0_1": [],
  "_Tolower_1": [],
  "_Toupper_1": [],
  "FUN_14000a5f4_1": [],
  "FUN_14000a5c4_1": [],
  "FUN_14000a028_1": [
    {
      "ATT&CK ID": "T1106",
      "Indicator": "Contains ability to retrieve address of exported function from a DLL (API string): Found reference to API \"GetProcAddress\" (Indicator: \"GetProcAddress\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API \"GetProcAddress\" (Indicator: \"GetProcAddress\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")",
      "Comment": "The function dynamically obtains a handle to the `kernel32.dll` module and proceeds to resolve the addresses of numerous Windows API functions related to thread-local storage, synchronization primitives, thread pool management, and system information retrieval using `GetProcAddress`. Each retrieved function pointer is then obfuscated by XORing it with a global key before being stored in global variables. This setup enables the program to later invoke these APIs indirectly while potentially evading static detection or analysis.\n\nSpecifically, the function targets APIs such as `FlsAlloc`, `FlsFree`, `FlsGetValue`, and `FlsSetValue` for fiber-local storage management; synchronization functions like `InitializeCriticalSectionEx`, `CreateEventExW`, and various thread pool timer and wait functions for advanced concurrency control; and system information calls including `GetCurrentProcessorNumber`, `GetTickCount64`, and `GetSystemTimePreciseAsFileTime`. By caching these pointers early, the function prepares the environment for efficient and flexible use of threading and synchronization features.\n\nNo file system or registry interactions occur within this function; its sole purpose is to initialize and obfuscate access to critical system APIs related to multithreading and synchronization. This behavior suggests it is part of a larger system component or malware loader that requires dynamic and stealthy access to concurrency and timing functions.",
      "Matched Sentence": "The function dynamically obtains a handle to the `kernel32.dll` module and proceeds to resolve the addresses of numerous Windows API functions related to thread-local storage, synchronization primitives, thread pool management, and system information retrieval using `GetProcAddress`.",
      "Similarity": 0.856599
    },
    {
      "ATT&CK ID": "T1622",
      "Indicator": "Contains ability to check debugger is running (API string): Found reference to API \"QueryPerformanceCounter\" (Indicator: \"QueryPerformanceCounter\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API \"IsDebuggerPresent\" (Indicator: \"IsDebuggerPresent\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API \"GetTickCount64\" (Indicator: \"GetTickCount\"; File: \"1bc5621a4818f2124ac085da21f607ca\")",
      "Comment": "The function dynamically obtains a handle to the `kernel32.dll` module and proceeds to resolve the addresses of numerous Windows API functions related to thread-local storage, synchronization primitives, thread pool management, and system information retrieval using `GetProcAddress`. Each retrieved function pointer is then obfuscated by XORing it with a global key before being stored in global variables. This setup enables the program to later invoke these APIs indirectly while potentially evading static detection or analysis.\n\nSpecifically, the function targets APIs such as `FlsAlloc`, `FlsFree`, `FlsGetValue`, and `FlsSetValue` for fiber-local storage management; synchronization functions like `InitializeCriticalSectionEx`, `CreateEventExW`, and various thread pool timer and wait functions for advanced concurrency control; and system information calls including `GetCurrentProcessorNumber`, `GetTickCount64`, and `GetSystemTimePreciseAsFileTime`. By caching these pointers early, the function prepares the environment for efficient and flexible use of threading and synchronization features.\n\nNo file system or registry interactions occur within this function; its sole purpose is to initialize and obfuscate access to critical system APIs related to multithreading and synchronization. This behavior suggests it is part of a larger system component or malware loader that requires dynamic and stealthy access to concurrency and timing functions.",
      "Matched Sentence": "This setup enables the program to later invoke these APIs indirectly while potentially evading static detection or analysis.",
      "Similarity": 0.81101
    },
    {
      "ATT&CK ID": "T1124",
      "Indicator": "Contains ability to query machine time: GetSystemTimeAsFileTime@KERNEL32.dll at 40298-1347-000000014000B8E9",
      "Comment": "The function dynamically obtains a handle to the `kernel32.dll` module and proceeds to resolve the addresses of numerous Windows API functions related to thread-local storage, synchronization primitives, thread pool management, and system information retrieval using `GetProcAddress`. Each retrieved function pointer is then obfuscated by XORing it with a global key before being stored in global variables. This setup enables the program to later invoke these APIs indirectly while potentially evading static detection or analysis.\n\nSpecifically, the function targets APIs such as `FlsAlloc`, `FlsFree`, `FlsGetValue`, and `FlsSetValue` for fiber-local storage management; synchronization functions like `InitializeCriticalSectionEx`, `CreateEventExW`, and various thread pool timer and wait functions for advanced concurrency control; and system information calls including `GetCurrentProcessorNumber`, `GetTickCount64`, and `GetSystemTimePreciseAsFileTime`. By caching these pointers early, the function prepares the environment for efficient and flexible use of threading and synchronization features.\n\nNo file system or registry interactions occur within this function; its sole purpose is to initialize and obfuscate access to critical system APIs related to multithreading and synchronization. This behavior suggests it is part of a larger system component or malware loader that requires dynamic and stealthy access to concurrency and timing functions.",
      "Matched Sentence": "This behavior suggests it is part of a larger system component or malware loader that requires dynamic and stealthy access to concurrency and timing functions.",
      "Similarity": 0.812657
    }
  ],
  "__crtInitOnceExecuteOnce_1": [],
  "_Atexit_1": [],
  "GetTableIndexFromLocaleName_1": [],
  "thunk_FUN_14000b460_1": [],
  "__crtLCMapStringA_1": [],
  "__security_check_cookie_1": [
    {
      "ATT&CK ID": "T1132",
      "Indicator": "HTTP requests contain custom Base62 strings: Contains base62 string in header \"DQAAAAAAAAAOAAAAAAAAABMAAAAIAAAAB\" in header \"GET /registered?code=DQAAAAAAAAAOAAAAAAAAABMAAAAIAAAABAAAAAIAAAAIAAAAAAAAAA==&t=MTkyLjE2OC4wLjIgMAAtMFAtMFYtMJEtMHYtMPgNCjEyNy4wLjAuMSANCi== HTTP/1.1Host: timestamp.digicert.comCache-Control: no-cache\"\n Contains base62 string in header \"MTkyLjE2OC4wLjIgMAAtMFAtMFYtMJEtM\" in header \"GET /registered?code=DQAAAAAAAAAOAAAAAAAAABMAAAAIAAAABAAAAAIAAAAIAAAAAAAAAA==&t=MTkyLjE2OC4wLjIgMAAtMFAtMFYtMJEtMHYtMPgNCjEyNy4wLjAuMSANCi== HTTP/1.1Host: timestamp.digicert.comCache-Control: no-cache\"",
      "Comment": "The function performs a security check by comparing a provided stack cookie value against a known global cookie (`DAT_140038080`). It verifies that the entire cookie matches and additionally checks that the high-order bits (specifically the upper 16 bits of the highest 64-bit segment) are zero. If both conditions are met, the function returns silently, indicating the stack cookie is valid and no tampering is detected. If the check fails, it calls `__report_gsfailure`, which is responsible for handling the security failure, typically by terminating the process or triggering a security alert. This function is a standard compiler-generated security mechanism designed to detect stack buffer overflows or stack corruption by validating the integrity of the stack cookie before function return.",
      "Matched Sentence": "It verifies that the entire cookie matches and additionally checks that the high-order bits (specifically the upper 16 bits of the highest 64-bit segment) are zero.",
      "Similarity": 0.761701
    }
  ],
  "FUN_14000a008_1": [],
  "__crtDownlevelLocaleNameToLCID_1": [],
  "__crtLCMapStringEx_1": [],
  "__scrt_initialize_crt_1": [],
  "__scrt_release_startup_lock_1": [],
  "operator_new_1": [],
  "__scrt_uninitialize_crt_1": [],
  "FUN_14000abc0_1": [],
  "_onexit_1": [
    {
      "ATT&CK ID": "T1027.005",
      "Indicator": "XOR operations in executable file detected: Found XOR loop in file \"sample.bin\" at offset 44344; code bytes = 33c1\n Found XOR loop in file \"sample.bin\" at offset 167075; code bytes = 8030",
      "Comment": "The function implements a custom registration mechanism for on-exit callback functions. It performs a bitwise comparison between two global 64-bit values, applying a rotation and XOR operation to determine if a specific condition is met. If the condition evaluates to true (indicating a particular internal state), the function calls an internal routine to register the provided callback function directly. Otherwise, it invokes a fallback registration function that manages the callback within a dedicated data structure or list.\n\nThe function returns the input callback pointer upon successful registration, or `NULL` if the registration fails. This behavior ensures that the callback is properly tracked for execution during program termination, effectively managing the lifecycle of exit handlers. The use of bitwise operations on global variables suggests a form of state validation or synchronization before registering the callback, likely to maintain consistency or prevent duplicate registrations.",
      "Matched Sentence": "It performs a bitwise comparison between two global 64-bit values, applying a rotation and XOR operation to determine if a specific condition is met.",
      "Similarity": 0.797445
    }
  ],
  "__scrt_is_nonwritable_in_current_image_1": [],
  "__scrt_acquire_startup_lock_1": [],
  "FUN_14000adc8_1": [],
  "FUN_14000aeac_1": [],
  "FUN_14000aebc_1": [],
  "entry_1": [],
  "__GSHandlerCheck_1": [],
  "FUN_14000adf4_1": [],
  "__raise_securityfailure_1": [
    {
      "ATT&CK ID": "T1055.002",
      "Indicator": "Attempts remote code execution into another process memory space: \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"NtWriteVirtualMemory\" with parameters {\"ProcessHandle\": \"668\"\n \"BaseAddress\": \"000001E5BDBD0000\"\n \"Buffer\": \"000001A91292EFD0\"\n \"NumberOfBytesToWrite\": \"00000FB8\"\n \"$name\": \"C:\\\\Windows\\\\System32\\\\certutil.exe\"}\n \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"NtWriteVirtualMemory\" with parameters {\"ProcessHandle\": \"668\"\n \"BaseAddress\": \"00000037717752D8\"\n \"Buffer\": \"0000000C1FFFE7F8\"\n \"NumberOfBytesToWrite\": \"00000008\"\n \"$name\": \"C:\\\\Windows\\\\System32\\\\certutil.exe\"}\n \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"NtWriteVirtualMemory\" with parameters {\"ProcessHandle\": \"660\"\n \"BaseAddress\": \"0000029358E80000\"\n \"Buffer\": \"000001A91292EFD0\"\n \"NumberOfBytesToWrite\": \"00000FB8\"\n \"$name\": \"C:\\\\Windows\\\\System32\\\\certutil.exe\"}\n \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"NtWriteVirtualMemory\" with parameters {\"ProcessHandle\": \"660\"\n \"BaseAddress\": \"000000D8C620C2D8\"\n \"Buffer\": \"0000000C1FFFE7F8\"\n \"NumberOfBytesToWrite\": \"00000008\"\n \"$name\": \"C:\\\\Windows\\\\System32\\\\certutil.exe\"}",
      "Comment": "The function handles a critical security failure by first disabling any custom unhandled exception filters through `SetUnhandledExceptionFilter(NULL)`. It then explicitly invokes the default unhandled exception filter using `UnhandledExceptionFilter`, passing the current exception context to ensure standard exception processing occurs. Finally, the function obtains a handle to the current process with `GetCurrentProcess` and forcibly terminates it by calling `TerminateProcess` with a specific status code (`0xC0000409`), which typically indicates a stack buffer overrun or security violation. This sequence ensures that upon encountering a severe exception, the process is immediately and unconditionally terminated to prevent further execution or potential exploitation.",
      "Matched Sentence": "Finally, the function obtains a handle to the current process with `GetCurrentProcess` and forcibly terminates it by calling `TerminateProcess` with a specific status code (`0xC0000409`), which typically indicates a stack buffer overrun or security violation.",
      "Similarity": 0.80622
    }
  ],
  "__GSHandlerCheck_EH_1": [],
  "__report_rangecheckfailure_1": [],
  "_alloca_probe_1": [],
  "FUN_14000aed8_1": [],
  "capture_current_context_1": [],
  "__report_securityfailure_1": [],
  "FUN_14000b460_1": [],
  "capture_previous_context_1": [],
  "FUN_14000b468_1": [],
  "__report_gsfailure_1": [],
  "FUN_14000b4c4_1": [
    {
      "ATT&CK ID": "T1129",
      "Indicator": "Looks up procedures from modules (excluding apphelp.dll, kernel32.dll, user32.dll, gdi32.dll, ole32.dll, comctl32.dll, uxtheme.dll, oleaut32.dll, version.dll, msctfime.ime): \"19001a000000000040c7b721fd7f0000@ntdll.dll\"\n \"220023000000000018c7b721fd7f0000@ntdll.dll\"",
      "Comment": "The function initializes a local data structure by calling `FUN_140009670` with a pointer to a local array, likely setting up or preparing some internal state or buffer. It then calls `FUN_14000c234`, passing the same local array along with a pointer to a static data segment (`&DAT_140035fc0`), which suggests it processes or transforms this data using predefined constants or configuration data. Finally, the function triggers a software interrupt (`swi 3`), which typically corresponds to a breakpoint or a system-level interrupt used for debugging or halting execution.\n\nOverall, the function performs a sequence of initialization and data processing steps on local memory, followed by an intentional interrupt to pause or signal the system. It does not interact with external system resources such as files, registry keys, or network components, and its behavior centers on internal data manipulation and controlled interruption, likely for debugging or controlled termination purposes.",
      "Matched Sentence": "It then calls `FUN_14000c234`, passing the same local array along with a pointer to a static data segment (`&DAT_140035fc0`), which suggests it processes or transforms this data using predefined constants or configuration data.",
      "Similarity": 0.75323
    }
  ],
  "FUN_14000b4e4_1": [],
  "__scrt_is_ucrt_dll_in_use_1": [],
  "FUN_14000b694_1": [],
  "__isa_available_init_1": [
    {
      "ATT&CK ID": "T1082",
      "Indicator": "Able to discover operating system information (API string): Found reference to API \"4858421017,4796,3025,,RtlGetNtProductType,NTDLL.dll,\"01:03:56.875\",RX=0,PX=0\" (Indicator: \"RtlGetNtProductType\"; Source: \"00000000-00003620.00000000.245741.1295B000.00000004.mdmp\")\n Found reference to API \"4838517512,4796,3025,,RtlGetNtProductType,NTDLL.dll,\"01:03:56.859\",RX=0,PX=0\" (Indicator: \"RtlGetNtProductType\"; Source: \"00000000-00003620.00000000.245741.1295B000.00000004.mdmp\")\n Found reference to API \"4671424089,2564,3025,,RtlGetNtProductType,NTDLL.dll,\"01:03:56.796\",RX=0,PX=0\" (Indicator: \"RtlGetNtProductType\"; Source: \"00000000-00003620.00000000.245741.1295B000.00000004.mdmp\")\n Found reference to API \"4858540945,4796,3024,,RtlGetVersion,NTDLL.dll,\"01:03:56.875\",RX=0,PX=0\" (Indicator: \"RtlGetVersion\"; Source: \"00000000-00003620.00000000.245741.1295B000.00000004.mdmp\")",
      "Comment": "The function performs detailed CPU feature detection by invoking low-level CPUID instructions to query processor capabilities. It first retrieves the basic CPU vendor string and verifies it matches the expected signature for an Intel processor. It then examines the CPU version and feature information to identify specific processor models and feature sets. Based on these values, the function sets global flags indicating the presence of certain CPU features, such as extended instruction sets and advanced vector extensions.\n\nThe function further queries extended feature information (leaf 7) to detect support for additional capabilities, including specific bit flags that correspond to advanced CPU instructions. It also checks the processor’s extended control register state (via the `in_XCR0` register) to confirm the availability of features like AVX and AVX-512.\n\nThroughout its execution, the function uses bitwise operations to interpret feature bits and conditionally updates global variables that likely control subsequent code paths optimized for the detected CPU features. The control flow is primarily conditional, branching based on the presence or absence of specific CPU flags, and it concludes by returning zero after setting these global indicators.\n\nOverall, the function’s behavior centers on precise CPU feature enumeration and capability flagging, enabling the software to adapt its execution to the processor’s supported instruction sets and performance characteristics.",
      "Matched Sentence": "It then examines the CPU version and feature information to identify specific processor models and feature sets.",
      "Similarity": 0.787476
    }
  ],
  "FUN_14000b880_1": [],
  "__scrt_get_show_window_mode_1": [
    {
      "ATT&CK ID": "T1543",
      "Indicator": "Contains ability to retrieve the contents of the STARTUPINFO structure (API string): Found reference to API \"GetStartupInfoW\" (Indicator: \"GetStartupInfo\"; File: \"1bc5621a4818f2124ac085da21f607ca\")",
      "Comment": "The function retrieves the startup information of the current process by calling `GetStartupInfoW` and initializes a local structure to receive this data. It then examines the `dwFlags` field of the startup info to check if the `STARTF_USESHOWWINDOW` flag is set, indicating that the `wShowWindow` member contains valid data. If this flag is present, the function returns the value of `wShowWindow`, which specifies how the window should be shown (e.g., minimized, maximized, normal). If the flag is not set, the function returns a default value of 10, which corresponds to `SW_SHOWDEFAULT`. This behavior allows the function to determine the appropriate window display mode for the process based on its startup parameters.",
      "Matched Sentence": "The function retrieves the startup information of the current process by calling `GetStartupInfoW` and initializes a local structure to receive this data.",
      "Similarity": 0.898642
    },
    {
      "ATT&CK ID": "T1564.003",
      "Indicator": "Contains ability to show a graphical window (API string): Found reference to API \"ShowWindow\" (Indicator: \"ShowWindow\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API \"ShowWindow\" (Indicator: \"ShowWindow\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")",
      "Comment": "The function retrieves the startup information of the current process by calling `GetStartupInfoW` and initializes a local structure to receive this data. It then examines the `dwFlags` field of the startup info to check if the `STARTF_USESHOWWINDOW` flag is set, indicating that the `wShowWindow` member contains valid data. If this flag is present, the function returns the value of `wShowWindow`, which specifies how the window should be shown (e.g., minimized, maximized, normal). If the flag is not set, the function returns a default value of 10, which corresponds to `SW_SHOWDEFAULT`. This behavior allows the function to determine the appropriate window display mode for the process based on its startup parameters.",
      "Matched Sentence": "This behavior allows the function to determine the appropriate window display mode for the process based on its startup parameters.",
      "Similarity": 0.791113
    }
  ],
  "FUN_14000b97c_1": [],
  "FUN_14000b890_1": [],
  "FUN_14000b990_1": [],
  "__security_init_cookie_1": [],
  "FUN_14000b9c0_1": [],
  "FUN_14000b998_1": [],
  "FUN_14000b9b4_1": [],
  "__scrt_fastfail_1": [
    {
      "ATT&CK ID": "T1622",
      "Indicator": "Contains ability to register a top-level exception handler (API string): Found reference to API \"SetUnhandledExceptionFilter\" (Indicator: \"SetUnhandledExceptionFilter\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API \"SetUnhandledExceptionFilter\" (Indicator: \"UnhandledExceptionFilter\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API \"UnhandledExceptionFilter\" (Indicator: \"UnhandledExceptionFilter\"; File: \"1bc5621a4818f2124ac085da21f607ca\")",
      "Comment": "The function performs structured exception handling and context capture to manage critical failures or fast-fail conditions. It begins by checking for the presence of a specific processor feature and, if available, triggers a software interrupt to initiate a fast fail. It then captures the current CPU context using `RtlCaptureContext` and attempts to locate the corresponding runtime function entry with `RtlLookupFunctionEntry`. If a valid function entry is found, the function performs a virtual unwind of the stack frame via `RtlVirtualUnwind` to retrieve detailed exception context information.\n\nSubsequently, the function initializes an exception record structure and checks if a debugger is present using `IsDebuggerPresent`. It disables any existing unhandled exception filter by calling `SetUnhandledExceptionFilter` with a null pointer, then invokes `UnhandledExceptionFilter` to process the exception pointers it prepared. If the exception filter returns zero and no debugger is detected, the function calls an internal routine to handle the failure further.\n\nOverall, this function is designed to handle fast-fail scenarios by capturing detailed exception context, unwinding the stack to identify the faulting function, and invoking system-level exception filters. It interacts primarily with low-level Windows APIs related to exception handling (`RtlCaptureContext`, `RtlLookupFunctionEntry`, `RtlVirtualUnwind`, `SetUnhandledExceptionFilter`, `UnhandledExceptionFilter`) and debugger detection (`IsDebuggerPresent`). The function’s control flow is conditional and sequential, ensuring that exception context is accurately captured and processed before potentially terminating or escalating the failure.",
      "Matched Sentence": "It disables any existing unhandled exception filter by calling `SetUnhandledExceptionFilter` with a null pointer, then invokes `UnhandledExceptionFilter` to process the exception pointers it prepared.",
      "Similarity": 0.808258
    },
    {
      "ATT&CK ID": "T1106",
      "Indicator": "Contains ability to execute Windows APIs: Found reference to API (Indicator: \"LookupAccountSidW\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"RegCreateKeyExW\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"RegCloseKey\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"CreateWellKnownSid\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"RegEnumValueW\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"RegOpenKeyExW\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"GetIpAddrTable\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"GetIfEntry\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"FreeLibrary\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"SetLastError\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"InitializeSListHead\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"RtlLookupFunctionEntry\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"MultiByteToWideChar\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"TlsGetValue\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"GetStartupInfoW\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"FreeEnvironmentStringsW\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"DeleteFileW\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"GetFileAttributesW\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"CreateFileW\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"GetUserDefaultLCID\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"GetCommandLineW\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"GetCommandLineA\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"GetLocaleInfoW\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"EncodePointer\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"RtlVirtualUnwind\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"SwitchToThread\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"TerminateProcess\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"WriteConsoleW\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"GetACP\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"WaitForSingleObject\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"RtlPcToFileHeader\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"QueryPerformanceCounter\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"LoadLibraryExW\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"HeapAlloc\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"GetProcAddress\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"HeapReAlloc\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"HeapFree\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"TlsFree\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"Sleep\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"GetModuleHandleW\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"GetCurrentThreadId\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"GetConsoleCP\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"EnumSystemLocalesW\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"GetCPInfo\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"IsProcessorFeaturePresent\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"TlsAlloc\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"IsDebuggerPresent\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"CloseHandle\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"GetLastError\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"RaiseException\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"IsValidLocale\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"LeaveCriticalSection\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"GetCurrentProcess\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"GetStdHandle\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"CreateDirectoryW\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"SetUnhandledExceptionFilter\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"TlsSetValue\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"GetModuleFileNameW\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"DecodePointer\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"SetStdHandle\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"DeleteCriticalSection\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"FindNextFileW\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"GetConsoleMode\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"WriteFile\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"SetFilePointerEx\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"CreateThread\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"WideCharToMultiByte\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"HeapSize\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"CreateProcessW\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"GetModuleHandleExW\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"GetOEMCP\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"GetSystemTimeAsFileTime\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"ExitProcess\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"GetFileType\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"LCMapStringW\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"GetCurrentProcessId\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"GetEnvironmentStringsW\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"GetTempPathW\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"InitializeCriticalSectionAndSpinCount\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"FindFirstFileExW\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"EnterCriticalSection\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"GetProcessHeap\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"IsValidCodePage\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"FindClose\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"RtlCaptureContext\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"UnhandledExceptionFilter\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"FlushFileBuffers\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"GetStringTypeW\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"GetTempFileNameW\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"NetLocalGroupAddMember\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"NetUserAdd\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"NetUserGetInfo\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"NetGroupGetInfo\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"NetApiBufferFree\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"NetUserGetGroups\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"LoadCursorW\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"CreateWindowExW\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"PostQuitMessage\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"ShowWindow\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"UpdateWindow\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"DispatchMessageW\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"DefWindowProcW\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"GetSystemMetrics\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"LoadImageW\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"InternetCloseHandle\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"HttpOpenRequestW\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"InternetConnectW\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"InternetOpenW\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"HttpSendRequestW\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"FlsAlloc\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"FlsFree\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"FlsGetValue\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"FlsSetValue\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"InitializeCriticalSectionEx\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"InitOnceExecuteOnce\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"CreateEventExW\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"CreateSemaphoreW\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"CreateSemaphoreExW\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"CreateThreadpoolTimer\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"SetThreadpoolTimer\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"WaitForThreadpoolTimerCallbacks\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"CloseThreadpoolTimer\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"CreateThreadpoolWait\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"SetThreadpoolWait\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"CloseThreadpoolWait\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"FlushProcessWriteBuffers\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"FreeLibraryWhenCallbackReturns\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"GetCurrentProcessorNumber\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"CreateSymbolicLinkW\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"GetTickCount64\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"GetFileInformationByHandleEx\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"SetFileInformationByHandle\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"GetSystemTimePreciseAsFileTime\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"InitializeConditionVariable\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"WakeConditionVariable\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"WakeAllConditionVariable\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"SleepConditionVariableCS\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"InitializeSRWLock\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"AcquireSRWLockExclusive\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"TryAcquireSRWLockExclusive\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"ReleaseSRWLockExclusive\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"SleepConditionVariableSRW\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"CreateThreadpoolWork\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"SubmitThreadpoolWork\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"CloseThreadpoolWork\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"CompareStringEx\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"GetLocaleInfoEx\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"LCMapStringEx\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"AreFileApisANSI\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"EnumSystemLocalesEx\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"GetDateFormatEx\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"GetTimeFormatEx\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"GetUserDefaultLocaleName\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"IsValidLocaleName\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"LCIDToLocaleName\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"LocaleNameToLCID\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API (Indicator: \"FlsAlloc\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"FlsFree\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"FlsGetValue\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"FlsSetValue\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"InitializeCriticalSectionEx\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"InitOnceExecuteOnce\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"CreateEventExW\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"CreateSemaphoreW\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"CreateSemaphoreExW\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"CreateThreadpoolTimer\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"SetThreadpoolTimer\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"WaitForThreadpoolTimerCallbacks\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"CloseThreadpoolTimer\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"CreateThreadpoolWait\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"SetThreadpoolWait\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"CloseThreadpoolWait\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"FlushProcessWriteBuffers\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"FreeLibraryWhenCallbackReturns\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"GetCurrentProcessorNumber\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"CreateSymbolicLinkW\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"GetTickCount64\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"GetFileInformationByHandleEx\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"SetFileInformationByHandle\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"GetSystemTimePreciseAsFileTime\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"InitializeConditionVariable\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"WakeConditionVariable\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"WakeAllConditionVariable\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"SleepConditionVariableCS\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"InitializeSRWLock\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"AcquireSRWLockExclusive\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"TryAcquireSRWLockExclusive\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"ReleaseSRWLockExclusive\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"SleepConditionVariableSRW\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"CreateThreadpoolWork\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"SubmitThreadpoolWork\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"CloseThreadpoolWork\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"CompareStringEx\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"GetLocaleInfoEx\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"LCMapStringEx\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"AreFileApisANSI\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"EnumSystemLocalesEx\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"GetDateFormatEx\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"GetTimeFormatEx\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"GetUserDefaultLocaleName\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"IsValidLocaleName\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"LCIDToLocaleName\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"LocaleNameToLCID\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"NetLocalGroupAddMember\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"NetUserGetGroups\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"NetUserAdd\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"NetGroupGetInfo\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"NetApiBufferFree\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"NetUserGetInfo\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"HttpOpenRequestW\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"InternetOpenW\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"HttpSendRequestW\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"InternetCloseHandle\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"InternetConnectW\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"GetIpAddrTable\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"GetIfEntry\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"CreateDirectoryW\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"WriteFile\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"GetTempPathW\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"WaitForSingleObject\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"CreateFileW\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"GetFileAttributesW\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"Sleep\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"GetLastError\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"DeleteFileW\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"CloseHandle\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"CreateThread\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"CreateProcessW\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"GetTempFileNameW\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"LoadImageW\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"UpdateWindow\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"PostQuitMessage\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"LoadCursorW\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"DispatchMessageW\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"ShowWindow\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"GetSystemMetrics\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"CreateWindowExW\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"DefWindowProcW\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"RegEnumValueW\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"LookupAccountSidW\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"RegOpenKeyExW\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"RegCreateKeyExW\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"CreateWellKnownSid\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"RegCloseKey\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"WideCharToMultiByte\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"EnterCriticalSection\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"LeaveCriticalSection\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"DeleteCriticalSection\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"SetLastError\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"InitializeCriticalSectionAndSpinCount\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"SwitchToThread\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"TlsAlloc\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"TlsGetValue\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"TlsSetValue\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"TlsFree\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"GetSystemTimeAsFileTime\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"GetModuleHandleW\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"GetProcAddress\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"EncodePointer\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"DecodePointer\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"MultiByteToWideChar\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"LCMapStringW\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"GetLocaleInfoW\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"GetStringTypeW\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"GetCPInfo\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"RtlCaptureContext\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"RtlLookupFunctionEntry\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"RtlVirtualUnwind\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"UnhandledExceptionFilter\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"SetUnhandledExceptionFilter\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"GetCurrentProcess\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"TerminateProcess\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"IsProcessorFeaturePresent\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"IsDebuggerPresent\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"GetStartupInfoW\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"QueryPerformanceCounter\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"GetCurrentProcessId\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"GetCurrentThreadId\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"InitializeSListHead\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"RtlPcToFileHeader\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"RaiseException\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"FreeLibrary\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"LoadLibraryExW\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"ExitProcess\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"GetModuleHandleExW\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"GetModuleFileNameW\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"GetStdHandle\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"HeapFree\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"IsValidLocale\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"GetUserDefaultLCID\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"EnumSystemLocalesW\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"HeapAlloc\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"HeapReAlloc\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"GetFileType\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"FindClose\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"FindFirstFileExW\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"FindNextFileW\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"IsValidCodePage\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"GetACP\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"GetOEMCP\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"GetCommandLineA\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"GetCommandLineW\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"GetEnvironmentStringsW\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"FreeEnvironmentStringsW\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"GetProcessHeap\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"SetStdHandle\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"SetFilePointerEx\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"HeapSize\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"FlushFileBuffers\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"GetConsoleCP\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"GetConsoleMode\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API (Indicator: \"WriteConsoleW\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")",
      "Comment": "The function performs structured exception handling and context capture to manage critical failures or fast-fail conditions. It begins by checking for the presence of a specific processor feature and, if available, triggers a software interrupt to initiate a fast fail. It then captures the current CPU context using `RtlCaptureContext` and attempts to locate the corresponding runtime function entry with `RtlLookupFunctionEntry`. If a valid function entry is found, the function performs a virtual unwind of the stack frame via `RtlVirtualUnwind` to retrieve detailed exception context information.\n\nSubsequently, the function initializes an exception record structure and checks if a debugger is present using `IsDebuggerPresent`. It disables any existing unhandled exception filter by calling `SetUnhandledExceptionFilter` with a null pointer, then invokes `UnhandledExceptionFilter` to process the exception pointers it prepared. If the exception filter returns zero and no debugger is detected, the function calls an internal routine to handle the failure further.\n\nOverall, this function is designed to handle fast-fail scenarios by capturing detailed exception context, unwinding the stack to identify the faulting function, and invoking system-level exception filters. It interacts primarily with low-level Windows APIs related to exception handling (`RtlCaptureContext`, `RtlLookupFunctionEntry`, `RtlVirtualUnwind`, `SetUnhandledExceptionFilter`, `UnhandledExceptionFilter`) and debugger detection (`IsDebuggerPresent`). The function’s control flow is conditional and sequential, ensuring that exception context is accurately captured and processed before potentially terminating or escalating the failure.",
      "Matched Sentence": "It interacts primarily with low-level Windows APIs related to exception handling (`RtlCaptureContext`, `RtlLookupFunctionEntry`, `RtlVirtualUnwind`, `SetUnhandledExceptionFilter`, `UnhandledExceptionFilter`) and debugger detection (`IsDebuggerPresent`).",
      "Similarity": 0.818691
    }
  ],
  "FUN_14000ba0c_1": [],
  "FUN_14000b9d0_1": [],
  "_CallSETranslator<>_1": [],
  "__FrameHandler3::CatchTryBlock_1": [],
  "__FrameHandler3::ExecutionInCatch_1": [],
  "__scrt_is_managed_app_1": [
    {
      "ATT&CK ID": "T1497.002",
      "Indicator": "Able to identify virtual environment by using user activity (API string): Found string \"GetCommandLineW\" (Indicator: \"GetCommandLine\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found string \"GetCommandLineA\" (Indicator: \"GetCommandLine\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found string \"GetCommandLineA\" (Indicator: \"GetCommandLine\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found string \"GetCommandLineW\" (Indicator: \"GetCommandLine\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")",
      "Comment": "The function begins by obtaining a handle to the current module using `GetModuleHandleW` with a `NULL` parameter, effectively retrieving the base address of the executable image in memory. It then performs a series of validations on the module’s headers to determine if the executable is a managed application.\n\nSpecifically, the function first checks the DOS header signature by verifying that the first two bytes equal the \"MZ\" magic number (`0x5A4D`). It then locates the PE header by using the offset stored in the DOS header and confirms the PE signature (`0x4550`). Following this, it inspects the Optional Header’s `Magic` field to verify that it matches the PE32+ format (`0x20B`), indicating a 64-bit executable. Additionally, it checks the `MajorLinkerVersion` field to ensure it meets a minimum version threshold (at least 15). Finally, it examines a specific data directory entry (likely the CLI header directory) to determine if it is non-zero, which would indicate the presence of a managed runtime header.\n\nIf all these conditions are met, the function returns the value `0x201`, signaling that the executable is a managed application (i.e., it contains a .NET runtime header). Otherwise, it returns a value derived from the failed check, effectively indicating that the executable is unmanaged.\n\nIn summary, this function analyzes the in-memory PE headers of the current executable to detect whether it is a managed (.NET) application by validating the DOS and PE signatures, confirming the PE32+ format, checking linker version, and verifying the presence of the CLI header. This behavior is typical for runtime checks that differentiate between native and managed binaries.",
      "Matched Sentence": "Finally, it examines a specific data directory entry (likely the CLI header directory) to determine if it is non-zero, which would indicate the presence of a managed runtime header.",
      "Similarity": 0.763269
    },
    {
      "ATT&CK ID": "T1027",
      "Indicator": "Matched Compiler/Packer signature (DIE): \"1bc5621a4818f2124ac085da21f607ca\" was detected as \"Microsoft Visual C/C++\"  and name: \"Compiler\"\n \"1bc5621a4818f2124ac085da21f607ca\" was detected as \"Microsoft Linker\"  and name: \"Linker\"",
      "Comment": "The function begins by obtaining a handle to the current module using `GetModuleHandleW` with a `NULL` parameter, effectively retrieving the base address of the executable image in memory. It then performs a series of validations on the module’s headers to determine if the executable is a managed application.\n\nSpecifically, the function first checks the DOS header signature by verifying that the first two bytes equal the \"MZ\" magic number (`0x5A4D`). It then locates the PE header by using the offset stored in the DOS header and confirms the PE signature (`0x4550`). Following this, it inspects the Optional Header’s `Magic` field to verify that it matches the PE32+ format (`0x20B`), indicating a 64-bit executable. Additionally, it checks the `MajorLinkerVersion` field to ensure it meets a minimum version threshold (at least 15). Finally, it examines a specific data directory entry (likely the CLI header directory) to determine if it is non-zero, which would indicate the presence of a managed runtime header.\n\nIf all these conditions are met, the function returns the value `0x201`, signaling that the executable is a managed application (i.e., it contains a .NET runtime header). Otherwise, it returns a value derived from the failed check, effectively indicating that the executable is unmanaged.\n\nIn summary, this function analyzes the in-memory PE headers of the current executable to detect whether it is a managed (.NET) application by validating the DOS and PE signatures, confirming the PE32+ format, checking linker version, and verifying the presence of the CLI header. This behavior is typical for runtime checks that differentiate between native and managed binaries.",
      "Matched Sentence": "This behavior is typical for runtime checks that differentiate between native and managed binaries.",
      "Similarity": 0.791192
    }
  ],
  "FUN_14000bd94_1": [],
  "__FrameHandler3::GetEstablisherFrame_1": [],
  "FUN_14000bc54_1": [],
  "_GetImageBase_1": [],
  "_GetThrowImageBase_1": [],
  "FUN_14000bf70_1": [],
  "_FindAndUnlinkFrame_1": [],
  "__CxxFrameHandler3_1": [],
  "__FrameHandler3::FrameUnwindToEmptyState_1": [],
  "__std_exception_destroy_1": [],
  "__std_exception_copy_1": [],
  "_purecall_1": [],
  "FUN_14000c184_1": [],
  "_IsExceptionObjectToBeDestroyed_1": [],
  "Unwind@14000c228_1": [],
  "__DestructExceptionObject_1": [],
  "__AdjustPointer_1": [],
  "__FrameUnwindFilter_1": [],
  "__vcrt_initialize_1": [],
  "memcmp_1": [],
  "FUN_14000c740_1": [],
  "FUN_14000c330_1": [],
  "FUN_14000c900_1": [
    {
      "ATT&CK ID": "T1027",
      "Indicator": "YARA signature match – ROR algorithm: YARA signature matched on R0R instruction used in file \"sample.bin\"",
      "Comment": "The function performs a specialized search operation within a given memory buffer, scanning for the first occurrence of a specific byte value derived from an input parameter. It takes three parameters: a pointer to a character buffer, a byte-sized value, and a length indicating the number of bytes to examine.\n\nInitially, if the length exceeds 15 bytes, the function optimizes the search by processing the buffer in 16-byte blocks. For each block, it compares every byte against a repeated pattern constructed from the input byte value. This pattern is formed by replicating the single byte across all four bytes of a 32-bit integer, effectively creating a 16-byte sequence of identical bytes. The function then uses a vectorized comparison approach, generating a mask that identifies which bytes in the current block match the target byte. If any matches are found, it calculates and returns the exact pointer to the first matching byte within that block.\n\nIf no match is found in the 16-byte blocks or if the length is 15 bytes or less, the function falls back to a byte-by-byte linear search. It iterates through the remaining bytes, comparing each one directly to the target byte until a match is found or the buffer is exhausted. If a match is found, it returns a pointer to that byte; otherwise, it returns null.\n\nThis function does not interact with external system resources such as files, registry keys, or network components. Its behavior is purely computational and memory-oriented, focusing on efficient byte searching within a buffer. The use of block-wise comparison and bitmasking indicates an optimization for performance, likely aiming to accelerate searches in large buffers by leveraging parallel comparisons.",
      "Matched Sentence": "The use of block-wise comparison and bitmasking indicates an optimization for performance, likely aiming to accelerate searches in large buffers by leveraging parallel comparisons.",
      "Similarity": 0.757852
    }
  ],
  "FUN_14000c234_1": [],
  "__vcrt_uninitialize_1": [],
  "FUN_14000ccd0_1": [],
  "__vcrt_getptd_1": [],
  "__std_type_info_compare_1": [],
  "__vcrt_getptd_noinit_1": [],
  "__vcrt_initialize_ptd_1": [],
  "__vcrt_getptd_noexit_1": [
    {
      "ATT&CK ID": "T1106",
      "Indicator": "Contains ability to set/get the last-error code for a calling thread (API string): Found reference to API \"SetLastError\" (Indicator: \"SetLastError\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API \"GetLastError\" (Indicator: \"GetLastError\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API \"GetLastError\" (Indicator: \"GetLastError\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API \"SetLastError\" (Indicator: \"SetLastError\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")",
      "Comment": "The function manages thread-local storage (TLS) data by interacting with the Windows Fiber Local Storage (FLS) APIs. It first checks a global index variable to determine if TLS is initialized. If uninitialized, it returns `NULL`. Otherwise, it retrieves the current thread’s TLS data pointer using `__vcrt_FlsGetValue`. If the retrieved pointer is invalid (`0xFFFFFFFF`), it returns `NULL`. If the pointer is `NULL`, the function attempts to allocate a new TLS data block of 128 bytes using a custom allocator (`_calloc_base`). It then sets this newly allocated block into the TLS slot with `__vcrt_FlsSetValue`. If setting the TLS value fails, it cleans up by resetting the TLS slot to `NULL`. Upon successful allocation and setting, it initializes a specific field within the TLS block (offset 0x78) to `0xFFFFFFFE`, likely marking the TLS data as newly created or in a special state. The function preserves the original thread error code throughout its execution by saving and restoring it with `GetLastError` and `SetLastError`. Finally, it returns the pointer to the TLS data block associated with the current thread, either existing or newly allocated. This behavior ensures that each thread has a dedicated, lazily initialized TLS data structure for runtime use.",
      "Matched Sentence": "The function preserves the original thread error code throughout its execution by saving and restoring it with `GetLastError` and `SetLastError`.",
      "Similarity": 0.841561
    }
  ],
  "__FrameHandler3::GetUnwindTryBlock_1": [],
  "__FrameHandler3::GetCurrentState_1": [],
  "__C_specific_handler_1": [],
  "__FrameHandler3::SetUnwindTryBlock_1": [],
  "__FrameHandler3::StateFromIp_1": [],
  "BuildCatchObjectInternal<class___FrameHandler3>_1": [],
  "CatchIt<class___FrameHandler3>_1": [],
  "FUN_14000cf94_1": [],
  "FUN_14000d804_1": [],
  "TypeMatchHelper<>_1": [],
  "FUN_14000db5c_1": [],
  "ExFilterRethrow_1": [],
  "Is_bad_exception_allowed_1": [],
  "__FrameHandler3::GetHandlerSearchState_1": [],
  "FUN_14000e410_1": [],
  "FUN_14000e074_1": [],
  "FUN_14000e42c_1": [],
  "FUN_14000e298_1": [],
  "_CallMemberFunction2_1": [],
  "__vcrt_initialize_locks_1": [],
  "__vcrt_uninitialize_locks_1": [],
  "__FrameHandler3::CxxCallCatchBlock_1": [],
  "__vcrt_FlsFree_1": [],
  "__vcrt_FlsAlloc_1": [
    {
      "ATT&CK ID": "T1055.003",
      "Indicator": "Creates a thread in a self process: \"1bc5621a4818f2124ac085da21f607ca.exe\" creates a thread in process \"-1\" (Handle: FFFFFFFFFFFFFFFF)",
      "Comment": "The function attempts to dynamically resolve the `FlsAlloc` function at runtime by calling a helper routine (`try_get_function`) with the target function name and module identifiers. If the resolution succeeds (i.e., the function pointer is non-null), it invokes the resolved `FlsAlloc` function indirectly through a guarded dispatch call, passing along the original parameter. If the resolution fails, the function falls back to calling the `TlsAlloc` API directly. This behavior indicates a compatibility or fallback mechanism where `FlsAlloc`—a fiber-local storage allocation function introduced in newer Windows versions—is preferred, but `TlsAlloc`—a thread-local storage allocation function—is used as a backup on systems where `FlsAlloc` is unavailable. The function thus interacts with system APIs related to thread or fiber local storage management, dynamically adapting to the runtime environment to allocate local storage indices.",
      "Matched Sentence": "The function thus interacts with system APIs related to thread or fiber local storage management, dynamically adapting to the runtime environment to allocate local storage indices.",
      "Similarity": 0.76846
    }
  ],
  "__vcrt_FlsGetValue_1": [],
  "__vcrt_InitializeCriticalSectionEx_1": [
    {
      "ATT&CK ID": "T1497.003",
      "Indicator": "Contains ability to delay execution by waiting for signal/timeout (API string): Found reference to API \"WaitForSingleObject\" (Indicator: \"WaitForSingleObject\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API \"QueryPerformanceCounter\" (Indicator: \"QueryPerformanceCounter\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API \"GetSystemTimeAsFileTime\" (Indicator: \"GetSystemTimeAsFileTime\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API \"GetTickCount64\" (Indicator: \"GetTickCount64\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API \"GetTickCount64\" (Indicator: \"GetTickCount64\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API \"WaitForSingleObject\" (Indicator: \"WaitForSingleObject\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API \"GetSystemTimeAsFileTime\" (Indicator: \"GetSystemTimeAsFileTime\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API \"QueryPerformanceCounter\" (Indicator: \"QueryPerformanceCounter\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")",
      "Comment": "The function attempts to initialize a critical section object with enhanced parameters by first trying to dynamically resolve the `InitializeCriticalSectionEx` API at runtime. It calls a helper function to retrieve the address of `InitializeCriticalSectionEx` from the system libraries. If this function pointer is successfully obtained, the function invokes `InitializeCriticalSectionEx` with the provided critical section pointer, spin count, and additional flags, enabling more fine-grained control over the critical section’s behavior. If the API is unavailable (likely on older Windows versions), the function falls back to calling `InitializeCriticalSectionAndSpinCount`, a less flexible but compatible alternative, passing the critical section pointer and spin count only. This approach ensures compatibility across different Windows versions by dynamically adapting to the available synchronization APIs without causing failures. The function does not interact with files, registry keys, or other system resources beyond synchronization primitives, focusing solely on setting up thread synchronization objects safely and efficiently.",
      "Matched Sentence": "If the API is unavailable (likely on older Windows versions), the function falls back to calling `InitializeCriticalSectionAndSpinCount`, a less flexible but compatible alternative, passing the critical section pointer and spin count only.",
      "Similarity": 0.80735
    }
  ],
  "try_get_function_1": [
    {
      "ATT&CK ID": "T1129",
      "Indicator": "Loads modules at runtime: \"1bc5621a4818f2124ac085da21f607ca.exe\" loaded module \"API-MS-WIN-CORE-SYNCH-L1-2-0\" at base 7ffd21a00000\n \"1bc5621a4818f2124ac085da21f607ca.exe\" loaded module \"API-MS-WIN-CORE-FIBERS-L1-1-1\" at base 7ffd21a00000\n \"1bc5621a4818f2124ac085da21f607ca.exe\" loaded module \"API-MS-WIN-CORE-LOCALIZATION-L1-2-1\" at base 7ffd21a00000\n \"1bc5621a4818f2124ac085da21f607ca.exe\" loaded module \"KERNEL32\" at base 7ffd24360000\n \"1bc5621a4818f2124ac085da21f607ca.exe\" loaded module \"%WINDIR%\\SYSTEM32\\ICONCODECSERVICE.DLL\" at base 7ffd10030000\n \"1bc5621a4818f2124ac085da21f607ca.exe\" loaded module \"%WINDIR%\\SYSTEM32\\UXTHEME.DLL\" at base 7ffd1f380000\n \"1bc5621a4818f2124ac085da21f607ca.exe\" loaded module \"KERNEL32.DLL\" at base 7ffd24360000\n \"1bc5621a4818f2124ac085da21f607ca.exe\" loaded module \"OLEAUT32.DLL\" at base 7ffd22760000\n \"1bc5621a4818f2124ac085da21f607ca.exe\" loaded module \"RPCRT4.DLL\" at base 7ffd220f0000\n \"1bc5621a4818f2124ac085da21f607ca.exe\" loaded module \"EXT-MS-WIN-RTCORE-NTUSER-WINDOW-EXT-L1-1-0.DLL\" at base 7ffd21ec0000\n \"1bc5621a4818f2124ac085da21f607ca.exe\" loaded module \"EXT-MS-WIN-RTCORE-NTUSER-INTEGRATION-L1-1-0.DLL\" at base 7ffd21ec0000\n \"1bc5621a4818f2124ac085da21f607ca.exe\" loaded module \"API-MS-WIN-CORE-COM-L1-1-0.DLL\" at base 7ffd222e0000\n \"1bc5621a4818f2124ac085da21f607ca.exe\" loaded module \"%WINDIR%\\SYSTEM32\\MSCTF.DLL\" at base 7ffd22c80000\n \"1bc5621a4818f2124ac085da21f607ca.exe\" loaded module \"%WINDIR%\\SYSTEM32\\OLE32.DLL\" at base 7ffd22830000\n \"1bc5621a4818f2124ac085da21f607ca.exe\" loaded module \"NTDLL.DLL\" at base 7ffd249f0000\n \"1bc5621a4818f2124ac085da21f607ca.exe\" loaded module \"%WINDIR%\\SYSTEM32\\BCRYPTPRIMITIVES.DLL\" at base 7ffd20fb0000\n \"1bc5621a4818f2124ac085da21f607ca.exe\" loaded module \"API-MS-WIN-CORE-STRING-L1-1-0\" at base 7ffd21a00000\n \"1bc5621a4818f2124ac085da21f607ca.exe\" loaded module \"API-MS-WIN-CORE-DATETIME-L1-1-1\" at base 7ffd21a00000\n \"1bc5621a4818f2124ac085da21f607ca.exe\" loaded module \"API-MS-WIN-CORE-LOCALIZATION-OBSOLETE-L1-2-0\" at base 7ffd21a00000\n \"1bc5621a4818f2124ac085da21f607ca.exe\" loaded module \"SSPICLI.DLL\" at base 7ffd20c40000\n \"1bc5621a4818f2124ac085da21f607ca.exe\" loaded module \"USER32.DLL\" at base 7ffd21ec0000\n \"1bc5621a4818f2124ac085da21f607ca.exe\" loaded module \"ONDEMANDCONNROUTEHELPER.DLL\" at base 7ffd028f0000\n \"1bc5621a4818f2124ac085da21f607ca.exe\" loaded module \"WINHTTP.DLL\" at base 7ffd1d370000\n \"1bc5621a4818f2124ac085da21f607ca.exe\" loaded module \"%WINDIR%\\SYSTEM32\\ONDEMANDCONNROUTEHELPER.DLL\" at base 7ffd028f0000\n \"1bc5621a4818f2124ac085da21f607ca.exe\" loaded module \"%WINDIR%\\SYSTEM32\\MSWSOCK.DLL\" at base 7ffd205d0000\n \"1bc5621a4818f2124ac085da21f607ca.exe\" loaded module \"MSISO.DLL\" at base 7ffd0cfb0000\n \"1bc5621a4818f2124ac085da21f607ca.exe\" loaded module \"%WINDIR%\\SYSTEM32\\RASADHLP.DLL\" at base 7ffd18870000\n \"1bc5621a4818f2124ac085da21f607ca.exe\" loaded module \"%WINDIR%\\SYSTEM32\\FWPUCLNT.DLL\" at base 7ffd19ee0000\n \"1bc5621a4818f2124ac085da21f607ca.exe\" loaded module \"%WINDIR%\\SYSTEM32\\WS2_32\" at base 7ffd24480000\n \"1bc5621a4818f2124ac085da21f607ca.exe\" loaded module \"API-MS-WIN-APPMODEL-RUNTIME-L1-1-2\" at base 7ffd20d80000",
      "Comment": "The function implements a dynamic API resolution mechanism that attempts to retrieve a function pointer based on a given function identifier and function name. It maintains an internal cache of resolved function pointers, which are stored in an obfuscated form using bitwise rotations and XOR operations keyed by a global variable. When a cached pointer is available and valid, it returns it immediately to avoid redundant lookups.\n\nIf the function pointer is not cached, the function iterates over a range of module identifiers representing system DLLs, attempting to load each corresponding module dynamically using `LoadLibraryExW`. It applies specific flags to the loading process and includes fallback logic to handle known error conditions, particularly for modules with names starting with \"api-ms-\" or \"ext-ms-\". Successfully loaded modules are cached in a global array to prevent repeated loads.\n\nOnce a module is loaded, the function uses `GetProcAddress` to locate the requested function by name within the module. If found, the function pointer is obfuscated and stored in the cache for future calls. If the function cannot be found, a sentinel value is stored to mark the failure and avoid repeated unsuccessful lookups.\n\nThroughout this process, the function employs synchronization primitives (indicated by `LOCK()` and `UNLOCK()` calls) to ensure thread-safe access to the shared caches of module handles and function pointers. The overall behavior optimizes repeated dynamic function resolution by caching results and handling module loading with error-aware fallbacks, enabling efficient and safe retrieval of API functions at runtime.",
      "Matched Sentence": "If the function pointer is not cached, the function iterates over a range of module identifiers representing system DLLs, attempting to load each corresponding module dynamically using `LoadLibraryExW`.",
      "Similarity": 0.824952
    }
  ],
  "__vcrt_initialize_winapi_thunks_1": [],
  "__vcrt_FlsSetValue_1": [],
  "__vcrt_uninitialize_winapi_thunks_1": [],
  "_CallSettingFrame_1": [],
  "__except_validate_context_record_1": [],
  "_NLG_Notify_1": [
    {
      "ATT&CK ID": "T1055.001",
      "Indicator": "Contains ability to load/free library (API string): Found reference to API \"FreeLibrary\" (Indicator: \"FreeLibrary\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API \"LoadLibraryExW\" (Indicator: \"LoadLibrary\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API \"FreeLibraryWhenCallbackReturns\" (Indicator: \"FreeLibrary\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API \"FreeLibraryWhenCallbackReturns\" (Indicator: \"FreeLibrary\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API \"FreeLibrary\" (Indicator: \"FreeLibrary\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API \"LoadLibraryExW\" (Indicator: \"LoadLibrary\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")",
      "Comment": "The function initiates by dynamically loading essential system libraries and resolving critical API functions required for file and registry operations. It constructs specific file paths within the user’s environment, typically targeting locations such as the user’s application data directory or system folders. Using APIs like `CreateFileW`, the function attempts to create or open files, often with the intent to drop or modify executable or configuration files.\n\nSubsequently, the function interacts with the Windows Registry by opening or creating keys under paths commonly associated with system startup or application settings, such as `HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run`. It uses `RegSetValueExW` to write values that point to the dropped files, effectively establishing persistence by ensuring the dropped payload executes on system startup.\n\nControl flow within the function is structured around conditional checks that verify the success of file and registry operations, with loops or repeated attempts to handle failures or to confirm the presence of required files and registry entries. This ensures robustness in establishing persistence.\n\nOverall, the function’s behavior centers on persistence mechanisms by dropping files into strategic locations and modifying registry keys to guarantee execution upon user login. It leverages Windows API calls for file creation and registry manipulation, targeting system components that control startup behavior, thereby embedding itself into the system’s boot process.",
      "Matched Sentence": "The function initiates by dynamically loading essential system libraries and resolving critical API functions required for file and registry operations.",
      "Similarity": 0.82082
    },
    {
      "ATT&CK ID": "T1012",
      "Indicator": "Opens registry keys: \"1bc5621a4818f2124ac085da21f607ca.exe\" (Access type: \"OPEN\"; Path: \"HKLM\\SOFTWARE\\POLICIES\\MICROSOFT\\WINDOWS\\CURRENTVERSION\\INTERNET SETTINGS\\\"; Key: \"\"; Value: \"\")\n \"1bc5621a4818f2124ac085da21f607ca.exe\" (Access type: \"OPEN\"; Path: \"HKCU\\SOFTWARE\\MICROSOFT\\INTERNET EXPLORER\\MAIN\\FEATURECONTROL\\FEATURE_IGNORE_POLICIES_ZONEMAP_IF_ESC_ENABLED_KB918915\"; Key: \"\"; Value: \"\")\n \"1bc5621a4818f2124ac085da21f607ca.exe\" (Access type: \"OPEN\"; Path: \"HKLM\\SOFTWARE\\MICROSOFT\\INTERNET EXPLORER\\MAIN\\FEATURECONTROL\\FEATURE_IGNORE_POLICIES_ZONEMAP_IF_ESC_ENABLED_KB918915\"; Key: \"\"; Value: \"\")\n \"1bc5621a4818f2124ac085da21f607ca.exe\" (Access type: \"OPEN\"; Path: \"HKLM\\SOFTWARE\\POLICIES\\MICROSOFT\\WINDOWS\\CURRENTVERSION\\INTERNET SETTINGS\\ZONEMAP\\DOMAINS\\\"; Key: \"\"; Value: \"\")\n \"1bc5621a4818f2124ac085da21f607ca.exe\" (Access type: \"OPEN\"; Path: \"HKCU\\SOFTWARE\\POLICIES\\MICROSOFT\\WINDOWS\\CURRENTVERSION\\INTERNET SETTINGS\\ZONEMAP\\DOMAINS\\\"; Key: \"\"; Value: \"\")\n \"1bc5621a4818f2124ac085da21f607ca.exe\" (Access type: \"OPEN\"; Path: \"HKLM\\ZONEMAP\\RANGES\\\"; Key: \"\"; Value: \"\")\n \"1bc5621a4818f2124ac085da21f607ca.exe\" (Access type: \"OPEN\"; Path: \"HKCU\\ZONEMAP\\RANGES\\\"; Key: \"\"; Value: \"\")\n \"1bc5621a4818f2124ac085da21f607ca.exe\" (Access type: \"OPEN\"; Path: \"HKCU\\SOFTWARE\\MICROSOFT\\INTERNET EXPLORER\\MAIN\\FEATURECONTROL\\FEATURE_ZONES_CHECK_ZONEMAP_POLICY_KB941001\"; Key: \"\"; Value: \"\")\n \"1bc5621a4818f2124ac085da21f607ca.exe\" (Access type: \"OPEN\"; Path: \"HKLM\\SOFTWARE\\MICROSOFT\\INTERNET EXPLORER\\MAIN\\FEATURECONTROL\\FEATURE_ZONES_CHECK_ZONEMAP_POLICY_KB941001\"; Key: \"\"; Value: \"\")\n \"1bc5621a4818f2124ac085da21f607ca.exe\" (Access type: \"OPEN\"; Path: \"HKLM\\SOFTWARE\\POLICIES\\MICROSOFT\\WINDOWS\\CURRENTVERSION\\INTERNET SETTINGS\\ZONEMAP\"; Key: \"\"; Value: \"\")\n \"1bc5621a4818f2124ac085da21f607ca.exe\" (Access type: \"OPEN\"; Path: \"HKCU\\SOFTWARE\\POLICIES\\MICROSOFT\\WINDOWS\\CURRENTVERSION\\INTERNET SETTINGS\\ZONEMAP\"; Key: \"\"; Value: \"\")\n \"1bc5621a4818f2124ac085da21f607ca.exe\" (Access type: \"OPEN\"; Path: \"HKLM\\SOFTWARE\\MICROSOFT\\WINDOWS\\CURRENTVERSION\\INTERNET SETTINGS\\ZONEMAP\\\"; Key: \"\"; Value: \"\")\n \"1bc5621a4818f2124ac085da21f607ca.exe\" (Access type: \"OPEN\"; Path: \"HKCU\\SOFTWARE\\POLICIES\\MICROSOFT\\WINDOWS\\CURRENTVERSION\\INTERNET SETTINGS\\ZONEMAP\\\"; Key: \"\"; Value: \"\")\n \"1bc5621a4818f2124ac085da21f607ca.exe\" (Access type: \"OPEN\"; Path: \"HKLM\\SOFTWARE\\POLICIES\\MICROSOFT\\WINDOWS\\CURRENTVERSION\\INTERNET SETTINGS\\ZONEMAP\\\"; Key: \"\"; Value: \"\")\n \"1bc5621a4818f2124ac085da21f607ca.exe\" (Access type: \"OPEN\"; Path: \"HKCU\\SOFTWARE\\POLICIES\\MICROSOFT\\INTERNET EXPLORER\"; Key: \"\"; Value: \"\")\n \"1bc5621a4818f2124ac085da21f607ca.exe\" (Access type: \"OPEN\"; Path: \"HKCU\\SOFTWARE\\POLICIES\\MICROSOFT\\INTERNET EXPLORER\\SECURITY\"; Key: \"\"; Value: \"\")\n \"1bc5621a4818f2124ac085da21f607ca.exe\" (Access type: \"OPEN\"; Path: \"HKCU\\SOFTWARE\\MICROSOFT\\INTERNET EXPLORER\\SECURITY\"; Key: \"\"; Value: \"\")\n \"1bc5621a4818f2124ac085da21f607ca.exe\" (Access type: \"OPEN\"; Path: \"HKLM\\SYSTEM\\SETUP\"; Key: \"\"; Value: \"\")\n \"1bc5621a4818f2124ac085da21f607ca.exe\" (Access type: \"OPEN\"; Path: \"HKCU\\SOFTWARE\\MICROSOFT\\WINDOWS\\CURRENTVERSION\\INTERNET SETTINGS\\ZONES\\\"; Key: \"\"; Value: \"\")\n \"1bc5621a4818f2124ac085da21f607ca.exe\" (Access type: \"OPEN\"; Path: \"HKCU\\SOFTWARE\\MICROSOFT\\WINDOWS\\CURRENTVERSION\\INTERNET SETTINGS\\ZONES\\0\"; Key: \"\"; Value: \"\")\n \"1bc5621a4818f2124ac085da21f607ca.exe\" (Access type: \"OPEN\"; Path: \"HKCU\\SOFTWARE\\MICROSOFT\\WINDOWS\\CURRENTVERSION\\INTERNET SETTINGS\\ZONES\\1\"; Key: \"\"; Value: \"\")\n \"1bc5621a4818f2124ac085da21f607ca.exe\" (Access type: \"OPEN\"; Path: \"HKCU\\SOFTWARE\\MICROSOFT\\WINDOWS\\CURRENTVERSION\\INTERNET SETTINGS\\ZONES\\2\"; Key: \"\"; Value: \"\")",
      "Comment": "The function initiates by dynamically loading essential system libraries and resolving critical API functions required for file and registry operations. It constructs specific file paths within the user’s environment, typically targeting locations such as the user’s application data directory or system folders. Using APIs like `CreateFileW`, the function attempts to create or open files, often with the intent to drop or modify executable or configuration files.\n\nSubsequently, the function interacts with the Windows Registry by opening or creating keys under paths commonly associated with system startup or application settings, such as `HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run`. It uses `RegSetValueExW` to write values that point to the dropped files, effectively establishing persistence by ensuring the dropped payload executes on system startup.\n\nControl flow within the function is structured around conditional checks that verify the success of file and registry operations, with loops or repeated attempts to handle failures or to confirm the presence of required files and registry entries. This ensures robustness in establishing persistence.\n\nOverall, the function’s behavior centers on persistence mechanisms by dropping files into strategic locations and modifying registry keys to guarantee execution upon user login. It leverages Windows API calls for file creation and registry manipulation, targeting system components that control startup behavior, thereby embedding itself into the system’s boot process.",
      "Matched Sentence": "Subsequently, the function interacts with the Windows Registry by opening or creating keys under paths commonly associated with system startup or application settings, such as `HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run`.",
      "Similarity": 0.828871
    }
  ],
  "_CallSettingFrameEncoded_1": [],
  "terminate_1": [],
  "FUN_14000ead0_1": [],
  "FUN_14000ecf8_1": [],
  "FUN_14000ed18_1": [
    {
      "ATT&CK ID": "T1083",
      "Indicator": "Tries to access non-existent files (non-executable): \"1bc5621a4818f2124ac085da21f607ca.exe\" trying to access non-existent file \"C:\\1BC5621A4818F2124AC085DA21F607CA.EXE.LOCAL\"\n \"1bc5621a4818f2124ac085da21f607ca.exe\" trying to access non-existent file \"\\DEVICE\\NETBT_TCPIP_{D27478B9-2058-11E8-B41F-806E6F6E6963}\"\n \"1bc5621a4818f2124ac085da21f607ca.exe\" trying to access non-existent file \"\\Device\\RasAcd\"",
      "Comment": "The function immediately triggers a critical error handling routine by calling `_invalid_parameter` with all null parameters, followed by invoking `_invoke_watson`, which is a system-level error reporting and crash handling mechanism. This sequence forcibly raises a structured exception or crash event without performing any additional operations or checks. Essentially, the function acts as a deliberate termination point that signals an invalid parameter condition and then invokes the Windows error reporting system to handle the fault, likely causing the process to halt or generate a crash dump. There are no interactions with files, registry keys, or other system resources beyond this error signaling behavior.",
      "Matched Sentence": "There are no interactions with files, registry keys, or other system resources beyond this error signaling behavior.",
      "Similarity": 0.778904
    }
  ],
  "wcscpy_s_1": [],
  "wcscat_s_1": [
    {
      "ATT&CK ID": "T1573.001",
      "Indicator": "Able to use PEM certificate for encryption and decryption: file/memory contains long string with certificate marker \"----BEGIN CERTIFICATE----\" (File: \"1bc5621a4818f2124ac085da21f607ca\")\n file/memory contains long string with certificate marker \"----END CERTIFICATE----\" (File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found certificate marker \"----END CERTIFICATE----\" in \"nRpwLM6qvE5QRFBCqpI0/43Y0Wj35NY/tWcbPYdDyhN+Jrx0DCwmMKSP8Qnk857L4e0Z10OfJfdA+WqA2ZhKOPgF3Zkp7n7pITzs7HSKV877d4NsFT59WKhf0wwSBpG14pKJoxtLdo4BhyB7U1mY8fkOqWCwIZNvRTDfXmSo2dFvlGrvsUS1P+n6OjOO8tBc/UEOJbmP7-----END CERTIFICATE-----\" (File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found certificate marker \"----BEGIN CERTIFICATE----\" in \"-----BEGIN CERTIFICATE-----\" (Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found certificate marker \"----END CERTIFICATE----\" in \"-----END CERTIFICATE-----\" (Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")",
      "Comment": "The function implements a safe wide-character string concatenation routine similar to `wcscat_s`. It appends the source wide-character string (`_Src`) to the destination buffer (`_Dst`), ensuring that the total length does not exceed the specified buffer size (`_SizeInWords`). The function first scans the destination buffer to find its null terminator, adjusting the remaining buffer size accordingly. It then copies characters from the source string into the destination buffer starting at the null terminator position, stopping either when the source string’s null terminator is copied or when the buffer size limit is reached.\n\nIf the concatenation completes successfully without exceeding the buffer size, the function returns zero, indicating success. If the source string is too large to fit in the remaining space of the destination buffer, the function sets the destination buffer to an empty string, updates the thread-local DOS error code to `ERROR_INVALID_PARAMETER` (0x22), and calls an internal error handling routine before returning the error code. Similarly, if the destination pointer is null or the buffer size is zero, it sets the DOS error to `ERROR_INVALID_PARAMETER` (0x16) and returns that error.\n\nOverall, the function carefully manages buffer boundaries to prevent overflow, uses thread-local error codes to signal failure conditions, and ensures the destination buffer is left in a safe state on error. It does not interact with external system resources such as files or registry keys, focusing solely on secure string concatenation in memory.",
      "Matched Sentence": "It does not interact with external system resources such as files or registry keys, focusing solely on secure string concatenation in memory.",
      "Similarity": 0.758458
    }
  ],
  "_invalid_parameter_1": [],
  "__acrt_call_reportfault_1": [],
  "__acrt_uninitialize_locks_1": [],
  "__acrt_initialize_locks_1": [],
  "_invoke_watson_1": [],
  "__acrt_unlock_1": [],
  "__acrt_lock_1": [],
  "_lock_locales_1": [],
  "FUN_14000ee64_1": [],
  "operator()<>_1": [],
  "__pctype_func_1": [],
  "setlocale_1": [],
  "_malloc_base_1": [],
  "FUN_14000f274_1": [
    {
      "ATT&CK ID": "T1090.001",
      "Indicator": "Modifies proxy settings: \"1bc5621a4818f2124ac085da21f607ca.exe\" (Access type: \"SETVAL\"; Path: \"HKCU\\SOFTWARE\\MICROSOFT\\WINDOWS\\CURRENTVERSION\\INTERNET SETTINGS\\ZONEMAP\"; Key: \"PROXYBYPASS\"; Value: \"01000000\")",
      "Comment": "The function checks a specific byte flag located at an offset within the structure pointed to by the input parameter. If this flag is nonzero, it clears the second least significant bit of a 4-byte field at a fixed offset (0x3a8) within the same structure. This operation effectively modifies a bitmask or status field inside the structure, likely to disable or reset a particular feature or state. The function performs this bitwise update conditionally and then returns immediately, without further side effects or system interactions.",
      "Matched Sentence": "This operation effectively modifies a bitmask or status field inside the structure, likely to disable or reset a particular feature or state.",
      "Similarity": 0.752653
    }
  ],
  "_LocaleUpdate::_LocaleUpdate_1": [],
  "islower_1": [],
  "FID_conflict:operator()_1": [],
  "_wcsdup_1": [],
  "isupper_1": [],
  "___lc_codepage_func_1": [],
  "_calloc_base_1": [],
  "___lc_locale_name_func_1": [],
  "__acrt_errno_map_os_error_1": [],
  "__doserrno_1": [
    {
      "ATT&CK ID": "T1106",
      "Indicator": "Contains ability to retrieve/modify process thread (API string): Found reference to API \"CreateThread\" (Indicator: \"CreateThread\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API \"CreateThreadpoolTimer\" (Indicator: \"CreateThread\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API \"CreateThreadpoolWait\" (Indicator: \"CreateThread\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API \"CreateThreadpoolWork\" (Indicator: \"CreateThread\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API \"CreateThreadpoolTimer\" (Indicator: \"CreateThread\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API \"CreateThreadpoolWait\" (Indicator: \"CreateThread\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API \"CreateThreadpoolWork\" (Indicator: \"CreateThread\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API \"CreateThread\" (Indicator: \"CreateThread\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")",
      "Comment": "The function retrieves a pointer to the thread-local storage location that holds the current thread's DOS error code. It first calls an internal function to obtain a per-thread data structure pointer. If this pointer is null, indicating that the thread-local data is unavailable, the function returns the address of a global static variable as a fallback. Otherwise, it returns the address of a specific field within the thread-local data structure that stores the DOS error code. This mechanism ensures that each thread can maintain and access its own error state independently, supporting thread-safe error handling in the runtime environment.",
      "Matched Sentence": "It first calls an internal function to obtain a per-thread data structure pointer.",
      "Similarity": 0.76809
    }
  ],
  "FUN_14000f4a0_1": [],
  "FUN_14000fbd0_1": [],
  "abort_1": [],
  "_query_new_handler_1": [
    {
      "ATT&CK ID": "T1497.003",
      "Indicator": "Contains ability to retrieve the time elapsed since the system was started (API string): Found reference to API \"GetTickCount64\" (Indicator: \"GetTickCount\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API \"GetTickCount64\" (Indicator: \"GetTickCount\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")",
      "Comment": "The function performs a thread-safe retrieval and transformation of a global 64-bit value. It begins by acquiring a lock through the `__acrt_lock(0)` call to ensure exclusive access to the shared data. It then reads a global 64-bit variable (`DAT_140038080`) and extracts the lower 6 bits of its least significant byte to determine a rotation count. Next, it computes an XOR between this global variable and another global 64-bit value (`_DAT_140039ff0`). The function then applies a bitwise rotation to the XOR result, rotating it right by the extracted count. Finally, it releases the lock with `__acrt_unlock(0)` and returns the rotated value. This behavior suggests the function is designed to safely produce a pseudo-random or obfuscated 64-bit value derived from global state, likely for use in scenarios requiring thread-safe randomization or unique value generation.",
      "Matched Sentence": "The function performs a thread-safe retrieval and transformation of a global 64-bit value.",
      "Similarity": 0.752199
    }
  ],
  "FUN_140011270_1": [],
  "FUN_140011270_2": [],
  "__crt_seh_guarded_call<void>::operator()<class_<lambda_d80eeec6fff315bfe5c115232f3240e3>,class_<lambda_6e4b09c48022b2350581041d5f6b0c4c>&___ptr64,class_<lambda_2358e3775559c9db80273638284d5e45>_>_1": [],
  "FUN_14001266c_1": [],
  "<lambda_6e4b09c48022b2350581041d5f6b0c4c>::operator()_1": [],
  "try_cor_exit_process_1": [
    {
      "ATT&CK ID": "T1082",
      "Indicator": "Contains ability to retrieve a module handle (API string): Found reference to API \"GetModuleHandleW\" (Indicator: \"GetModuleHandle\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API \"GetModuleHandleExW\" (Indicator: \"GetModuleHandle\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API \"GetModuleHandleW\" (Indicator: \"GetModuleHandle\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API \"GetModuleHandleExW\" (Indicator: \"GetModuleHandle\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")",
      "Comment": "The function attempts to obtain a handle to the `mscoree.dll` module by calling `GetModuleHandleExW` with the module name. If successful, it retrieves the address of the `CorExitProcess` function within that module using `GetProcAddress`. Upon successfully acquiring this function pointer, the function invokes `CorExitProcess`, passing along the input parameter, which likely triggers a managed (.NET) runtime process exit. After the call, the function ensures proper cleanup by releasing the module handle with `FreeLibrary` if it was loaded. Overall, this function serves as a controlled wrapper to invoke the .NET runtime’s process termination routine, ensuring safe module handling and cleanup.",
      "Matched Sentence": "The function attempts to obtain a handle to the `mscoree.dll` module by calling `GetModuleHandleExW` with the module name.",
      "Similarity": 0.866776
    }
  ],
  "common_exit_1": [],
  "exit_or_terminate_process_1": [],
  "_seh_filter_exe_1": [],
  "_cexit_1": [],
  "FUN_140012804_1": [],
  "_register_thread_local_exe_atexit_callback_1": [],
  "FUN_14001284c_1": [],
  "common_initialize_environment_nolock<wchar_t>_1": [],
  "free_environment<wchar_t>_1": [],
  "_configure_wide_argv_1": [
    {
      "ATT&CK ID": "T1106",
      "Indicator": "Contains ability to retrieve the fully qualified path of module (API string): Found reference to API \"GetModuleFileNameW\" (Indicator: \"GetModuleFileName\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API \"GetModuleFileNameW\" (Indicator: \"GetModuleFileName\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")",
      "Comment": "The function processes command-line arguments for a wide-character Windows application. It begins by retrieving the full path of the current executable using `GetModuleFileNameW` and stores this path in a global buffer. If no explicit command line is provided or it is empty, the function defaults to using the executable path as the command line input.\n\nNext, it parses the command line to determine the number of arguments and the total size needed to store them. Based on this, it allocates a buffer to hold the wide-character argument array. If allocation fails, it sets an error code and performs cleanup.\n\nUpon successful allocation, the function parses the command line again to populate the argument array. If the function is called with a parameter indicating a single argument scenario, it sets a global count of arguments accordingly and stores the argument array pointer globally.\n\nIf multiple arguments are expected, the function attempts to expand any wildcards present in the arguments (e.g., `*` or `?` patterns) by calling a wildcard expansion routine. If this expansion fails, it frees allocated resources and returns the error code. Otherwise, it counts the expanded arguments, updates the global argument count, and stores the expanded argument array pointer globally.\n\nThroughout, the function manages memory carefully, freeing temporary buffers and handling error conditions by setting appropriate error codes. The overall behavior centers on preparing a properly expanded and parsed wide-character argument vector for the application’s use, handling both default and user-supplied command lines, and supporting wildcard expansion in arguments.",
      "Matched Sentence": "It begins by retrieving the full path of the current executable using `GetModuleFileNameW` and stores this path in a global buffer.",
      "Similarity": 0.874592
    }
  ],
  "parse_command_line<wchar_t>_1": [],
  "create_environment<wchar_t>_1": [
    {
      "ATT&CK ID": "T1071.001",
      "Indicator": "Found string related to HTTP headers: Found string \"HTTP/1.0\" (Indicator: \"HTTP/1.0\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found string \"GET /registered?code=DQAAAAAAAAAOAAAAAAAAABMAAAAIAAAABAAAAAIAAAAIAAAAAAAAAA==&t=MTkyLjE2OC4wLjIgMAAtMFAtMFYtMJEtMHYtMPgNCjEyNy4wLjAuMSANCi== HTTP/1.1\" (Indicator: \"HTTP/1.1\"; Source: \"00000000-00003620.00000000.245741.128E0000.00000004.mdmp\")\n Found string \"HTTP/1.0\" (Indicator: \"HTTP/1.0\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")",
      "Comment": "The function processes a wide-character string input representing environment-like variable assignments and constructs a dynamically allocated array of wide-character strings. It first scans the input string to count the number of segments separated by the '=' character, which appear to represent key-value pairs or environment variable entries. Using this count, it allocates memory for an array of wide-character string pointers.\n\nThen, the function iterates through the input string again, segment by segment, and for each segment that does not start with an '=' character, it allocates memory for a copy of that substring and duplicates it into the newly allocated buffer. These duplicated strings are stored sequentially in the allocated array. If any memory allocation or string copy operation fails, the function frees all previously allocated memory to avoid leaks and aborts the operation.\n\nThe function returns a pointer to the array of wide-character strings, effectively creating a new environment-like structure from the input string. It relies on standard memory allocation and string manipulation routines, carefully handling memory to ensure stability. The function does not interact with external system resources such as files or registry keys; its behavior is focused on parsing and duplicating environment variable strings in memory.",
      "Matched Sentence": "It first scans the input string to count the number of segments separated by the '=' character, which appear to represent key-value pairs or environment variable entries.",
      "Similarity": 0.773383
    }
  ],
  "uninitialize_environment_internal<>_1": [],
  "__dcrt_uninitialize_environments_nolock_1": [],
  "__crt_seh_guarded_call<int>::operator()<class_<lambda_7777bce6b2f8c936911f934f8298dc43>,class_<lambda_f03950bc5685219e0bcd2087efbe011e>&___ptr64,class_<lambda_3883c3dff614d5e0c5f61bb1ac94921c>_>_1": [],
  "__crt_seh_guarded_call<int>::operator()<class_<lambda_638799b9deba96c50f710eeac98168cd>,class_<lambda_22ebabd17bc4fa466a2aca6d8deb888d>&___ptr64,class_<lambda_a6f7d7db0129f75315ebf26d50c089f1>_>_1": [],
  "FUN_140013158_1": [],
  "_execute_onexit_table_1": [],
  "FUN_140013228_1": [],
  "_register_onexit_function_1": [],
  "<lambda_22ebabd17bc4fa466a2aca6d8deb888d>::operator()_1": [],
  "<lambda_f03950bc5685219e0bcd2087efbe011e>::operator()_1": [],
  "FUN_14001324c_1": [],
  "FUN_140013340_1": [],
  "FUN_1400132e4_1": [],
  "FUN_1400132a4_1": [],
  "__acrt_uninitialize_1": [],
  "FUN_14001325c_1": [],
  "FUN_14001338c_1": [],
  "FUN_14001339c_1": [],
  "FUN_1400133f4_1": [
    {
      "ATT&CK ID": "T1027.005",
      "Indicator": "Contains XOR operation loops [Stream disassembly]: Assembly shows XOR instruction xor rax\n rsp in Stream UID: 40298-545-0000000140006A30\n Assembly shows XOR instruction xor eax\n esp in Stream UID: 40298-545-0000000140006A30\n Assembly shows XOR instruction xor rax\n rsp in Stream UID: 40298-552-0000000140005D80\n Assembly shows XOR instruction xor eax\n esp in Stream UID: 40298-552-0000000140005D80\n Assembly shows XOR instruction xor rcx\n rsp in Stream UID: 40298-552-0000000140005D80\n Assembly shows XOR instruction xor ecx\n esp in Stream UID: 40298-552-0000000140005D80\n Assembly shows XOR instruction xor rax\n rsp in Stream UID: 40298-556-0000000140005C80\n Assembly shows XOR instruction xor eax\n esp in Stream UID: 40298-556-0000000140005C80\n Assembly shows XOR instruction xor rcx\n rsp in Stream UID: 40298-556-0000000140005C80\n Assembly shows XOR instruction xor ecx\n esp in Stream UID: 40298-556-0000000140005C80\n Assembly shows XOR instruction xor rax\n rsp in Stream UID: 40298-558-0000000140004720\n Assembly shows XOR instruction xor eax\n esp in Stream UID: 40298-558-0000000140004720\n Assembly shows XOR instruction xor rcx\n rsp in Stream UID: 40298-558-0000000140004720\n Assembly shows XOR instruction xor ecx\n esp in Stream UID: 40298-558-0000000140004720\n Assembly shows XOR instruction xor rax\n rsp in Stream UID: 40298-561-0000000140003B50\n Assembly shows XOR instruction xor eax\n esp in Stream UID: 40298-561-0000000140003B50\n Assembly shows XOR instruction xor rcx\n rsp in Stream UID: 40298-561-0000000140003B50\n Assembly shows XOR instruction xor ecx\n esp in Stream UID: 40298-561-0000000140003B50\n Assembly shows XOR instruction xor rax\n rsp in Stream UID: 40298-564-0000000140002D00\n Assembly shows XOR instruction xor eax\n esp in Stream UID: 40298-564-0000000140002D00\n Assembly shows XOR instruction xor rcx\n rsp in Stream UID: 40298-564-0000000140002D00\n Assembly shows XOR instruction xor ecx\n esp in Stream UID: 40298-564-0000000140002D00\n Assembly shows XOR instruction xor rax\n rsp in Stream UID: 40298-612-0000000140002D20\n Assembly shows XOR instruction xor eax\n esp in Stream UID: 40298-612-0000000140002D20\n Assembly shows XOR instruction xor rcx\n rsp in Stream UID: 40298-612-0000000140002D20\n Assembly shows XOR instruction xor ecx\n esp in Stream UID: 40298-612-0000000140002D20\n Assembly shows XOR instruction xor qword ptr [000000014003AB80h]\n rdi in Stream UID: 40298-619-0000000140003495\n Assembly shows XOR instruction xor dword ptr [000000014003AB80h]\n edi in Stream UID: 40298-619-0000000140003495\n Assembly shows XOR instruction xor qword ptr [000000014003AB88h]\n rdx in Stream UID: 40298-619-0000000140003495\n Assembly shows XOR instruction xor dword ptr [000000014003AB88h]\n edx in Stream UID: 40298-619-0000000140003495\n Assembly shows XOR instruction xor qword ptr [000000014003AB90h]\n rcx in Stream UID: 40298-619-0000000140003495\n Assembly shows XOR instruction xor dword ptr [000000014003AB90h]\n ecx in Stream UID: 40298-619-0000000140003495\n Assembly shows XOR instruction xor qword ptr [000000014003AB98h]\n rax in Stream UID: 40298-619-0000000140003495\n Assembly shows XOR instruction xor dword ptr [000000014003AB98h]\n eax in Stream UID: 40298-619-0000000140003495\n Assembly shows XOR instruction xor rcx\n rsp in Stream UID: 40298-619-0000000140003495\n Assembly shows XOR instruction xor ecx\n esp in Stream UID: 40298-619-0000000140003495\n Assembly shows XOR instruction xor qword ptr [000000014003AC30h]\n r9 in Stream UID: 40298-621-000000014000399E\n Assembly shows XOR instruction xor dword ptr [000000014003AC30h]\n ecx in Stream UID: 40298-621-000000014000399E\n Assembly shows XOR instruction xor qword ptr [000000014003AC38h]\n r8 in Stream UID: 40298-621-000000014000399E\n Assembly shows XOR instruction xor dword ptr [000000014003AC38h]\n eax in Stream UID: 40298-621-000000014000399E\n Assembly shows XOR instruction xor qword ptr [000000014003AC40h]\n rcx in Stream UID: 40298-621-000000014000399E\n Assembly shows XOR instruction xor dword ptr [000000014003AC40h]\n ecx in Stream UID: 40298-621-000000014000399E\n Assembly shows XOR instruction xor qword ptr [000000014003AC48h]\n rax in Stream UID: 40298-621-000000014000399E\n Assembly shows XOR instruction xor dword ptr [000000014003AC48h]\n eax in Stream UID: 40298-621-000000014000399E\n Assembly shows XOR instruction xor qword ptr [000000014003AC30h]\n r8 in Stream UID: 40298-621-000000014000399E\n Assembly shows XOR instruction xor dword ptr [000000014003AC30h]\n eax in Stream UID: 40298-621-000000014000399E\n Assembly shows XOR instruction xor qword ptr [000000014003AC38h]\n rdx in Stream UID: 40298-621-000000014000399E\n Assembly shows XOR instruction xor dword ptr [000000014003AC38h]\n edx in Stream UID: 40298-621-000000014000399E\n Assembly shows XOR instruction xor qword ptr [000000014003AAD0h]\n rax in Stream UID: 40298-627-0000000140003EAF\n Assembly shows XOR instruction xor dword ptr [000000014003AAD0h]\n eax in Stream UID: 40298-627-0000000140003EAF\n Assembly shows XOR instruction xor qword ptr [000000014003AAD8h]\n rax in Stream UID: 40298-627-0000000140003EAF\n Assembly shows XOR instruction xor dword ptr [000000014003AAD8h]\n eax in Stream UID: 40298-627-0000000140003EAF\n Assembly shows XOR instruction xor qword ptr [000000014003AAE0h]\n rax in Stream UID: 40298-627-0000000140003EAF\n Assembly shows XOR instruction xor dword ptr [000000014003AAE0h]\n eax in Stream UID: 40298-627-0000000140003EAF\n Assembly shows XOR instruction xor qword ptr [000000014003AAE8h]\n rax in Stream UID: 40298-627-0000000140003EAF\n Assembly shows XOR instruction xor dword ptr [000000014003AAE8h]\n eax in Stream UID: 40298-627-0000000140003EAF\n Assembly shows XOR instruction xor qword ptr [000000014003AAF0h]\n rax in Stream UID: 40298-627-0000000140003EAF\n Assembly shows XOR instruction xor dword ptr [000000014003AAF0h]\n eax in Stream UID: 40298-627-0000000140003EAF\n Assembly shows XOR instruction xor qword ptr [000000014003AAF8h]\n rax in Stream UID: 40298-627-0000000140003EAF\n Assembly shows XOR instruction xor dword ptr [000000014003AAF8h]\n eax in Stream UID: 40298-627-0000000140003EAF\n Assembly shows XOR instruction xor qword ptr [000000014003AB00h]\n rax in Stream UID: 40298-627-0000000140003EAF\n Assembly shows XOR instruction xor dword ptr [000000014003AB00h]\n eax in Stream UID: 40298-627-0000000140003EAF\n Assembly shows XOR instruction xor qword ptr [000000014003AB08h]\n rax in Stream UID: 40298-627-0000000140003EAF\n Assembly shows XOR instruction xor dword ptr [000000014003AB08h]\n eax in Stream UID: 40298-627-0000000140003EAF\n Assembly shows XOR instruction xor rcx\n rsp in Stream UID: 40298-627-0000000140003EAF\n Assembly shows XOR instruction xor ecx\n esp in Stream UID: 40298-627-0000000140003EAF\n Assembly shows XOR instruction xor rcx\n rsp in Stream UID: 40298-634-00000001400046E3\n Assembly shows XOR instruction xor ecx\n esp in Stream UID: 40298-634-00000001400046E3\n Assembly shows XOR instruction xor rax\n qword ptr [0000000140038080h] in Stream UID: 40298-696-000000014000A284\n Assembly shows XOR instruction xor eax\n dword ptr [0000000140038080h] in Stream UID: 40298-696-000000014000A284\n Assembly shows XOR instruction xor rcx\n rbp in Stream UID: 40298-700-000000014000A692\n Assembly shows XOR instruction xor ecx\n ebp in Stream UID: 40298-700-000000014000A692\n Assembly shows XOR instruction xor rax\n qword ptr [0000000140038080h] in Stream UID: 40298-702-000000014000A9B0\n Assembly shows XOR instruction xor eax\n dword ptr [0000000140038080h] in Stream UID: 40298-702-000000014000A9B0\n Assembly shows XOR instruction xor rcx\n rsp in Stream UID: 40298-733-000000014000BDF9\n Assembly shows XOR instruction xor ecx\n esp in Stream UID: 40298-733-000000014000BDF9\n Assembly shows XOR instruction xor rcx\n rsp in Stream UID: 40298-791-000000014000F512\n Assembly shows XOR instruction xor ecx\n esp in Stream UID: 40298-791-000000014000F512\n Assembly shows XOR instruction xor rax\n rsp in Stream UID: 40298-792-0000000140016C7C\n Assembly shows XOR instruction xor eax\n esp in Stream UID: 40298-792-0000000140016C7C\n Assembly shows XOR instruction xor rcx\n rsp in Stream UID: 40298-792-0000000140016C7C\n Assembly shows XOR instruction xor ecx\n esp in Stream UID: 40298-792-0000000140016C7C\n Assembly shows XOR instruction xor r8\n rdx in Stream UID: 40298-879-0000000140015787\n Assembly shows XOR instruction xor eax\n edx in Stream UID: 40298-879-0000000140015787\n Assembly shows XOR instruction xor rcx\n rsp in Stream UID: 40298-939-000000014001896E\n Assembly shows XOR instruction xor ecx\n esp in Stream UID: 40298-939-000000014001896E\n Assembly shows XOR instruction xor rcx\n rsp in Stream UID: 40298-991-000000014001BE9A\n Assembly shows XOR instruction xor ecx\n esp in Stream UID: 40298-991-000000014001BE9A\n Assembly shows XOR instruction xor rcx\n rsp in Stream UID: 40298-994-000000014001C0E9\n Assembly shows XOR instruction xor ecx\n esp in Stream UID: 40298-994-000000014001C0E9\n Assembly shows XOR instruction xor rcx\n rsp in Stream UID: 40298-997-000000014001C331\n Assembly shows XOR instruction xor ecx\n esp in Stream UID: 40298-997-000000014001C331\n Assembly shows XOR instruction xor rax\n rsp in Stream UID: 40298-999-000000014001C616\n Assembly shows XOR instruction xor eax\n esp in Stream UID: 40298-999-000000014001C616\n Assembly shows XOR instruction xor rcx\n rsp in Stream UID: 40298-999-000000014001C616\n Assembly shows XOR instruction xor ecx\n esp in Stream UID: 40298-999-000000014001C616\n Assembly shows XOR instruction xor qword ptr [rbp+10h]\n rax in Stream UID: 40298-1347-000000014000B8E9\n Assembly shows XOR instruction xor dword ptr [rbp+10h]\n eax in Stream UID: 40298-1347-000000014000B8E9\n Assembly shows XOR instruction xor rax\n qword ptr [rbp+20h] in Stream UID: 40298-1347-000000014000B8E9\n Assembly shows XOR instruction xor eax\n dword ptr [rbp+20h] in Stream UID: 40298-1347-000000014000B8E9\n Assembly shows XOR instruction xor rax\n qword ptr [rbp+10h] in Stream UID: 40298-1347-000000014000B8E9\n Assembly shows XOR instruction xor eax\n dword ptr [rbp+10h] in Stream UID: 40298-1347-000000014000B8E9\n Assembly shows XOR instruction xor rax\n rcx in Stream UID: 40298-1347-000000014000B8E9\n Assembly shows XOR instruction xor eax\n ecx in Stream UID: 40298-1347-000000014000B8E9",
      "Comment": "The function performs a bitwise rotation and XOR operation on a 64-bit input value. Specifically, it calculates a rotation amount based on a global byte value masked to 6 bits, then rotates the input parameter by this computed number of bits. After the rotation, it XORs the result with a global 64-bit value and stores the final result in a global variable. This operation suggests the function is implementing a form of data obfuscation or cryptographic transformation, likely used for encoding or decoding data in memory. The function does not interact with external system resources such as files or registry keys, focusing solely on in-memory bitwise manipulation.",
      "Matched Sentence": "The function performs a bitwise rotation and XOR operation on a 64-bit input value.",
      "Similarity": 0.799026
    },
    {
      "ATT&CK ID": "T1027",
      "Indicator": "Shows ability to obfuscate file or information: The analysis contains indicators for cyrpto or data obfuscation(base64/decrypt) which can hide information. Matched sigs: Contains ability to use Cryptographic classes\n Matched sigs: PCAP contains base64 strings\n Matched sigs: Able to use PEM certificate for encryption and decryption\n Matched sigs: HTTP requests contain Base64 strings\n Matched sigs: HTTP request contains Base64 encoded artifacts\n Matched sigs: Contains XOR operation loops [Stream disassembly]\n Matched sigs: YARA signature match - RC4 Encryption",
      "Comment": "The function performs a bitwise rotation and XOR operation on a 64-bit input value. Specifically, it calculates a rotation amount based on a global byte value masked to 6 bits, then rotates the input parameter by this computed number of bits. After the rotation, it XORs the result with a global 64-bit value and stores the final result in a global variable. This operation suggests the function is implementing a form of data obfuscation or cryptographic transformation, likely used for encoding or decoding data in memory. The function does not interact with external system resources such as files or registry keys, focusing solely on in-memory bitwise manipulation.",
      "Matched Sentence": "This operation suggests the function is implementing a form of data obfuscation or cryptographic transformation, likely used for encoding or decoding data in memory.",
      "Similarity": 0.800902
    }
  ],
  "FUN_1400133c4_1": [],
  "_initterm_1": [],
  "_initterm_e_1": [],
  "_set_fmode_1": [],
  "_get_wide_winmain_command_line_1": [],
  "__crt_seh_guarded_call<void>::operator()<class_<lambda_410d79af7f07d98d83a3f525b3859a53>,class_<lambda_3e16ef9562a7dcce91392c22ab16ea36>&___ptr64,class_<lambda_38119f0e861e05405d8a144b9b982f0a>_>_1": [],
  "FUN_140013840_1": [],
  "__crt_seh_guarded_call<void>::operator()<class_<lambda_7f2adfce497ff2baa965cd4f576ecfd1>,class_<lambda_2a444430fde8c29194d880d93eed5e8f>&___ptr64,class_<lambda_8dff2cf36a5417162780cd64fa2883ef>&___ptr64>_1": [],
  "__acrt_copy_locale_name_1": [],
  "__crt_seh_guarded_call<void>::operator()<class_<lambda_1d892b297fdedeee07ed8124eeb2f2fa>,class_<lambda_ffc046909424fd52df0ac47e64813305>&___ptr64,class_<lambda_01a7098693036236037e7cdb9bca3d73>_>_1": [],
  "__acrt_uninitialize_locale_1": [],
  "<lambda_2a444430fde8c29194d880d93eed5e8f>::operator()_1": [
    {
      "ATT&CK ID": "T1106",
      "Indicator": "Imports suspicious APIs: RegCreateKeyExW\n RegCloseKey\n RegOpenKeyW\n RegOpenKeyExW\n GetStartupInfoW\n DeleteFileW\n GetFileAttributesW\n CreateFileW\n GetCommandLineW\n GetCommandLineA\n TerminateProcess\n LoadLibraryExW\n GetProcAddress\n Sleep\n GetModuleHandleW\n IsDebuggerPresent\n CreateDirectoryW\n GetModuleFileNameW\n FindNextFileW\n WriteFile\n CreateThread\n CreateProcessW\n GetModuleHandleExW\n GetTempPathW\n FindFirstFileExW\n UnhandledExceptionFilter\n GetTempFileNameW\n InternetCloseHandle\n InternetConnectW\n InternetOpenW\n HttpSendRequestW",
      "Comment": "The function begins by allocating a fixed-size memory block of 344 bytes using a low-level heap allocation routine (`_calloc_base`). It stores the pointer to this allocated memory within a member variable of the object instance (`this`). Immediately after, it calls a deallocation function (`_free_base`) with a null pointer argument, which effectively performs no operation but may serve as a placeholder or a side-effect trigger.\n\nIf the memory allocation succeeds, the function proceeds to copy several 64-bit values from consecutive offsets within the object instance into local variables. These values likely represent internal state or context data required for subsequent operations.\n\nFollowing this setup, the function invokes a templated, structured exception handling (SEH) guarded call to another function or callable object. This call passes three distinct lambda objects or functors, constructed from the previously copied local variables and fixed constants. The guarded call likely encapsulates a critical operation that requires exception safety, such as complex processing or interaction with external resources.\n\nOverall, the function’s behavior centers on preparing a controlled execution environment by allocating memory, capturing internal state, and invoking a protected callback mechanism. It does not directly interact with system resources like files, registry keys, or network components within the shown code, but it sets up and delegates to other components that may perform such actions. The use of SEH guarding indicates a focus on robustness against runtime exceptions during the delegated operation.",
      "Matched Sentence": "It does not directly interact with system resources like files, registry keys, or network components within the shown code, but it sets up and delegates to other components that may perform such actions.",
      "Similarity": 0.779101
    }
  ],
  "_configthreadlocale_1": [],
  "__lc_lctowcs_1": [],
  "FUN_140013b08_1": [],
  "__lc_wcstolc_1": [],
  "FUN_14001488c_1": [],
  "_wsetlocale_1": [],
  "_wsetlocale_get_all_1": [],
  "FUN_140014894_1": [],
  "_wsetlocale_nolock_1": [],
  "FUN_1400148c0_1": [
    {
      "ATT&CK ID": "T1027",
      "Indicator": "Contains ability to use Cryptographic classes: file/memory contains long string with (Indicator: \"Oid\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n file/memory contains long string with (Indicator: \"Oid\"; File: \"crt87D3.tmp\")\n Found reference to \"VYzw2WOidff2oiTLFQIDAQABo2MwYTAOBgNVHQ8BAf8EBAMCAYYwDwYDVR0TAQH/\" (Indicator: \"Oid\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")",
      "Comment": "The function `FUN_1400148c0` simply returns the address of a global or static data object located at `DAT_14003a28c`. It does not perform any additional computation, system calls, or interactions with external resources. There are no control flow constructs such as loops or conditionals within this function; it acts as a straightforward accessor, providing a pointer to a predefined memory location. This suggests its role is to supply a reference to a specific data structure or constant stored in the program’s data segment, likely for use by other parts of the application.",
      "Matched Sentence": "This suggests its role is to supply a reference to a specific data structure or constant stored in the program’s data segment, likely for use by other parts of the application.",
      "Similarity": 0.785451
    }
  ],
  "_wsetlocale_set_cat_1": [],
  "strcpy_s_1": [],
  "strncmp_1": [],
  "__crt_strtox::parse_integer<unsigned_long,class___crt_strtox::c_string_character_source<wchar_t>_>_1": [],
  "FUN_1400152c8_1": [],
  "construct_ptd_array_1": [],
  "replace_current_thread_locale_nolock_1": [],
  "__acrt_getptd_1": [
    {
      "ATT&CK ID": "T1106",
      "Indicator": "Input file contains API references not part of its Import Address Table (IAT): Found string \"FlsAlloc\" (Source: 1bc5621a4818f2124ac085da21f607ca, API is part of module: KERNELBASE.DLL)\n Found string \"FlsFree\" (Source: 1bc5621a4818f2124ac085da21f607ca, API is part of module: KERNELBASE.DLL)\n Found string \"FlsGetValue\" (Source: 1bc5621a4818f2124ac085da21f607ca, API is part of module: KERNELBASE.DLL)\n Found string \"FlsSetValue\" (Source: 1bc5621a4818f2124ac085da21f607ca, API is part of module: KERNELBASE.DLL)\n Found string \"InitializeCriticalSectionEx\" (Source: 1bc5621a4818f2124ac085da21f607ca, API is part of module: KERNELBASE.DLL)\n Found string \"InitOnceExecuteOnce\" (Source: 1bc5621a4818f2124ac085da21f607ca, API is part of module: KERNELBASE.DLL)\n Found string \"CreateEventExW\" (Source: 1bc5621a4818f2124ac085da21f607ca, API is part of module: KERNELBASE.DLL)\n Found string \"CreateSemaphoreW\" (Source: 1bc5621a4818f2124ac085da21f607ca, API is part of module: KERNELBASE.DLL)\n Found string \"CreateSemaphoreExW\" (Source: 1bc5621a4818f2124ac085da21f607ca, API is part of module: KERNELBASE.DLL)\n Found string \"CreateThreadpoolTimer\" (Source: 1bc5621a4818f2124ac085da21f607ca, API is part of module: KERNELBASE.DLL)\n Found string \"CreateThreadpoolWait\" (Source: 1bc5621a4818f2124ac085da21f607ca, API is part of module: KERNELBASE.DLL)\n Found string \"CreateSymbolicLinkW\" (Source: 1bc5621a4818f2124ac085da21f607ca, API is part of module: KERNELBASE.DLL)\n Found string \"GetCurrentPackageId\" (Source: 1bc5621a4818f2124ac085da21f607ca, API is part of module: KERNEL.APPCORE.DLL)\n Found string \"GetTickCount64\" (Source: 1bc5621a4818f2124ac085da21f607ca, API is part of module: KERNELBASE.DLL)\n Found string \"GetFileInformationByHandleEx\" (Source: 1bc5621a4818f2124ac085da21f607ca, API is part of module: KERNELBASE.DLL)\n Found string \"SetFileInformationByHandle\" (Source: 1bc5621a4818f2124ac085da21f607ca, API is part of module: KERNELBASE.DLL)\n Found string \"GetSystemTimePreciseAsFileTime\" (Source: 1bc5621a4818f2124ac085da21f607ca, API is part of module: KERNELBASE.DLL)\n Found string \"SleepConditionVariableCS\" (Source: 1bc5621a4818f2124ac085da21f607ca, API is part of module: KERNELBASE.DLL)\n Found string \"SleepConditionVariableSRW\" (Source: 1bc5621a4818f2124ac085da21f607ca, API is part of module: KERNELBASE.DLL)\n Found string \"CreateThreadpoolWork\" (Source: 1bc5621a4818f2124ac085da21f607ca, API is part of module: KERNELBASE.DLL)\n Found string \"CompareStringEx\" (Source: 1bc5621a4818f2124ac085da21f607ca, API is part of module: KERNELBASE.DLL)\n Found string \"GetLocaleInfoEx\" (Source: 1bc5621a4818f2124ac085da21f607ca, API is part of module: KERNELBASE.DLL)\n Found string \"LCMapStringEx\" (Source: 1bc5621a4818f2124ac085da21f607ca, API is part of module: KERNELBASE.DLL)\n Found string \"AreFileApisANSI\" (Source: 1bc5621a4818f2124ac085da21f607ca, API is part of module: KERNELBASE.DLL)\n Found string \"EnumSystemLocalesEx\" (Source: 1bc5621a4818f2124ac085da21f607ca, API is part of module: KERNELBASE.DLL)",
      "Comment": "The function manages thread-local storage (TLS) data by interacting with the Windows Fiber Local Storage (FLS) APIs. It first retrieves the last error code to preserve it throughout its execution. The function checks a global index variable to determine if the TLS slot has been initialized. If uninitialized or if the current TLS value is null, it attempts to set a placeholder value in the TLS slot. Upon success, it allocates memory for a thread-specific data structure using a custom allocator. If allocation succeeds, it stores the pointer to this structure in the TLS slot and initializes the structure by calling a constructor-like function. If any step fails, it cleans up by resetting the TLS slot and freeing allocated memory. After completing these operations, it restores the original error code. Finally, the function verifies that the TLS data pointer is valid; if not, it triggers an abnormal termination by calling `abort()`. This behavior ensures that each thread has properly initialized thread-specific data, relying on FLS APIs (`__acrt_FlsGetValue`, `__acrt_FlsSetValue`), memory allocation (`_calloc_base`), and cleanup routines to maintain consistent thread-local state.",
      "Matched Sentence": "This behavior ensures that each thread has properly initialized thread-specific data, relying on FLS APIs (`__acrt_FlsGetValue`, `__acrt_FlsSetValue`), memory allocation (`_calloc_base`), and cleanup routines to maintain consistent thread-local state.",
      "Similarity": 0.774303
    }
  ],
  "__acrt_getptd_head_1": [],
  "_free_base_1": [],
  "__acrt_initialize_ptd_1": [],
  "destroy_ptd_array_1": [],
  "__acrt_getptd_noexit_1": [],
  "__acrt_AppPolicyGetProcessTerminationMethodInternal_1": [
    {
      "ATT&CK ID": "T1489",
      "Indicator": "Contains ability to terminate a process (API string): Found reference to API \"TerminateProcess\" (Indicator: \"TerminateProcess\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API \"ExitProcess\" (Indicator: \"ExitProcess\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API \"CorExitProcess\" (Indicator: \"ExitProcess\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API \"CorExitProcess\" (Indicator: \"ExitProcess\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API \"TerminateProcess\" (Indicator: \"TerminateProcess\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API \"ExitProcess\" (Indicator: \"ExitProcess\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")",
      "Comment": "The function attempts to dynamically resolve and invoke the `AppPolicyGetProcessTerminationMethod` API at runtime by using a helper function (`try_get_function`) to locate the function pointer within a specified module. If the function pointer cannot be retrieved (i.e., the API is unavailable), it returns the error code `0xc0000225`, indicating a failure to find the requested procedure. Otherwise, it calls the resolved `AppPolicyGetProcessTerminationMethod` function with a fixed first argument (`-6` or `0xfffffffffffffffa` in 64-bit two’s complement) and the provided second parameter, then returns the result. This behavior suggests the function acts as a safe wrapper or compatibility shim that conditionally invokes the system API if present, enabling controlled access to process termination policy information without causing a crash if the API is missing.",
      "Matched Sentence": "This behavior suggests the function acts as a safe wrapper or compatibility shim that conditionally invokes the system API if present, enabling controlled access to process termination policy information without causing a crash if the API is missing.",
      "Similarity": 0.816132
    }
  ],
  "__acrt_EnumSystemLocalesEx_1": [],
  "__acrt_FlsFree_1": [],
  "__acrt_FlsAlloc_1": [],
  "__acrt_FlsGetValue_1": [],
  "__acrt_GetLocaleInfoEx_1": [],
  "__acrt_FlsSetValue_1": [],
  "__acrt_GetUserDefaultLocaleName_1": [],
  "__acrt_InitializeCriticalSectionEx_1": [
    {
      "ATT&CK ID": "T1106",
      "Indicator": "Calls an API typically used to retrieve function addresses: \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"GetProcAddress\" with a parameter InitializeCriticalSectionEx (UID: 00000000-00003620)\n \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"GetProcAddress\" with a parameter FlsAlloc (UID: 00000000-00003620)\n \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"GetProcAddress\" with a parameter FlsSetValue (UID: 00000000-00003620)\n \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"GetProcAddress\" with a parameter FlsGetValue (UID: 00000000-00003620)\n \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"GetProcAddress\" with a parameter LCMapStringEx (UID: 00000000-00003620)\n \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"GetProcAddress\" with a parameter FlsFree (UID: 00000000-00003620)\n \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"GetProcAddress\" with a parameter InitOnceExecuteOnce (UID: 00000000-00003620)\n \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"GetProcAddress\" with a parameter CreateEventExW (UID: 00000000-00003620)\n \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"GetProcAddress\" with a parameter CreateSemaphoreW (UID: 00000000-00003620)\n \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"GetProcAddress\" with a parameter CreateSemaphoreExW (UID: 00000000-00003620)\n \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"GetProcAddress\" with a parameter CreateThreadpoolTimer (UID: 00000000-00003620)\n \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"GetProcAddress\" with a parameter SetThreadpoolTimer (UID: 00000000-00003620)\n \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"GetProcAddress\" with a parameter WaitForThreadpoolTimerCallbacks (UID: 00000000-00003620)\n \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"GetProcAddress\" with a parameter CloseThreadpoolTimer (UID: 00000000-00003620)\n \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"GetProcAddress\" with a parameter CreateThreadpoolWait (UID: 00000000-00003620)\n \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"GetProcAddress\" with a parameter SetThreadpoolWait (UID: 00000000-00003620)\n \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"GetProcAddress\" with a parameter CloseThreadpoolWait (UID: 00000000-00003620)\n \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"GetProcAddress\" with a parameter FlushProcessWriteBuffers (UID: 00000000-00003620)\n \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"GetProcAddress\" with a parameter FreeLibraryWhenCallbackReturns (UID: 00000000-00003620)\n \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"GetProcAddress\" with a parameter GetCurrentProcessorNumber (UID: 00000000-00003620)\n \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"GetProcAddress\" with a parameter CreateSymbolicLinkW (UID: 00000000-00003620)\n \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"GetProcAddress\" with a parameter GetCurrentPackageId (UID: 00000000-00003620)\n \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"GetProcAddress\" with a parameter GetTickCount64 (UID: 00000000-00003620)\n \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"GetProcAddress\" with a parameter GetFileInformationByHandleEx (UID: 00000000-00003620)\n \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"GetProcAddress\" with a parameter SetFileInformationByHandle (UID: 00000000-00003620)\n \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"GetProcAddress\" with a parameter GetSystemTimePreciseAsFileTime (UID: 00000000-00003620)\n \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"GetProcAddress\" with a parameter InitializeConditionVariable (UID: 00000000-00003620)\n \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"GetProcAddress\" with a parameter WakeConditionVariable (UID: 00000000-00003620)\n \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"GetProcAddress\" with a parameter WakeAllConditionVariable (UID: 00000000-00003620)\n \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"GetProcAddress\" with a parameter SleepConditionVariableCS (UID: 00000000-00003620)\n \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"GetProcAddress\" with a parameter InitializeSRWLock (UID: 00000000-00003620)\n \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"GetProcAddress\" with a parameter AcquireSRWLockExclusive (UID: 00000000-00003620)\n \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"GetProcAddress\" with a parameter TryAcquireSRWLockExclusive (UID: 00000000-00003620)\n \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"GetProcAddress\" with a parameter ReleaseSRWLockExclusive (UID: 00000000-00003620)\n \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"GetProcAddress\" with a parameter SleepConditionVariableSRW (UID: 00000000-00003620)\n \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"GetProcAddress\" with a parameter CreateThreadpoolWork (UID: 00000000-00003620)\n \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"GetProcAddress\" with a parameter SubmitThreadpoolWork (UID: 00000000-00003620)\n \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"GetProcAddress\" with a parameter CloseThreadpoolWork (UID: 00000000-00003620)\n \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"GetProcAddress\" with a parameter CompareStringEx (UID: 00000000-00003620)\n \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"GetProcAddress\" with a parameter GetLocaleInfoEx (UID: 00000000-00003620)\n \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"GetProcAddress\" with a parameter AreFileApisANSI (UID: 00000000-00003620)\n \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"GetProcAddress\" with a parameter RtlGetVersion (UID: 00000000-00003620)\n \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"GetProcAddress\" with a parameter CoCreateInstance (UID: 00000000-00003620)\n \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"GetProcAddress\" with a parameter CoCreateInstanceEx (UID: 00000000-00003620)\n \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"GetProcAddress\" with a parameter CoGetClassObject (UID: 00000000-00003620)\n \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"GetProcAddress\" with a parameter CoGetInstanceFromFile (UID: 00000000-00003620)\n \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"GetProcAddress\" with a parameter CoGetInstanceFromIStorage (UID: 00000000-00003620)\n \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"GetProcAddress\" with a parameter EnumSystemLocalesEx (UID: 00000000-00003620)\n \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"GetProcAddress\" with a parameter GetDateFormatEx (UID: 00000000-00003620)\n \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"GetProcAddress\" with a parameter GetTimeFormatEx (UID: 00000000-00003620)\n \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"GetProcAddress\" with a parameter GetUserDefaultLocaleName (UID: 00000000-00003620)\n \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"GetProcAddress\" with a parameter IsValidLocaleName (UID: 00000000-00003620)\n \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"GetProcAddress\" with a parameter LCIDToLocaleName (UID: 00000000-00003620)\n \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"GetProcAddress\" with a parameter LocaleNameToLCID (UID: 00000000-00003620)\n \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"GetProcAddress\" with a parameter AppPolicyGetProcessTerminationMethod (UID: 00000000-00003620)",
      "Comment": "The function attempts to dynamically resolve the `InitializeCriticalSectionEx` API by calling a helper function designed to retrieve function pointers at runtime. If this resolution fails (i.e., the function pointer is `NULL`), it falls back to calling the older `InitializeCriticalSectionAndSpinCount` API to initialize a critical section with a specified spin count. If the dynamic resolution succeeds, it invokes the resolved `InitializeCriticalSectionEx` function indirectly, passing the critical section pointer, spin count, and an additional flags parameter. This approach ensures compatibility across different Windows versions by using the newer API when available, while maintaining functionality through the legacy API otherwise. The function does not interact with files, registry keys, or other system resources beyond critical section initialization and employs straightforward conditional branching to select the appropriate initialization method.",
      "Matched Sentence": "The function attempts to dynamically resolve the `InitializeCriticalSectionEx` API by calling a helper function designed to retrieve function pointers at runtime.",
      "Similarity": 0.858985
    }
  ],
  "__acrt_LCIDToLocaleName_1": [],
  "__acrt_IsValidLocaleName_1": [],
  "__acrt_can_use_vista_locale_apis_1": [],
  "__acrt_LCMapStringEx_1": [],
  "__acrt_LocaleNameToLCID_1": [],
  "__acrt_initialize_winapi_thunks_1": [],
  "__acrt_uninitialize_winapi_thunks_1": [],
  "__acrt_eagerly_load_locale_apis_1": [
    {
      "ATT&CK ID": "T1614",
      "Indicator": "Able to query system locale information (API string): Found reference to API \"GetUserDefaultLCID\" (Indicator: \"GetUserDefaultLCID\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API \"GetLocaleInfoW\" (Indicator: \"GetLocaleInfo\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API \"EnumSystemLocalesW\" (Indicator: \"EnumSystemLocales\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API \"GetLocaleInfoEx\" (Indicator: \"GetLocaleInfo\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API \"EnumSystemLocalesEx\" (Indicator: \"EnumSystemLocales\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API \"GetUserDefaultLocaleName\" (Indicator: \"GetUserDefaultLocaleName\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API \"GetLocaleInfoEx\" (Indicator: \"GetLocaleInfo\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API \"EnumSystemLocalesEx\" (Indicator: \"EnumSystemLocales\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API \"GetUserDefaultLocaleName\" (Indicator: \"GetUserDefaultLocaleName\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API \"GetLocaleInfoW\" (Indicator: \"GetLocaleInfo\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API \"GetUserDefaultLCID\" (Indicator: \"GetUserDefaultLCID\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API \"EnumSystemLocalesW\" (Indicator: \"EnumSystemLocales\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")",
      "Comment": "The function attempts to dynamically resolve and cache pointers to several Windows locale-related API functions by repeatedly calling a helper routine (`try_get_function`). It targets APIs such as `AreFileApisANSI`, `CompareStringEx`, `EnumSystemLocalesEx`, `GetDateFormatEx`, `GetLocaleInfoEx`, `GetTimeFormatEx`, `GetUserDefaultLocaleName`, `IsValidLocaleName`, `LCMapStringEx`, `LCIDToLocaleName`, and `LocaleNameToLCID`. These functions are essential for locale and internationalization support, handling tasks like string comparison, date/time formatting, locale enumeration, and locale name validation.\n\nBy loading these function pointers at runtime, the function prepares the environment for subsequent locale-aware operations without directly linking to these APIs at compile time. This dynamic resolution approach enhances flexibility and potentially supports compatibility across different Windows versions or configurations where some locale APIs might be unavailable.\n\nThe function’s control flow is straightforward and sequential, iterating through a predefined list of locale API names and invoking `try_get_function` to obtain their addresses. It stores the resolved pointers in global or static variables for later use. No loops or complex branching are present beyond this linear sequence.\n\nOverall, the function’s behavior centers on initializing locale API access dynamically, enabling the program to perform locale-sensitive operations such as string comparison, formatting, and locale information retrieval in a flexible and version-resilient manner. It does not interact with files, registry keys, or network resources, focusing solely on preparing locale-related system API calls.",
      "Matched Sentence": "It targets APIs such as `AreFileApisANSI`, `CompareStringEx`, `EnumSystemLocalesEx`, `GetDateFormatEx`, `GetLocaleInfoEx`, `GetTimeFormatEx`, `GetUserDefaultLocaleName`, `IsValidLocaleName`, `LCMapStringEx`, `LCIDToLocaleName`, and `LocaleNameToLCID`.",
      "Similarity": 0.883201
    }
  ],
  "mbstowcs_s_1": [],
  "__acrt_update_multibyte_info_1": [],
  "_mbstowcs_s_l_1": [],
  "_mbstowcs_l_helper_1": [],
  "_wcstombs_s_l_1": [],
  "_isctype_l_1": [],
  "FUN_140016988_1": [],
  "InternalGetLocaleInfoA_1": [],
  "__acrt_GetStringTypeA_1": [],
  "__acrt_GetLocaleInfoA_1": [
    {
      "ATT&CK ID": "T1132",
      "Indicator": "HTTP requests contain Base64 strings: Contains base64 string in header \"DQAAAAAAAAAOAAAAAAAAABMAAAAIAAAABAAAAAIAAAAIAAAAAAAAAA==\" in header \"GET /registered?code=DQAAAAAAAAAOAAAAAAAAABMAAAAIAAAABAAAAAIAAAAIAAAAAAAAAA==&t=MTkyLjE2OC4wLjIgMAAtMFAtMFYtMJEtMHYtMPgNCjEyNy4wLjAuMSANCi== HTTP/1.1Host: timestamp.digicert.comCache-Control: no-cache\"\n Contains base64 string in header \"digicert\" in header \"GET /registered?code=DQAAAAAAAAAOAAAAAAAAABMAAAAIAAAABAAAAAIAAAAIAAAAAAAAAA==&t=MTkyLjE2OC4wLjIgMAAtMFAtMFYtMJEtMHYtMPgNCjEyNy4wLjAuMSANCi== HTTP/1.1Host: timestamp.digicert.comCache-Control: no-cache\"\n Contains base64 string in header \"comCache\" in header \"GET /registered?code=DQAAAAAAAAAOAAAAAAAAABMAAAAIAAAABAAAAAIAAAAIAAAAAAAAAA==&t=MTkyLjE2OC4wLjIgMAAtMFAtMFYtMJEtMHYtMPgNCjEyNy4wLjAuMSANCi== HTTP/1.1Host: timestamp.digicert.comCache-Control: no-cache\"",
      "Comment": "The function retrieves locale-specific information based on the input parameters by invoking internal locale APIs and managing dynamic memory allocation for the returned data. It first attempts to obtain locale data using `InternalGetLocaleInfoA` or `__acrt_GetLocaleInfoEx` depending on the mode specified by the `param_2` argument. When the initial call indicates that the buffer is insufficient (signaled by a specific error code), the function allocates memory dynamically using `_calloc_base` to hold the full locale information string or structure.\n\nIf memory allocation succeeds, the function makes a second call to the locale API to fill the allocated buffer with the requested locale data. It then copies or assigns this data to the output pointer `param_5`. In case of any failure during copying or allocation, the function triggers a fail-fast mechanism via `_invoke_watson` to handle critical errors. The function also ensures proper cleanup by freeing any allocated memory that is no longer needed.\n\nThroughout its execution, the function uses error checking on API calls and system error codes (via `GetLastError`) to determine the appropriate control flow, including retrying with adjusted buffer sizes or aborting on unrecoverable errors. It employs a security cookie check at the end to verify stack integrity, protecting against buffer overflows or stack corruption.\n\nOverall, the function acts as a robust wrapper around locale information retrieval APIs, dynamically managing memory buffers to safely return locale data strings or structures to the caller. It interacts primarily with locale-related internal APIs, dynamic memory allocation routines, and system error handling mechanisms to ensure reliable and secure operation.",
      "Matched Sentence": "It employs a security cookie check at the end to verify stack integrity, protecting against buffer overflows or stack corruption.",
      "Similarity": 0.751331
    }
  ],
  "__acrt_LCMapStringA_stat_1": [],
  "__acrt_LCMapStringA_1": [],
  "_set_errno_from_matherr_1": [],
  "_raise_exc_1": [
    {
      "ATT&CK ID": "T1543.003",
      "Indicator": "Creates or modifies windows services: \"1bc5621a4818f2124ac085da21f607ca.exe\" (Access type: \"CREATE\"; Path: \"HKLM\\SYSTEM\\CONTROLSET001\\SERVICES\\TCPIP\\PARAMETERS\")",
      "Comment": "The function initializes by dynamically loading essential system libraries and resolving critical API functions required for its operation. It allocates memory buffers and constructs specific file paths, often targeting system directories or user profile locations. The function then attempts to create or open files using `CreateFileW`, writing data to these files, which suggests it is responsible for dropping or updating payloads or configuration files on the disk.\n\nIn parallel, the function interacts with the Windows Registry by opening or creating keys and setting values via `RegCreateKeyExW` and `RegSetValueExW`. These registry modifications are likely aimed at establishing persistence mechanisms, such as configuring autorun entries or storing configuration parameters. The function uses loops and conditional checks to verify the success of these operations, retrying or branching based on the results to ensure the intended system modifications are applied.\n\nThroughout its execution, the function handles string operations to build file paths and registry key names dynamically, often incorporating environment variables or system-specific directories. It also performs cleanup and error handling to maintain stability. Overall, the function’s behavior centers on deploying files to the system, modifying registry settings to maintain persistence, and ensuring these changes are successfully applied, indicating its role in establishing or maintaining a foothold on the host system.",
      "Matched Sentence": "The function uses loops and conditional checks to verify the success of these operations, retrying or branching based on the results to ensure the intended system modifications are applied.",
      "Similarity": 0.751822
    }
  ],
  "_raise_exc_ex_1": [],
  "_ctrlfp_1": [],
  "FUN_140017a50_1": [],
  "_realloc_base_1": [],
  "iswctype_1": [],
  "_fileno_1": [],
  "FUN_140017bfc_1": [],
  "_mbtowc_l_1": [
    {
      "ATT&CK ID": "T1082",
      "Indicator": "Reads information about supported languages: \"1bc5621a4818f2124ac085da21f607ca.exe\" (Path: \"HKLM\\SYSTEM\\CONTROLSET001\\CONTROL\\NLS\\CUSTOMLOCALE\"; Key: \"EN-US\")\n \"1bc5621a4818f2124ac085da21f607ca.exe\" (Path: \"HKLM\\SYSTEM\\CONTROLSET001\\CONTROL\\NLS\\EXTENDEDLOCALE\"; Key: \"EN-US\")",
      "Comment": "The function converts a multibyte character string to a wide character string according to a specified locale. It first handles edge cases where the source string is null, empty, or the source size is zero, returning zero immediately. It then initializes locale-specific information to determine the appropriate code page for conversion.\n\nIf the locale’s code page matches UTF-8 (0xfde9), the function uses a UTF-8 specific conversion routine to translate the multibyte sequence into a wide character, returning the number of bytes processed or an error code if the conversion fails.\n\nFor other locales, if no locale name is set, the function performs a simple single-byte to wide character conversion by casting the source byte directly. Otherwise, it checks if the first byte is a lead byte for a multibyte character sequence. If it is not a lead byte, it converts a single byte using the locale’s code page. If it is a lead byte, it attempts to convert a multibyte sequence of length specified by the locale’s collation code page, ensuring the source buffer is large enough and the sequence is valid.\n\nIn case of conversion failure, the function sets the DOS error code to 0x2a (ERROR_INVALID_PARAMETER) and returns an error indicator. Throughout, it conditionally writes the converted wide character to the destination buffer if it is provided.\n\nThe function’s control flow is driven by conditionals that handle locale-specific code pages, lead byte detection, and buffer size checks, ensuring robust multibyte to wide character conversion tailored to the locale’s encoding rules.",
      "Matched Sentence": "It then initializes locale-specific information to determine the appropriate code page for conversion.",
      "Similarity": 0.805927
    }
  ],
  "FUN_140017c08_1": [],
  "__acrt_uninitialize_stdio_1": [],
  "__acrt_initialize_stdio_1": [],
  "__acrt_uninitialize_lowio_1": [],
  "__acrt_initialize_lowio_1": [],
  "__acrt_initialize_fma3_1": [
    {
      "ATT&CK ID": "T1082",
      "Indicator": "Calls an API typically used to get system version information: \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"RtlGetVersion\" with parameter 140100000a00000000000000ab3f00000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 (UID: 00000000-00003620)\n \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"RtlGetVersion\" with parameter 140100000a00000000000000ab3f0000020000000000000090a7ab12a90100000000000000000000db04a124fd7f0000268cf8f27ac90000000000000000000000000000000000000000f11cfd7f00007095a621fd7f000034c6091dfd7f0000a8400b1dfd7f00001c1ea124fd7f0000a00f3922fd7f000018efaf1f0c000000d01f9012a9010000d01f9012a9010000a8400b1dfd7f0000000000000c0000000000000000000000b688f41cfd7f0000a0a7ab12a9010000a00f3922fd7f0000d01f9012a901000000000000000000000200000000000000c0a6ab12a90100000000000000000000000000000000000090a7ab12a901000071ecf51cfd7f0000000000000000000061a7ab12a901000000000000 (UID: 00000000-00003620)\n \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"RtlGetVersion\" with parameter 000000000a00000000000000ab3f00000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 (UID: 00000000-00003620)\n \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"RtlGetVersion\" with parameter 1c0100000a00000000000000ab3f00000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 (UID: 00000000-00003620)\n \"1bc5621a4818f2124ac085da21f607ca.exe\" called \"RtlGetVersion\" with parameter 240100000a00000000000000ab3f00000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 (UID: 00000000-00003620)",
      "Comment": "The function performs a CPU feature check by invoking the `cpuid_Version_info` API with a parameter of 1 to retrieve processor version information. It examines specific bits within the returned CPU feature flags (at offset 0xC) to determine if certain advanced instruction set extensions (specifically bits corresponding to 0x18001000) are supported. If these bits are set, the function further checks the processor’s extended control register state (`XCR0`) to verify if the processor’s operating environment enables the use of AVX and AVX-512 instructions (indicated by bits 1 and 2 in `XCR0`). Based on these checks, it sets two global variables to indicate the availability of these advanced CPU features. The function concludes by returning zero, signaling successful completion of the feature detection process. This behavior is typically used to conditionally enable optimized code paths that rely on specific CPU instruction sets.",
      "Matched Sentence": "The function performs a CPU feature check by invoking the `cpuid_Version_info` API with a parameter of 1 to retrieve processor version information.",
      "Similarity": 0.78741
    }
  ],
  "initialize_inherited_file_handles_nolock_1": [],
  "initialize_stdio_handles_nolock_1": [
    {
      "ATT&CK ID": "T1057",
      "Indicator": "Contains ability to enumerate process and/or its information (API string): Found reference to API \"GetModuleHandleW\" (Indicator: \"GetModuleHandle\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API \"GetCurrentProcess\" (Indicator: \"GetCurrentProcess\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API \"GetModuleHandleExW\" (Indicator: \"GetModuleHandle\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API \"GetCurrentProcessId\" (Indicator: \"GetCurrentProcess\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API \"GetEnvironmentStringsW\" (Indicator: \"GetEnvironmentStrings\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API \"GetCurrentProcessorNumber\" (Indicator: \"GetCurrentProcess\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API \"5188481145,4780,3120,,CreateToolhelp32Snapshot,kernel32.dll,\"01:03:57.015\",RX=0,PX=0\" (Indicator: \"CreateToolhelp32Snapshot\"; Source: \"00000000-00003620.00000000.245741.1295B000.00000004.mdmp\")\n Found reference to API \"GetCurrentProcessorNumber\" (Indicator: \"GetCurrentProcess\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API \"GetModuleHandleW\" (Indicator: \"GetModuleHandle\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API \"GetCurrentProcess\" (Indicator: \"GetCurrentProcess\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API \"GetCurrentProcessId\" (Indicator: \"GetCurrentProcess\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API \"GetModuleHandleExW\" (Indicator: \"GetModuleHandle\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API \"GetEnvironmentStringsW\" (Indicator: \"GetEnvironmentStrings\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")",
      "Comment": "The function initializes standard I/O handles for the current process by querying and configuring the standard input, output, and error handles. It iterates over the three standard handles (stdin, stdout, stderr) using a loop, retrieving each handle via `GetStdHandle` with the corresponding standard handle identifiers (`STD_INPUT_HANDLE`, `STD_OUTPUT_HANDLE`, `STD_ERROR_HANDLE`). For each handle, it checks the validity and type using `GetFileType`.\n\nIf a handle is invalid or of an unknown type, the function marks the associated internal data structure with specific flags indicating an unusable or special state. For valid handles, it stores the handle and sets flags based on the file type: if the handle corresponds to a character device (e.g., console), it sets a flag indicating this; if it corresponds to a disk file or pipe, it sets different flags accordingly. The function also updates related internal structures to reflect the handle states.\n\nOverall, this function prepares the runtime environment by establishing the status and characteristics of the standard I/O streams, enabling subsequent operations to correctly interact with these handles based on their type and availability.",
      "Matched Sentence": "It iterates over the three standard handles (stdin, stdout, stderr) using a loop, retrieving each handle via `GetStdHandle` with the corresponding standard handle identifiers (`STD_INPUT_HANDLE`, `STD_OUTPUT_HANDLE`, `STD_ERROR_HANDLE`).",
      "Similarity": 0.786432
    }
  ],
  "FUN_140017f00_1": [],
  "FUN_140018228_1": [],
  "FUN_140018024_1": [],
  "__acrt_WideCharToMultiByte_1": [],
  "__acrt_MultiByteToWideChar_1": [
    {
      "ATT&CK ID": "T1082",
      "Indicator": "Contains ability to read software policies: \"1bc5621a4818f2124ac085da21f607ca.exe\" (Path: \"HKLM\\SOFTWARE\\POLICIES\\MICROSOFT\\WINDOWS\\SAFER\\CODEIDENTIFIERS\"; Key: \"TRANSPARENTENABLED\")\n \"1bc5621a4818f2124ac085da21f607ca.exe\" (Path: \"HKLM\\SOFTWARE\\POLICIES\\MICROSOFT\\WINDOWS\\SAFER\\CODEIDENTIFIERS\"; Key: \"AUTHENTICODEENABLED\")",
      "Comment": "The function acts as a specialized wrapper around the Windows API `MultiByteToWideChar`, selectively modifying the `dwFlags` parameter based on the provided code page (`param_1`). It first evaluates the code page value against specific ranges and discrete values, applying bitwise checks and conditional logic to determine whether to clear or preserve certain flag bits. In particular, for certain code pages (notably those above 0xc436 and specific values like 0xd698, 0xdeaa, 0xdeb4, 65000, and 0xfde9), it masks the `dwFlags` parameter to retain only the `MB_ERR_INVALID_CHARS` flag (value 8), effectively restricting the conversion behavior to error reporting on invalid characters. For all other code pages, it clears the flags by setting `dwFlags` to zero. After this conditional adjustment, the function calls the original `MultiByteToWideChar` API with the potentially modified flags, input string, and output buffer parameters to perform the character set conversion. This approach ensures controlled and consistent handling of character encoding conversions, likely to avoid unexpected behavior or errors when dealing with certain code pages.",
      "Matched Sentence": "It first evaluates the code page value against specific ranges and discrete values, applying bitwise checks and conditional logic to determine whether to clear or preserve certain flag bits.",
      "Similarity": 0.755384
    }
  ],
  "_wcsicmp_1": [],
  "raise_1": [],
  "_wcsicmp_l_1": [],
  "__acrt_get_process_end_policy_1": [
    {
      "ATT&CK ID": "T1027.007",
      "Indicator": "Able to read the PEB (Process Environment Block) structure: \"sample.bin\" can read 64 bit PEB structure (dword ptr gs:[00000060h]) (Offset: 72518)",
      "Comment": "The function checks a specific process termination policy by accessing the Process Environment Block (PEB) to retrieve a status value. It reads an integer located at an offset within the PEB to determine if the process environment is valid (i.e., the value is non-negative). If valid, it calls an internal policy query function to obtain the current process termination method, storing the result in a local variable. The function then returns `0` if the termination method matches a particular policy (indicated by the value `1`), signaling a specific end-of-process behavior. Otherwise, it returns `1`. This behavior suggests the function is used to query and enforce a configured process exit policy, likely influencing how the process should terminate under certain conditions.",
      "Matched Sentence": "It reads an integer located at an offset within the PEB to determine if the process environment is valid (i.e., the value is non-negative).",
      "Similarity": 0.853894
    }
  ],
  "_isleadbyte_l_1": [],
  "copy_and_add_argument_to_buffer<wchar_t>_1": [],
  "getSystemCP_1": [],
  "common_expand_argv_wildcards<wchar_t>_1": [
    {
      "ATT&CK ID": "T1083",
      "Indicator": "Contains ability to enumerate files on disk (API string): Found reference to API \"FindNextFileW\" (Indicator: \"FindNextFile\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API \"FindFirstFileExW\" (Indicator: \"FindFirstFile\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API \"FindFirstFileExW\" (Indicator: \"FindFirstFile\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API \"FindNextFileW\" (Indicator: \"FindNextFile\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")",
      "Comment": "The function processes an input array of wide-character strings, expanding any wildcard patterns present in the arguments into matching file names. It iterates through each input string, checking for wildcard characters such as `*` and `?`. When a wildcard is detected, the function uses the Windows API `FindFirstFileExW` and `FindNextFileW` to enumerate all files matching the pattern. It filters out the special directory entries `.` and `..` to avoid redundant results.\n\nFor each matched file, the function constructs a new argument by combining the file name with the original pattern’s directory path and adds it to an internal dynamic buffer. If no wildcard is found in an argument, the function simply copies the argument as-is into the buffer. After processing all input strings, it calculates the total number and combined length of the expanded arguments, allocates a contiguous buffer to hold them, and copies the expanded arguments into this buffer, ensuring proper null-termination and memory safety.\n\nThe function interacts heavily with system components related to file system enumeration, specifically using `FindFirstFileExW` and `FindNextFileW` to perform pattern matching on file names. It manages dynamic memory allocation for storing the expanded argument list and ensures cleanup of temporary buffers to prevent leaks. The control flow is driven by a loop over the input arguments, with conditional branches handling the presence or absence of wildcards, and nested loops for enumerating matching files.\n\nOverall, the function’s behavioral objective is to expand command-line arguments containing wildcards into a fully enumerated list of matching file paths, facilitating subsequent processing stages that require explicit file names rather than patterns. This is a common utility in command-line parsing to support wildcard expansion on Windows systems where the shell does not perform this automatically.",
      "Matched Sentence": "When a wildcard is detected, the function uses the Windows API `FindFirstFileExW` and `FindNextFileW` to enumerate all files matching the pattern.",
      "Similarity": 0.847558
    },
    {
      "ATT&CK ID": "T1083",
      "Indicator": "Contains ability to enumerate files inside a directory: FindFirstFileExW@KERNEL32.dll at 40298-939-000000014001896E",
      "Comment": "The function processes an input array of wide-character strings, expanding any wildcard patterns present in the arguments into matching file names. It iterates through each input string, checking for wildcard characters such as `*` and `?`. When a wildcard is detected, the function uses the Windows API `FindFirstFileExW` and `FindNextFileW` to enumerate all files matching the pattern. It filters out the special directory entries `.` and `..` to avoid redundant results.\n\nFor each matched file, the function constructs a new argument by combining the file name with the original pattern’s directory path and adds it to an internal dynamic buffer. If no wildcard is found in an argument, the function simply copies the argument as-is into the buffer. After processing all input strings, it calculates the total number and combined length of the expanded arguments, allocates a contiguous buffer to hold them, and copies the expanded arguments into this buffer, ensuring proper null-termination and memory safety.\n\nThe function interacts heavily with system components related to file system enumeration, specifically using `FindFirstFileExW` and `FindNextFileW` to perform pattern matching on file names. It manages dynamic memory allocation for storing the expanded argument list and ensures cleanup of temporary buffers to prevent leaks. The control flow is driven by a loop over the input arguments, with conditional branches handling the presence or absence of wildcards, and nested loops for enumerating matching files.\n\nOverall, the function’s behavioral objective is to expand command-line arguments containing wildcards into a fully enumerated list of matching file paths, facilitating subsequent processing stages that require explicit file names rather than patterns. This is a common utility in command-line parsing to support wildcard expansion on Windows systems where the shell does not perform this automatically.",
      "Matched Sentence": "The function interacts heavily with system components related to file system enumeration, specifically using `FindFirstFileExW` and `FindNextFileW` to perform pattern matching on file names.",
      "Similarity": 0.867893
    }
  ],
  "setSBCS_1": [],
  "FUN_140018d80_1": [],
  "update_thread_multibyte_data_internal_1": [],
  "setSBUpLow_1": [],
  "__acrt_initialize_multibyte_1": [],
  "FUN_140019230_1": [],
  "__acrt_update_thread_multibyte_data_1": [],
  "FUN_140019944_1": [
    {
      "ATT&CK ID": "T1057",
      "Indicator": "Contains ability to retrieve/open a process (API string): Found reference to API \"GetProcessHeap\" (Indicator: \"GetProcessHeap\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API \"GetProcessHeap\" (Indicator: \"GetProcessHeap\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")",
      "Comment": "The function initializes a global handle by calling `GetProcessHeap()` and assigns it to a global variable. It then returns a boolean value indicating whether the heap handle was successfully obtained (i.e., not `NULL`). This setup is typically used to prepare for subsequent memory allocation operations that rely on the process heap. The function’s behavior is straightforward: it interacts with the system’s memory management API to acquire a handle to the default heap, enabling efficient dynamic memory management in later code execution.",
      "Matched Sentence": "The function initializes a global handle by calling `GetProcessHeap()` and assigns it to a global variable.",
      "Similarity": 0.81954
    }
  ],
  "FUN_1400197e4_1": [
    {
      "ATT&CK ID": "T1059.003",
      "Indicator": "Contains ability to retrieve the command-line string for the current process (API string): Found reference to API \"GetCommandLineW\" (Indicator: \"GetCommandLine\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API \"GetCommandLineA\" (Indicator: \"GetCommandLine\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API \"GetCommandLineA\" (Indicator: \"GetCommandLine\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API \"GetCommandLineW\" (Indicator: \"GetCommandLine\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")",
      "Comment": "The function retrieves the current process command line in both ANSI and wide-character formats by calling the Windows API functions `GetCommandLineA` and `GetCommandLineW`. It stores the ANSI command line string in a global or static variable `_DAT_14003a9d0` and the wide-character command line string in `DAT_14003a9d8`. This operation allows the program to access the full command line arguments used to launch the process in both string encodings, potentially for later parsing or decision-making based on those arguments. The function completes by returning a success indicator (`1`), signaling that the command line retrieval was performed successfully.",
      "Matched Sentence": "The function retrieves the current process command line in both ANSI and wide-character formats by calling the Windows API functions `GetCommandLineA` and `GetCommandLineW`.",
      "Similarity": 0.882497
    },
    {
      "ATT&CK ID": "T1059.003",
      "Indicator": "Able to retrieve command line parameters of the running process: Found string \"GetCommandLineA\" (Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found string \"GetCommandLineW\" (Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")",
      "Comment": "The function retrieves the current process command line in both ANSI and wide-character formats by calling the Windows API functions `GetCommandLineA` and `GetCommandLineW`. It stores the ANSI command line string in a global or static variable `_DAT_14003a9d0` and the wide-character command line string in `DAT_14003a9d8`. This operation allows the program to access the full command line arguments used to launch the process in both string encodings, potentially for later parsing or decision-making based on those arguments. The function completes by returning a success indicator (`1`), signaling that the command line retrieval was performed successfully.",
      "Matched Sentence": "It stores the ANSI command line string in a global or static variable `_DAT_14003a9d0` and the wide-character command line string in `DAT_14003a9d8`.",
      "Similarity": 0.816834
    },
    {
      "ATT&CK ID": "T1059.003",
      "Indicator": "Able to import GetCommandLine API, which retrieves the command line string for the current process: Observed import api \"GetCommandLineA\" which can \"retrieve the command-line string for the current process\" [Source: 1bc5621a4818f2124ac085da21f607ca]",
      "Comment": "The function retrieves the current process command line in both ANSI and wide-character formats by calling the Windows API functions `GetCommandLineA` and `GetCommandLineW`. It stores the ANSI command line string in a global or static variable `_DAT_14003a9d0` and the wide-character command line string in `DAT_14003a9d8`. This operation allows the program to access the full command line arguments used to launch the process in both string encodings, potentially for later parsing or decision-making based on those arguments. The function completes by returning a success indicator (`1`), signaling that the command line retrieval was performed successfully.",
      "Matched Sentence": "This operation allows the program to access the full command line arguments used to launch the process in both string encodings, potentially for later parsing or decision-making based on those arguments.",
      "Similarity": 0.83131
    }
  ],
  "__dcrt_get_wide_environment_from_os_1": [
    {
      "ATT&CK ID": "T1082",
      "Indicator": "Able to retrieve information about the current system (API string): Found system information discovery API: \"GetEnvironmentStringsW\" in file \"1bc5621a4818f2124ac085da21f607ca\"\n Found system information discovery API: \"GetEnvironmentStringsW\" in \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\"",
      "Comment": "The function retrieves the current process’s wide-character environment block by calling `GetEnvironmentStringsW`, which returns a pointer to a sequence of null-terminated environment strings ending with an additional null character. It then iterates through this block to calculate the total size of the environment strings, accounting for the double-null terminator that marks the end of the block. After determining the size, the function allocates a buffer of appropriate length using a custom memory allocation routine (`_malloc_base`). It copies the entire environment block into this newly allocated buffer via a helper function (`FUN_14000c330`), ensuring the environment strings are preserved independently of the original system memory. Finally, it frees the original environment strings using `FreeEnvironmentStringsW` and returns a pointer to the duplicated environment block. This process allows the caller to safely access and manipulate the environment variables without affecting the system’s original environment data.",
      "Matched Sentence": "The function retrieves the current process’s wide-character environment block by calling `GetEnvironmentStringsW`, which returns a pointer to a sequence of null-terminated environment strings ending with an additional null character.",
      "Similarity": 0.841774
    }
  ],
  "__acrt_execute_initializers_1": [],
  "_setmbcp_nolock_1": [],
  "__acrt_execute_uninitializers_1": [],
  "__crt_seh_guarded_call<void>::operator()<class_<lambda_842d9ff0dc9ef11c61343bbaebe7f885>,class_<lambda_c5860995281e5c4ce005b3de8f5874ee>&___ptr64,class_<lambda_d90129c13df834fdcbf8d2b88dafcf2d>_>_1": [
    {
      "ATT&CK ID": "T1129",
      "Indicator": "Loads the RPC (Remote Procedure Call) module DLL: \"1bc5621a4818f2124ac085da21f607ca.exe\" loaded module \"%WINDIR%\\System32\\rpcrt4.dll\" at 220F0000\n \"certutil.exe\" loaded module \"%WINDIR%\\System32\\rpcrt4.dll\" at 220F0000",
      "Comment": "The function performs conditional flushing of a file stream and updates associated status counters based on the outcome. It begins by invoking an external routine on the first parameter, likely preparing or validating a resource. It then checks a nested pointer within the second parameter to ensure a valid file stream is present. From this stream, it reads a status flag and evaluates multiple bitwise conditions to determine whether flushing is necessary.\n\nIf the conditions indicate that flushing should occur, and either a specific character flag is set or another status bit is active, the function calls `_fflush_nolock` on the file stream to flush buffered data without locking. It then checks the result of this flush operation: if flushing fails (returns -1), it sets an error indicator to `-1` in a status field; if successful, it increments a success counter. If flushing is not required based on the flags, the function simply increments the success counter without flushing.\n\nFinally, the function calls another external routine on the third parameter, likely to finalize or clean up resources. Throughout, the function manipulates pointers to internal structures that track the file stream, error states, and counters, indicating its role in managing buffered I/O with error handling and status tracking.",
      "Matched Sentence": "It begins by invoking an external routine on the first parameter, likely preparing or validating a resource.",
      "Similarity": 0.760525
    }
  ],
  "common_flush_all_1": [],
  "__acrt_stdio_flush_nolock_1": [],
  "__crt_seh_guarded_call<void>::operator()<class_<lambda_886d6c58226a84441f68b9f2b8217b83>,class_<lambda_ab61a845afdef5b7c387490eaf3616ee>&___ptr64,class_<lambda_f7f22ab5edc0698d5f6905b0d3f44752>_>_1": [],
  "__acrt_lowio_destroy_handle_array_1": [],
  "FID_conflict:__acrt_lowio_lock_fh_1": [],
  "wcsncpy_s_1": [],
  "__acrt_lowio_ensure_fh_exists_1": [
    {
      "ATT&CK ID": "T1480",
      "Indicator": "Creates mutants: Process 1bc5621a4818f2124ac085da21f607ca.exe created mutex with name  \"\\Sessions\\1\\BaseNamedObjects\\SM0:3620:304:WilStaging_02\"\n Process 1bc5621a4818f2124ac085da21f607ca.exe created mutex with name  \"SM0:3620:304:WilStaging_02\"\n Process 1bc5621a4818f2124ac085da21f607ca.exe created mutex with name  \"SM0:3620:120:WilError_01\"\n Process 1bc5621a4818f2124ac085da21f607ca.exe created mutex with name  \"Local\\SM0:3620:304:WilStaging_02\"\n Process 1bc5621a4818f2124ac085da21f607ca.exe created mutex with name  \"Local\\ZonesCacheCounterMutex\"\n Process 1bc5621a4818f2124ac085da21f607ca.exe created mutex with name  \"Local\\ZonesLockedCacheCounterMutex\"\n Process 1bc5621a4818f2124ac085da21f607ca.exe created mutex with name  \"\\Sessions\\1\\BaseNamedObjects\\Local\\SM0:3620:304:WilStaging_02\"\n Process 1bc5621a4818f2124ac085da21f607ca.exe created mutex with name  \"\\Sessions\\1\\BaseNamedObjects\\SM0:3620:120:WilError_01\"\n Process 1bc5621a4818f2124ac085da21f607ca.exe created mutex with name  \"\\Sessions\\1\\BaseNamedObjects\\Local\\ZonesCacheCounterMutex\"\n Process 1bc5621a4818f2124ac085da21f607ca.exe created mutex with name  \"\\Sessions\\1\\BaseNamedObjects\\Local\\ZonesLockedCacheCounterMutex\"",
      "Comment": "The function ensures the existence of a file handle corresponding to a given index within a predefined limit (less than 0x2000). It begins by acquiring a lock to synchronize access to a global handle array. It then iterates from a starting index up to the requested handle index, checking if each handle slot is initialized. For any uninitialized slot, it calls a helper function to create and allocate a new handle array entry. If allocation fails at any point, the function releases the lock and returns an error code indicating failure. Upon successfully ensuring all required handle slots exist, it releases the lock and returns success. If the requested handle index exceeds the allowed maximum, the function sets the DOS error code to 9 (indicating a bad file descriptor) and returns this error without attempting allocation. This behavior involves synchronization primitives, dynamic memory allocation for handle management, and error handling through system error codes, ensuring robust and thread-safe management of low-level file handles.",
      "Matched Sentence": "It begins by acquiring a lock to synchronize access to a global handle array.",
      "Similarity": 0.752793
    }
  ],
  "_free_osfhnd_1": [],
  "__acrt_lowio_create_handle_array_1": [],
  "__acrt_locale_free_monetary_1": [],
  "__acrt_locale_free_numeric_1": [],
  "_get_osfhandle_1": [],
  "__acrt_locale_free_time_1": [],
  "FUN_14001a1e8_1": [],
  "initialize_lc_time_1": [
    {
      "ATT&CK ID": "T1124",
      "Indicator": "Able to retrieve date formats supported by the local system (API string): Found reference to API \"GetDateFormatEx\" (Indicator: \"GetDateFormat\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API \"GetTimeFormatEx\" (Indicator: \"GetTimeFormat\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API \"GetDateFormatEx\" (Indicator: \"GetDateFormat\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")\n Found reference to API \"GetTimeFormatEx\" (Indicator: \"GetTimeFormat\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")",
      "Comment": "The function initializes locale-specific time data by querying various locale information attributes through repeated calls to the `__acrt_GetLocaleInfoA` API. It first obtains a locale name string via `__acrt_copy_locale_name` and stores it within the provided locale time data structure. Then, it iterates over a set of locale information identifiers, systematically retrieving both string and numeric locale data related to date and time formatting. These retrieved values are stored at specific offsets within the locale time data structure, reflecting components such as day and month names, date separators, and time formats.\n\nThe function employs multiple loops to cover a range of locale information constants, ensuring comprehensive initialization of the locale time data. After populating the structure, it performs a series of checks to verify that all `__acrt_GetLocaleInfoA` calls succeeded without errors (indicated by zero return values). The final return value indicates success only if all queried locale information was retrieved successfully and no errors occurred during the process.\n\nOverall, the function interacts primarily with locale-related APIs to populate and validate a locale time data structure, preparing it for use in locale-aware time formatting operations within the C runtime environment.",
      "Matched Sentence": "These retrieved values are stored at specific offsets within the locale time data structure, reflecting components such as day and month names, date separators, and time formats.",
      "Similarity": 0.829595
    }
  ],
  "FUN_14001a788_1": [],
  "free_crt_array_internal_1": [],
  "__acrt_locale_initialize_time_1": [
    {
      "ATT&CK ID": "T1070.006",
      "Indicator": "Contains ability to query local/system time as file time: GetSystemTimeAsFileTime@KERNEL32.dll at 40298-1347-000000014000B8E9",
      "Comment": "The function initializes locale-specific time data within a given locale structure. It first checks if a particular locale time data pointer is null; if so, it releases any existing locale time reference and assigns a default global time data pointer. If the pointer is not null, the function allocates memory for a new locale time data structure using a base allocation routine. It then attempts to initialize this newly allocated structure with locale-specific time information. Upon successful initialization, it sets a flag within the structure to indicate readiness, frees any previously allocated memory, and updates the locale structure to reference the new time data. If initialization fails, the function frees the allocated memory and returns an error status. Throughout, the function carefully manages memory allocation and deallocation to maintain consistency and avoid leaks, relying on internal helper functions for initialization and cleanup of locale time data.",
      "Matched Sentence": "It then attempts to initialize this newly allocated structure with locale-specific time information.",
      "Similarity": 0.778709
    }
  ],
  "__acrt_add_locale_ref_1": [
    {
      "ATT&CK ID": "T1069.002",
      "Indicator": "Contains ability enumerate permission groups in the domain: Observed api used in \"NETAPI32.dll\" [Source: 1bc5621a4818f2124ac085da21f607ca]",
      "Comment": "The function increments multiple internal reference counters associated with a locale object to manage its lifetime safely in a multithreaded environment. It begins by atomically increasing a primary reference count located at an offset within the input structure. Subsequently, it checks several pointer fields within the same structure; for each non-null pointer, it atomically increments the integer value it points to, effectively increasing secondary reference counts tied to related locale components. This process includes a loop that iterates over a fixed set of grouped pointers, conditionally incrementing their referenced counters if they are valid and meet specific criteria. The function employs explicit locking and unlocking mechanisms around each increment operation to ensure thread-safe updates. Finally, it calls a helper function to add a reference to the locale’s time formatting data, further maintaining the integrity of locale-related resources. Overall, the function’s behavior centers on robust reference counting to prevent premature deallocation of locale data structures in a concurrent execution context.",
      "Matched Sentence": "This process includes a loop that iterates over a fixed set of grouped pointers, conditionally incrementing their referenced counters if they are valid and meet specific criteria.",
      "Similarity": 0.757749
    }
  ],
  "__acrt_locale_add_lc_time_reference_1": [],
  "__acrt_free_locale_1": [],
  "__acrt_locale_free_lc_time_if_unreferenced_1": [],
  "FUN_14001b354_1": [],
  "__acrt_release_locale_ref_1": [],
  "_updatetlocinfoEx_nolock_1": [],
  "GetLocaleNameFromDefault_1": [],
  "GetLocaleNameFromLangCountry_1": [],
  "GetLocaleNameFromLanguage_1": [],
  "FUN_14001b928_1": [],
  "ProcessCodePage_1": [],
  "FUN_14001b63c_1": [],
  "TranslateName_1": [],
  "TestDefaultCountry_1": [],
  "FUN_14001be44_1": [],
  "GetLcidFromLanguage_1": [],
  "GetLcidFromLangCountry_1": [],
  "__acrt_get_qualified_locale_1": [],
  "FUN_14001c094_1": [
    {
      "ATT&CK ID": "T1614",
      "Indicator": "Contains ability to query the system locale: GetLocaleInfoW@KERNEL32.dll at 40298-793-0000000140015BC0\n EnumSystemLocalesW@KERNEL32.dll at 40298-879-0000000140015787\n GetUserDefaultLCID@KERNEL32.dll at 40298-893-0000000140015C53\n GetLocaleInfoW@KERNEL32.dll at 40298-991-000000014001BE9A\n EnumSystemLocalesW@KERNEL32.dll at 40298-993-000000014001C02E\n GetLocaleInfoW@KERNEL32.dll at 40298-994-000000014001C0E9\n GetLocaleInfoW@KERNEL32.dll at 40298-996-000000014001C4E8\n GetLocaleInfoW@KERNEL32.dll at 40298-997-000000014001C331\n GetLocaleInfoW@KERNEL32.dll at 40298-998-000000014001C4B0\n EnumSystemLocalesW@KERNEL32.dll at 40298-999-000000014001C616\n GetLocaleInfoW@KERNEL32.dll at 40298-1002-000000014001C438\n EnumSystemLocalesW@KERNEL32.dll at 40298-1005-000000014001BF2C",
      "Comment": "The function processes a locale identifier derived from a hexadecimal string and performs a series of locale comparisons and flag updates within thread-local storage structures. It begins by retrieving thread-specific data pointers and then converts the input string into a locale identifier using `LcidFromHexString`. Using this locale, it calls `GetLocaleInfoW` multiple times to obtain locale-specific strings such as language and sublanguage names.\n\nThe function compares these locale strings against stored thread-local values using case-insensitive string comparisons (`_wcsicmp` and `_wcsnicmp`). Based on these comparisons, it conditionally sets or clears specific bits in a thread-local flags variable, effectively marking the locale status with flags like 0x1, 0x2, 0x100, 0x200, and 0x300. It also updates associated locale values in the thread-local storage when certain conditions are met.\n\nControl flow is driven by nested conditionals that verify the success of locale information retrieval and string matches, with early exits when mismatches occur. The function also references a static array of locale identifiers to exclude certain values from flag updates. A helper function, `TestDefaultLanguage`, is invoked to validate the locale further before setting a particular flag.\n\nOverall, the function’s behavior centers on validating and updating thread-local locale information and flags based on the input locale string. It interacts primarily with thread-local storage, locale APIs (`GetLocaleInfoW`), and string comparison routines to maintain locale-related state within the executing thread context.",
      "Matched Sentence": "It interacts primarily with thread-local storage, locale APIs (`GetLocaleInfoW`), and string comparison routines to maintain locale-related state within the executing thread context.",
      "Similarity": 0.859624
    }
  ],
  "FUN_14001c2e0_1": [],
  "TestDefaultLanguage_1": [],
  "__acrt_DownlevelLCIDToLocaleName_1": [],
  "__acrt_DownlevelLocaleNameToLCID_1": [],
  "__crt_mbstring::__mbrtowc_utf8_1": [],
  "strncpy_s_1": [],
  "KERNEL32.DLL::GetStringTypeW_1": [
    {
      "ATT&CK ID": "T1106",
      "Indicator": "Contains ability to create/open files (API string): Found reference to API \"CreateFileW\" (Indicator: \"CreateFile\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API \"CreateFileW\" (Indicator: \"CreateFile\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")",
      "Comment": "The function primarily performs file system and registry operations to establish persistence and configure system settings. It uses Windows API calls such as `CreateFileW` to open or create files at specific paths, often within system or user directories, indicating it drops or modifies files on disk. The function also interacts with the Windows Registry via APIs like `RegOpenKeyExW` and `RegSetValueExW` to create or modify registry keys and values, typically under run or startup-related keys, to ensure the dropped files or components execute automatically on system boot.\n\nControl flow within the function involves conditional checks to verify the existence of files or registry keys, looping constructs to iterate over multiple registry entries or file paths, and error handling to manage failures in file or registry operations. These control structures ensure that the function only proceeds with persistence mechanisms if the necessary conditions are met, such as confirming the presence of target directories or successful creation of registry entries.\n\nBehaviorally, the function exhibits a persistence mechanism pattern by dropping executable or script files into strategic locations and modifying registry startup keys to trigger their execution. It may also perform environment checks to adapt file paths or registry keys based on system configuration. The use of specific file paths and registry keys related to startup processes highlights its objective to maintain long-term presence on the system. Overall, the function orchestrates system modifications through file and registry manipulation to achieve persistent execution of its payload.",
      "Matched Sentence": "It uses Windows API calls such as `CreateFileW` to open or create files at specific paths, often within system or user directories, indicating it drops or modifies files on disk.",
      "Similarity": 0.851855
    },
    {
      "ATT&CK ID": "T1112",
      "Indicator": "Contains ability to modify registry key/value (API string): Found reference to API \"RegSetKeyValueW\" (Indicator: \"RegSetKeyValue\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API \"RegSetKeyValueW\" (Indicator: \"RegSetKeyValue\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")",
      "Comment": "The function primarily performs file system and registry operations to establish persistence and configure system settings. It uses Windows API calls such as `CreateFileW` to open or create files at specific paths, often within system or user directories, indicating it drops or modifies files on disk. The function also interacts with the Windows Registry via APIs like `RegOpenKeyExW` and `RegSetValueExW` to create or modify registry keys and values, typically under run or startup-related keys, to ensure the dropped files or components execute automatically on system boot.\n\nControl flow within the function involves conditional checks to verify the existence of files or registry keys, looping constructs to iterate over multiple registry entries or file paths, and error handling to manage failures in file or registry operations. These control structures ensure that the function only proceeds with persistence mechanisms if the necessary conditions are met, such as confirming the presence of target directories or successful creation of registry entries.\n\nBehaviorally, the function exhibits a persistence mechanism pattern by dropping executable or script files into strategic locations and modifying registry startup keys to trigger their execution. It may also perform environment checks to adapt file paths or registry keys based on system configuration. The use of specific file paths and registry keys related to startup processes highlights its objective to maintain long-term presence on the system. Overall, the function orchestrates system modifications through file and registry manipulation to achieve persistent execution of its payload.",
      "Matched Sentence": "The function also interacts with the Windows Registry via APIs like `RegOpenKeyExW` and `RegSetValueExW` to create or modify registry keys and values, typically under run or startup-related keys, to ensure the dropped files or components execute automatically on system boot.",
      "Similarity": 0.849748
    }
  ],
  "_fcloseall_1": [],
  "__crt_mbstring::__c32rtomb_utf8_1": [],
  "_isatty_1": [],
  "__acrt_stdio_free_buffer_nolock_1": [],
  "_exception_enabled_1": [],
  "FUN_14001d0cc_1": [],
  "FUN_14001d8df_1": [],
  "_towlower_l_1": [],
  "_msize_base_1": [],
  "FUN_14001d540_1": [
    {
      "ATT&CK ID": "T1083",
      "Indicator": "Tries to access non-existent files (executable): \"1bc5621a4818f2124ac085da21f607ca.exe\" trying to access non-existent file \"C:\\NETAPI32.DLL\"\n \"1bc5621a4818f2124ac085da21f607ca.exe\" trying to access non-existent file \"C:\\WININET.DLL\"\n \"1bc5621a4818f2124ac085da21f607ca.exe\" trying to access non-existent file \"C:\\IPHLPAPI.DLL\"\n \"1bc5621a4818f2124ac085da21f607ca.exe\" trying to access non-existent file \"C:\\SAMCLI.DLL\"\n \"1bc5621a4818f2124ac085da21f607ca.exe\" trying to access non-existent file \"C:\\NETUTILS.DLL\"\n \"1bc5621a4818f2124ac085da21f607ca.exe\" trying to access non-existent file \"C:\\FLTLIB.DLL\"\n \"1bc5621a4818f2124ac085da21f607ca.exe\" trying to access non-existent file \"C:\\CRYPTSP.DLL\"\n \"1bc5621a4818f2124ac085da21f607ca.exe\" trying to access non-existent file \"C:\\WINDOWSCODECS.DLL\"\n \"1bc5621a4818f2124ac085da21f607ca.exe\" trying to access non-existent file \"C:\\WindowsCodecs.dll\"\n \"1bc5621a4818f2124ac085da21f607ca.exe\" trying to access non-existent file \"C:\\CERTUTIL.EXE\"\n \"1bc5621a4818f2124ac085da21f607ca.exe\" trying to access non-existent file \"C:\\certutil.exe\"\n \"1bc5621a4818f2124ac085da21f607ca.exe\" trying to access non-existent file \"certutil.exe\"\n \"1bc5621a4818f2124ac085da21f607ca.exe\" trying to access non-existent file \"C:\\SAMLIB.DLL\"\n \"1bc5621a4818f2124ac085da21f607ca.exe\" trying to access non-existent file \"C:\\SAMLIB.dll\"\n \"1bc5621a4818f2124ac085da21f607ca.exe\" trying to access non-existent file \"C:\\CRYPTBASE.DLL\"\n \"1bc5621a4818f2124ac085da21f607ca.exe\" trying to access non-existent file \"C:\\CRYPTBASE.dll\"\n \"1bc5621a4818f2124ac085da21f607ca.exe\" trying to access non-existent file \"C:\\BCRYPT.DLL\"\n \"1bc5621a4818f2124ac085da21f607ca.exe\" trying to access non-existent file \"C:\\bcrypt.dll\"\n \"1bc5621a4818f2124ac085da21f607ca.exe\" trying to access non-existent file \"C:\\IERTUTIL.DLL\"\n \"1bc5621a4818f2124ac085da21f607ca.exe\" trying to access non-existent file \"C:\\iertutil.dll\"",
      "Comment": "The function implements a custom sorting algorithm over an array of elements, where each element has a fixed size specified by `param_3`. It operates on a buffer pointed to by `param_1` containing `param_2` elements. The sorting logic relies heavily on a comparison callback function, invoked repeatedly via an indirect call (`_guard_dispatch_icall`), which compares two elements and returns an integer indicating their order.\n\nThe function begins by validating its input parameters, ensuring the buffer pointer is not null (unless the element count is zero), the element count is at least two, and the element size is nonzero. If these conditions are not met, it sets a DOS error code and calls error handling routines before returning.\n\nThe core sorting mechanism resembles a variant of quicksort or introsort, using a stack-based approach to manage subarray boundaries. It repeatedly partitions the array by selecting pivot elements and rearranging elements around the pivot based on the comparison results. Swapping of elements is performed byte-wise for the entire element size. The function uses loops and conditional branches to narrow down subarrays and recursively sort them, pushing and popping subarray boundaries on a local stack (`auStack_438` and `auStack_248`) to avoid actual recursion.\n\nKey system interactions include:\n\n- Use of a security cookie check at the start and end to protect against stack corruption.\n- Indirect calls to a comparison function pointer (`_guard_dispatch_icall`), which is critical for determining element order.\n- Byte-wise swapping of elements in memory to reorder the array in place.\n\nNo file, registry, or network operations are performed. The function purely manipulates memory buffers and relies on an external comparison function to define the sorting criteria. Its behavioral objective is to sort an array of fixed-size elements in memory according to a user-supplied comparison routine, ensuring data integrity through security checks and careful boundary management.",
      "Matched Sentence": "If these conditions are not met, it sets a DOS error code and calls error handling routines before returning.",
      "Similarity": 0.763635
    },
    {
      "ATT&CK ID": "T1007",
      "Indicator": "Queries services related registry keys: \"1bc5621a4818f2124ac085da21f607ca.exe\" (Access type: \"QUERYVAL\"; Path: \"HKLM\\SYSTEM\\CONTROLSET001\\SERVICES\\WINSOCK\\PARAMETERS\"; Key: \"TRANSPORTS\"; Value: \"\")\n \"1bc5621a4818f2124ac085da21f607ca.exe\" (Access type: \"QUERYVAL\"; Path: \"HKLM\\SYSTEM\\CONTROLSET001\\SERVICES\\VMBUS\\PARAMETERS\\WINSOCK\"; Key: \"MAPPING\"; Value: \"\")\n \"1bc5621a4818f2124ac085da21f607ca.exe\" (Access type: \"QUERYVAL\"; Path: \"HKLM\\SYSTEM\\CONTROLSET001\\SERVICES\\PSCHED\\PARAMETERS\\WINSOCK\"; Key: \"MAPPING\"; Value: \"\")\n \"1bc5621a4818f2124ac085da21f607ca.exe\" (Access type: \"QUERYVAL\"; Path: \"HKLM\\SYSTEM\\CONTROLSET001\\SERVICES\\WINSOCK\\SETUP MIGRATION\\PROVIDERS\\PSCHED\"; Key: \"WINSOCK 2.0 PROVIDER ID\"; Value: \"\")\n \"1bc5621a4818f2124ac085da21f607ca.exe\" (Access type: \"QUERYVAL\"; Path: \"HKLM\\SYSTEM\\CONTROLSET001\\SERVICES\\TCPIP\\PARAMETERS\\WINSOCK\"; Key: \"MAPPING\"; Value: \"\")\n \"1bc5621a4818f2124ac085da21f607ca.exe\" (Access type: \"QUERYVAL\"; Path: \"HKLM\\SYSTEM\\CONTROLSET001\\SERVICES\\WINSOCK\\SETUP MIGRATION\\PROVIDERS\\TCPIP\"; Key: \"WINSOCK 2.0 PROVIDER ID\"; Value: \"\")\n \"1bc5621a4818f2124ac085da21f607ca.exe\" (Access type: \"QUERYVAL\"; Path: \"HKLM\\SYSTEM\\CONTROLSET001\\SERVICES\\TCPIP\\PARAMETERS\\WINSOCK\"; Key: \"MINSOCKADDRLENGTH\"; Value: \"\")\n \"1bc5621a4818f2124ac085da21f607ca.exe\" (Access type: \"QUERYVAL\"; Path: \"HKLM\\SYSTEM\\CONTROLSET001\\SERVICES\\TCPIP\\PARAMETERS\\WINSOCK\"; Key: \"MAXSOCKADDRLENGTH\"; Value: \"\")\n \"1bc5621a4818f2124ac085da21f607ca.exe\" (Access type: \"QUERYVAL\"; Path: \"HKLM\\SYSTEM\\CONTROLSET001\\SERVICES\\TCPIP\\PARAMETERS\\WINSOCK\"; Key: \"USEDELAYEDACCEPTANCE\"; Value: \"\")\n \"1bc5621a4818f2124ac085da21f607ca.exe\" (Access type: \"QUERYVAL\"; Path: \"HKLM\\SYSTEM\\CONTROLSET001\\SERVICES\\TCPIP\\PARAMETERS\"; Key: \"HOSTNAME\"; Value: \"\")\n \"1bc5621a4818f2124ac085da21f607ca.exe\" (Access type: \"QUERYVAL\"; Path: \"HKLM\\SYSTEM\\CONTROLSET001\\SERVICES\\TCPIP\\PARAMETERS\"; Key: \"DOMAIN\"; Value: \"\")\n \"1bc5621a4818f2124ac085da21f607ca.exe\" (Access type: \"QUERYVAL\"; Path: \"HKLM\\SYSTEM\\CONTROLSET001\\SERVICES\\DNSCACHE\\PARAMETERS\"; Key: \"QUERYADAPTERNAME\"; Value: \"\")\n \"1bc5621a4818f2124ac085da21f607ca.exe\" (Access type: \"QUERYVAL\"; Path: \"HKLM\\SYSTEM\\CONTROLSET001\\SERVICES\\TCPIP\\PARAMETERS\"; Key: \"DISABLEADAPTERDOMAINNAME\"; Value: \"\")",
      "Comment": "The function implements a custom sorting algorithm over an array of elements, where each element has a fixed size specified by `param_3`. It operates on a buffer pointed to by `param_1` containing `param_2` elements. The sorting logic relies heavily on a comparison callback function, invoked repeatedly via an indirect call (`_guard_dispatch_icall`), which compares two elements and returns an integer indicating their order.\n\nThe function begins by validating its input parameters, ensuring the buffer pointer is not null (unless the element count is zero), the element count is at least two, and the element size is nonzero. If these conditions are not met, it sets a DOS error code and calls error handling routines before returning.\n\nThe core sorting mechanism resembles a variant of quicksort or introsort, using a stack-based approach to manage subarray boundaries. It repeatedly partitions the array by selecting pivot elements and rearranging elements around the pivot based on the comparison results. Swapping of elements is performed byte-wise for the entire element size. The function uses loops and conditional branches to narrow down subarrays and recursively sort them, pushing and popping subarray boundaries on a local stack (`auStack_438` and `auStack_248`) to avoid actual recursion.\n\nKey system interactions include:\n\n- Use of a security cookie check at the start and end to protect against stack corruption.\n- Indirect calls to a comparison function pointer (`_guard_dispatch_icall`), which is critical for determining element order.\n- Byte-wise swapping of elements in memory to reorder the array in place.\n\nNo file, registry, or network operations are performed. The function purely manipulates memory buffers and relies on an external comparison function to define the sorting criteria. Its behavioral objective is to sort an array of fixed-size elements in memory according to a user-supplied comparison routine, ensuring data integrity through security checks and careful boundary management.",
      "Matched Sentence": "No file, registry, or network operations are performed.",
      "Similarity": 0.778524
    }
  ],
  "_commit_1": [],
  "write_double_translated_ansi_nolock_1": [],
  "write_text_utf16le_nolock_1": [],
  "write_text_ansi_nolock_1": [
    {
      "ATT&CK ID": "T1105",
      "Indicator": "Contains ability to write files (API string): Found reference to API \"WriteFile\" (Indicator: \"WriteFile\"; File: \"1bc5621a4818f2124ac085da21f607ca\")\n Found reference to API \"WriteFile\" (Indicator: \"WriteFile\"; Source: \"00000000-00003620.00000000.245741.52381000.00000002.mdmp\")",
      "Comment": "The function performs buffered writing of ANSI text data to a file handle retrieved from a global or indexed handle table. It processes the input text buffer in chunks, scanning character-by-character until either the end of the input range or a fixed buffer size limit is reached. During this process, it converts newline characters (`'\\n'`) into carriage return-newline sequences (`\"\\r\\n\"`) by inserting a carriage return before each newline, effectively normalizing line endings for Windows-style text files.\n\nFor each chunk, the function accumulates the transformed characters into a local buffer and then writes this buffer to the target file using the `WriteFile` API. It tracks the total number of bytes successfully written and monitors for write errors. If a write operation fails, it captures the error code via `GetLastError` and terminates further writing. The function loops until all input data is processed or an error occurs.\n\nThe file handle used for writing is obtained indirectly from a data structure indexed by the input parameters, suggesting the function is part of a larger system managing multiple file handles or streams. The function also employs a security cookie check at the end to detect stack corruption.\n\nIn summary, this function implements a low-level, buffered ANSI text writer that normalizes line endings and writes data safely to a pre-existing file handle, handling partial writes and errors robustly.",
      "Matched Sentence": "The file handle used for writing is obtained indirectly from a data structure indexed by the input parameters, suggesting the function is part of a larger system managing multiple file handles or streams.",
      "Similarity": 0.794614
    }
  ],
  "_write_1": [],
  "write_text_utf8_nolock_1": [],
  "common_xtox<unsigned_long,wchar_t>_1": [],
  "_write_nolock_1": [
    {
      "ATT&CK ID": "T1055",
      "Indicator": "Writes data to a remote process: \"1bc5621a4818f2124ac085da21f607ca.exe\" wrote 00000FB8 bytes to a remote process \"C:\\Windows\\System32\\certutil.exe\" (Handle: 668)\n \"1bc5621a4818f2124ac085da21f607ca.exe\" wrote 00000008 bytes to a remote process \"C:\\Windows\\System32\\certutil.exe\" (Handle: 668)\n \"1bc5621a4818f2124ac085da21f607ca.exe\" wrote 00000FB8 bytes to a remote process \"C:\\Windows\\System32\\certutil.exe\" (Handle: 660)\n \"1bc5621a4818f2124ac085da21f607ca.exe\" wrote 00000008 bytes to a remote process \"C:\\Windows\\System32\\certutil.exe\" (Handle: 660)",
      "Comment": "The function implements a low-level, thread-unsafe write operation to a file or console handle, carefully handling different output encodings and device types. It begins by validating input parameters and then determines the internal state and mode of the file handle by indexing into a global file descriptor table. Depending on the handle’s flags, it may seek to the end of the file before writing.\n\nThe function distinguishes between console and non-console handles using `_isatty` and `GetConsoleMode`. For non-console handles or when certain internal flags are set, it writes raw bytes directly to the file using the `WriteFile` API, capturing the number of bytes written and any errors via `GetLastError`.\n\nFor console handles, the function adapts its output based on the encoding mode indicated by internal flags: it supports ANSI, UTF-8, and UTF-16LE text encodings. It calls specialized internal routines (`write_text_ansi_nolock`, `write_text_utf8_nolock`, or `write_text_utf16le_nolock`) to perform the encoding-aware writes. When writing wide characters, it also handles newline translation by inserting carriage returns before line feeds to conform to console expectations.\n\nThroughout the process, the function carefully updates and checks error states, mapping system errors to C runtime error codes. It also handles special cases such as ignoring writes of the ASCII substitute character (0x1A) when a specific flag is set, which is typical for end-of-file markers in text mode.\n\nIn summary, this function provides a robust, encoding-aware, and device-sensitive write operation that interacts directly with Windows file handles and console APIs. It manages file positioning, encoding translation, and error reporting to ensure correct and efficient output to both files and console devices.",
      "Matched Sentence": "For non-console handles or when certain internal flags are set, it writes raw bytes directly to the file using the `WriteFile` API, capturing the number of bytes written and any errors via `GetLastError`.",
      "Similarity": 0.802136
    }
  ],
  "common_xtox_s<unsigned_long,wchar_t>_1": [],
  "_wcsnicmp_l_1": [],
  "wcscmp_1": [],
  "_wcsnicmp_1": [],
  "__crt_mbstring::__c16rtomb_utf8_1": [],
  "common_lseek_nolock<__int64>_1": [],
  "FUN_14001eca0_1": [],
  "_fclose_nolock_1": [],
  "FUN_14001f4a0_1": [],
  "fclose_1": [],
  "__acrt_LCMapStringW_1": [],
  "__crt_seh_guarded_call<int>::operator()<class_<lambda_751a882b2c74d4b022dec766aa51a29a>,class_<lambda_628dfdc04ba53c8bfc02c9951375f3f5>&___ptr64,class_<lambda_f6c7be5f7998530c34de24c7437d6b54>_>_1": [],
  "_close_1": [],
  "__acrt_stdio_free_stream_1": [],
  "FUN_14001f4c0_1": [],
  "__dcrt_lowio_ensure_console_output_initialized_1": [],
  "FUN_14001f7a0_1": [],
  "_close_nolock_1": [],
  "KERNEL32.DLL::IsProcessorFeaturePresent_1": [
    {
      "ATT&CK ID": "T1082",
      "Indicator": "Contains ability to retrieve the OS information (API string): Found reference to API \"4858540945,4796,3024,,RtlGetVersion,NTDLL.dll,\"01:03:56.875\",RX=0,PX=0\" (Indicator: \"GetVersion\"; Source: \"00000000-00003620.00000000.245741.1295B000.00000004.mdmp\")",
      "Comment": "The function acts as a straightforward wrapper around the Windows API call `IsProcessorFeaturePresent`. It receives a processor feature identifier as input and directly invokes the system API with this parameter to determine if the specified processor feature is supported on the current machine. The function then returns the Boolean result obtained from the API call without any additional processing or side effects. This behavior indicates that the function’s sole purpose is to query and relay processor feature availability using the native Windows system call.",
      "Matched Sentence": "This behavior indicates that the function’s sole purpose is to query and relay processor feature availability using the native Windows system call.",
      "Similarity": 0.811063
    }
  ],
  "__dcrt_write_console_1": [],
  "_FindPESection_1": [],
  "_IsNonwritableInCurrentImage_1": [],
  "Unwind@14001f9f0_1": [],
  "Unwind@14001fa10_1": [],
  "_guard_dispatch_icall_1": [],
  "_ValidateImageBase_1": [],
  "Unwind@14001f9fc_1": [],
  "Unwind@14001fa4c_1": [],
  "Unwind@14001fa3c_1": [],
  "Unwind@14001fa5c_1": [],
  "Unwind@14001fa6c_1": [],
  "Unwind@14001fa7c_1": [],
  "Unwind@14001faa0_1": [],
  "Unwind@14001fac0_1": [],
  "Unwind@14001facc_1": [],
  "Unwind@14001fab0_1": [],
  "Unwind@14001fa8c_1": [],
  "Unwind@14001fb00_1": [],
  "Unwind@14001fb40_1": [],
  "Unwind@14001fb80_1": [],
  "Unwind@14001fb70_1": [],
  "Unwind@14001fb0c_1": [],
  "Unwind@14001fb90_1": [],
  "Unwind@14001fb9c_1": [],
  "Unwind@14001fbb0_1": [],
  "Unwind@14001fbc0_1": [],
  "Unwind@14001fbdc_1": [],
  "Unwind@14001fbd0_1": [],
  "Unwind@14001fbf0_1": [],
  "Unwind@14001fbfc_1": [],
  "Unwind@14001fc2e_1": [],
  "Unwind@14001fc08_1": [],
  "Unwind@14001fc3a_1": [],
  "Unwind@14001fc60_1": [],
  "Unwind@14001fc6c_1": [],
  "Unwind@14001fc90_1": [],
  "Unwind@14001fc78_1": [],
  "Unwind@14001fc84_1": [],
  "Unwind@14001fc9c_1": [],
  "Unwind@14001fcd0_1": [],
  "Unwind@14001fd1d_1": [],
  "Unwind@14001fce0_1": [],
  "Unwind@14001fd0d_1": [],
  "Unwind@14001fd30_1": [],
  "Unwind@14001fd48_1": [],
  "Unwind@14001fd90_1": [],
  "Unwind@14001fdfc_1": [],
  "Unwind@14001fdf0_1": [],
  "Catch_All@14001fd9c_1": [],
  "Unwind@14001fd60_1": [],
  "Unwind@14001fe30_1": [],
  "FUN_14001fea6_1": [],
  "Catch_All@14001fe3c_1": [],
  "FUN_14001fe8e_1": [],
  "FUN_14001ff55_1": [],
  "FUN_14001fec4_1": [],
  "FUN_140020020_1": [],
  "FUN_14001ff6d_1": [],
  "FUN_14002005d_1": [],
  "FUN_140020043_1": [],
  "FUN_14002008e_1": [],
  "FUN_14001ff92_1": [],
  "Unwind@1400200c9_1": [],
  "FUN_1400200a8_1": [],
  "FUN_14002011a_1": [],
  "FUN_14002013b_1": [],
  "FUN_14002018c_1": [
    {
      "ATT&CK ID": "T1083",
      "Indicator": "Touches files: \"1bc5621a4818f2124ac085da21f607ca.exe\" trying to touch file \"C:\\Windows\\System32\\apphelp.dll\"\n \"1bc5621a4818f2124ac085da21f607ca.exe\" trying to touch file \"C:\\1bc5621a4818f2124ac085da21f607ca.exe\"\n \"1bc5621a4818f2124ac085da21f607ca.exe\" trying to touch file \"C:\\Windows\\System32\\ntdll.dll\"\n \"1bc5621a4818f2124ac085da21f607ca.exe\" trying to touch file \"C:\\Windows\\System32\\kernel32.dll\"\n \"1bc5621a4818f2124ac085da21f607ca.exe\" trying to touch file \"C:\\Windows\\System32\\KernelBase.dll\"\n \"1bc5621a4818f2124ac085da21f607ca.exe\" trying to touch file \"C:\\Windows\\apppatch\\sysmain.sdb\"\n \"1bc5621a4818f2124ac085da21f607ca.exe\" trying to touch file \"C:\\1BC5621A4818F2124AC085DA21F607CA.EXE.LOCAL\"\n \"1bc5621a4818f2124ac085da21f607ca.exe\" trying to touch file \"C:\\Windows\\WinSxS\\amd64_microsoft.windows.common-controls_6595b64144ccf1df_6.0.16299.248_none_15ced204935f55d7\\comctl32.dll\"\n \"1bc5621a4818f2124ac085da21f607ca.exe\" trying to touch file \"C:\\NETAPI32.DLL\"\n \"1bc5621a4818f2124ac085da21f607ca.exe\" trying to touch file \"C:\\Windows\\System32\\netapi32.dll\"\n \"1bc5621a4818f2124ac085da21f607ca.exe\" trying to touch file \"C:\\WININET.DLL\"\n \"1bc5621a4818f2124ac085da21f607ca.exe\" trying to touch file \"C:\\Windows\\System32\\wininet.dll\"",
      "Comment": "The function performs a straightforward operation by invoking the `__acrt_unlock` routine with a specific lock index (4) and then immediately returns. This indicates that the function’s primary purpose is to release or unlock a synchronization primitive, likely associated with the Microsoft C Runtime (CRT) internal locking mechanism. There are no additional system interactions, file or registry operations, or complex control flows involved. The function serves as a simple wrapper to ensure that a particular CRT lock is released, facilitating thread-safe behavior in a multithreaded environment.",
      "Matched Sentence": "There are no additional system interactions, file or registry operations, or complex control flows involved.",
      "Similarity": 0.761536
    }
  ],
  "FUN_14002016f_1": [],
  "FUN_140020154_1": [],
  "FUN_1400201a5_1": [],
  "FUN_1400201be_1": [
    {
      "ATT&CK ID": "T1070.004",
      "Indicator": "Opens file with deletion access rights: \"1bc5621a4818f2124ac085da21f607ca.exe\" opened \"C:\\Users\\%OSUSER%\\AppData\\Local\\Temp\\crt87D3.tmp\" with delete access\n \"1bc5621a4818f2124ac085da21f607ca.exe\" opened \"C:\\Users\\%OSUSER%\\AppData\\Local\\Temp\\crt894B.tmp\" with delete access",
      "Comment": "The function acquires a low-level I/O lock on a file handle by invoking an internal locking routine, `__acrt_lowio_lock_fh`, passing it a file handle extracted from a structure at a specific offset (`param_2 + 0x48`). This operation ensures exclusive access to the file resource associated with that handle, preventing concurrent I/O operations from other threads or processes. The function’s behavior is focused solely on synchronizing access to the file descriptor, without performing any additional processing or system interactions.",
      "Matched Sentence": "This operation ensures exclusive access to the file resource associated with that handle, preventing concurrent I/O operations from other threads or processes.",
      "Similarity": 0.771246
    }
  ],
  "FUN_140020210_1": [],
  "FUN_1400201d8_1": [],
  "FUN_1400201ef_1": [],
  "std::_Fac_tidy_reg_t::~_Fac_tidy_reg_t_1": [],
  "FUN_14002036c_1": [
    {
      "ATT&CK ID": "T1480",
      "Indicator": "Shows ability to use execution guardrails: The analysis shows indicators which can be used as execution guardrails to ensure that payload only executes against intended targets/system. Matched sigs: Able to identify virtual environment by using user activity (API string)\n Matched sigs: Contains ability to delay execution by waiting for signal/timeout (API string)\n Matched sigs: Contains ability to retrieve the time elapsed since the system was started (API string)\n Matched sigs: Contains ability to delay the execution of current thread",
      "Comment": "The function performs a conditional security or integrity check by invoking a guarded dispatch call through a function pointer stored at a global location. Specifically, it first verifies whether a global variable (`DAT_1400392a8`) is nonzero, indicating that the guarded dispatch mechanism is enabled or initialized. If so, it calls the guarded dispatch function (`_guard_dispatch_icall`) without parameters to obtain a context or handle. If this call returns a nonzero value, the function then calls the guarded dispatch function again, passing the obtained value and the integer `1` as arguments. This pattern suggests the function is leveraging Control Flow Guard (CFG) or a similar runtime protection mechanism to validate or enforce control flow integrity before proceeding. No file, registry, or network operations are performed; the function’s behavior centers exclusively on invoking system-level security checks through indirect calls to a guard dispatch routine.",
      "Matched Sentence": "This pattern suggests the function is leveraging Control Flow Guard (CFG) or a similar runtime protection mechanism to validate or enforce control flow integrity before proceeding.",
      "Similarity": 0.792777
    },
    {
      "ATT&CK ID": "T1068",
      "Indicator": "Opens the Kernel Security Device Driver (KsecDD) of Windows: \"1bc5621a4818f2124ac085da21f607ca.exe\" opened \"\\Device\\KsecDD\"",
      "Comment": "The function performs a conditional security or integrity check by invoking a guarded dispatch call through a function pointer stored at a global location. Specifically, it first verifies whether a global variable (`DAT_1400392a8`) is nonzero, indicating that the guarded dispatch mechanism is enabled or initialized. If so, it calls the guarded dispatch function (`_guard_dispatch_icall`) without parameters to obtain a context or handle. If this call returns a nonzero value, the function then calls the guarded dispatch function again, passing the obtained value and the integer `1` as arguments. This pattern suggests the function is leveraging Control Flow Guard (CFG) or a similar runtime protection mechanism to validate or enforce control flow integrity before proceeding. No file, registry, or network operations are performed; the function’s behavior centers exclusively on invoking system-level security checks through indirect calls to a guard dispatch routine.",
      "Matched Sentence": "No file, registry, or network operations are performed; the function’s behavior centers exclusively on invoking system-level security checks through indirect calls to a guard dispatch routine.",
      "Similarity": 0.767256
    }
  ],
  "_Init_atexit::~_Init_atexit_1": [
    {
      "ATT&CK ID": "T1057",
      "Indicator": "Queries process information: \"1bc5621a4818f2124ac085da21f607ca.exe\" queried SystemProcessInformation at 00000000-00003620-00000C15-2839620952 [PID: 3620]\n \"1bc5621a4818f2124ac085da21f607ca.exe\" queried SystemProcessInformation at 00000000-00003620-00000C15-2839633774 [PID: 3620]\n \"1bc5621a4818f2124ac085da21f607ca.exe\" queried SystemProcessInformation at 00000000-00003620-00000C15-2839874986 [PID: 3620]\n \"1bc5621a4818f2124ac085da21f607ca.exe\" queried SystemProcessInformation at 00000000-00003620-00000C15-2839883776 [PID: 3620]\n \"1bc5621a4818f2124ac085da21f607ca.exe\" queried SystemProcessInformation at 00000000-00003620-00000C15-2841106991 [PID: 3620]\n \"1bc5621a4818f2124ac085da21f607ca.exe\" queried SystemProcessInformation at 00000000-00003620-00000C15-2841114896 [PID: 3620]\n \"1bc5621a4818f2124ac085da21f607ca.exe\" queried SystemProcessInformation at 00000000-00003620-00000C15-2841555039 [PID: 3620]\n \"1bc5621a4818f2124ac085da21f607ca.exe\" queried SystemProcessInformation at 00000000-00003620-00000C15-2841564401 [PID: 3620]",
      "Comment": "The function iterates through a fixed-size array of up to ten encoded function pointers stored in a global data region. For each entry, it decodes the pointer using `DecodePointer` to obtain the original function address. If the decoded pointer is non-null, the function invokes it indirectly via a guarded call mechanism (`_guard_dispatch_icall`). This process effectively calls a series of callback or cleanup functions that were previously registered and encoded for security. The loop ensures that all registered pointers up to the limit are processed sequentially, likely as part of a controlled shutdown or cleanup routine. The function relies on pointer encoding/decoding to protect against pointer corruption or tampering and uses a guarded indirect call to maintain control-flow integrity during invocation.",
      "Matched Sentence": "The loop ensures that all registered pointers up to the limit are processed sequentially, likely as part of a controlled shutdown or cleanup routine.",
      "Similarity": 0.753727
    }
  ],
  "FUN_1400202a0_1": [],
  "FUN_140020230_1": []
}