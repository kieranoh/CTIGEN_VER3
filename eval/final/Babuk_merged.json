[
    {
        "Indicator": "Contains ability to enumerate processes (API string): Observed api string:\"CreateToolhelp32Snapshot\" [Source: 8203c2f00ecd3ae960cb3247a7d7bfb35e55c38939607c85dbdb5c92f0495fa9.bin]\n Observed api string:\"Process32FirstW\" [Source: 8203c2f00ecd3ae960cb3247a7d7bfb35e55c38939607c85dbdb5c92f0495fa9.bin]\n Observed api string:\"Process32NextW\" [Source: 8203c2f00ecd3ae960cb3247a7d7bfb35e55c38939607c85dbdb5c92f0495fa9.bin]",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.71867271,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.69524045,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.6935446,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.69125413,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.73911621,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.84469492,
                "Label": 1
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.78368817,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.70838099,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.73222631,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.72701811,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.7700265,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.73782587,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.76548181,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.76606765,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.75655147,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.74001777,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.73865094,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.78098888,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.76496065,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.82935775,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Dropped files: \"DISMHOST.EXE.5FEF4C01.bin\" has type \"PE32 executable (GUI) Intel 80386 for MS Windows\"\n \"ecdh_pub_k.bin\" has type \"data\"\n \"How To Restore Your Files.txt\" has type \"ASCII text with CRLF line terminators\"",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.71594754,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.75288508,
                "Label": 1
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.68183686,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.71493745,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.7146648,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.71152109,
                "Label": 1
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.7407499,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.70166442,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.70898176,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.72800601,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.749779,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.67085646,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.71756507,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.73280293,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.71629329,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.7882076,
                "Label": 1
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.7493655,
                "Label": 1
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.74676173,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.73441044,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.75595799,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Drops executable files: \"DISMHOST.EXE.5FFDB837.bin\" has type \"PE32+ executable (GUI) x86-64 for MS Windows\"",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.73538828,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.75764796,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.71894029,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.72374681,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.74934906,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.74462532,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.76856339,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.71683084,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.75857077,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.76247055,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.78133476,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.70215764,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.7338439,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.7556738,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.73795406,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.75554189,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.74565001,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.75336863,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.769716,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.78160834,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Reads the active computer name: \"<Input Sample.exe\" (Path: \"HKLM\\SYSTEM\\CONTROLSET001\\CONTROL\\COMPUTERNAME\\ACTIVECOMPUTERNAME\"; Key: \"COMPUTERNAME\")\n \"vssadmin.exe\" (Path: \"HKLM\\SYSTEM\\CONTROLSET001\\CONTROL\\COMPUTERNAME\\ACTIVECOMPUTERNAME\"; Key: \"COMPUTERNAME\")",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.68174036,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.66510032,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.63540983,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.65097355,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.67463296,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.70637578,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.7185344,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.6575405,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.75008652,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.69767759,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.72662361,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.67886877,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.73719892,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.71666178,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.71412439,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.72859884,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.71743482,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.71769197,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.71444213,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.72790458,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Contains ability to retrieve a module handle for the specified module: GetModuleHandleA@KERNEL32.DLL at 00000000-00005464-41422-4-010F2E40",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.68992189,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.68196743,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.67691578,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.68813592,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.70352386,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.76189912,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.71432281,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.68109936,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.71867517,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.71618927,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.74526294,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.71675781,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.70587309,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.7651981,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.75712052,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.73698464,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.75649684,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.75571804,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.74462376,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.83159683,
                "Label": 1
            }
        ]
    },
    {
        "Indicator": "Creates mutants: \"\\Sessions\\1\\BaseNamedObjects\\Local\\RstrMgr3887CAB8-533F-4C85-B0DC-3E5639F8D511\"\n \"\\Sessions\\1\\BaseNamedObjects\\Local\\RstrMgr-3887CAB8-533F-4C85-B0DC-3E5639F8D511-Session0000\"\n \"Local\\RstrMgr-3887CAB8-533F-4C85-B0DC-3E5639F8D511-Session0000\"\n \"Local\\RstrMgr3887CAB8-533F-4C85-B0DC-3E5639F8D511\"\n \"Local\\ZonesCacheCounterMutex\"\n \"Local\\RstrMgr-3887CAB8-533F-4C85-B0DC-3E5639F8D511-Session0001\"\n \"Local\\ZonesLockedCacheCounterMutex\"\n \"Local\\RstrMgr-3887CAB8-533F-4C85-B0DC-3E5639F8D511-Session0002\"\n \"\\Sessions\\1\\BaseNamedObjects\\Local\\RstrMgr-3887CAB8-533F-4C85-B0DC-3E5639F8D511-Session0001\"\n \"\\Sessions\\1\\BaseNamedObjects\\Local\\ZonesCacheCounterMutex\"\n \"\\Sessions\\1\\BaseNamedObjects\\Local\\ZonesLockedCacheCounterMutex\"",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.6902774,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.71478866,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.66410577,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.66331616,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.69105903,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.71378566,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.72503755,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.71106653,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.71023455,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.69650064,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.72924808,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.68054669,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.7175695,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.7388854,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.71236521,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.72393573,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.72262527,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.77169681,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.69817887,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.73158477,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Found potential IP address in binary/memory: Potential IP \"3.0.0.3\" found in string \"\\\\?\\C:\\Users\\HAPUBWS\\AppData\\Local\\Microsoft\\Edge\\User Data\\Autofill\\3.0.0.3\\*\"\n Potential IP \"1.0.0.8\" found in string \"\\\\?\\C:\\Users\\HAPUBWS\\AppData\\Local\\Microsoft\\Edge\\User Data\\AutoLaunchProtocolsComponent\\1.0.0.8\\*\"\n Potential IP \"0.0.0.10\" found in string \"\\\\?\\C:\\Users\\HAPUBWS\\AppData\\Local\\Microsoft\\Edge\\User Data\\Edge Kids Mode\\0.0.0.10\\*\"\n Potential IP \"0.0.1.4\" found in string \"\\\\?\\C:\\Users\\HAPUBWS\\AppData\\Local\\Microsoft\\Edge\\User Data\\OriginTrials\\0.0.1.4\\*\"\n Potential IP \"1.15.0.1\" found in string \"\\\\?\\C:\\Users\\HAPUBWS\\AppData\\Local\\Microsoft\\Edge\\User Data\\Speech Recognition\\1.15.0.1\\*\"\n Potential IP \"10.34.0.24\" found in string \"\\\\?\\C:\\Users\\HAPUBWS\\AppData\\Local\\Microsoft\\Edge\\User Data\\Subresource Filter\\Indexed Rules\\35\\10.34.0.24\\*\"\n Potential IP \"10.34.0.24\" found in string \"\\\\?\\C:\\Users\\HAPUBWS\\AppData\\Local\\Microsoft\\Edge\\User Data\\Subresource Filter\\Unindexed Rules\\10.34.0.24\\*\"\n Potential IP \"1.0.0.23\" found in string \"\\\\?\\C:\\Users\\HAPUBWS\\AppData\\Local\\Microsoft\\Edge\\User Data\\Trust Protection Lists\\1.0.0.23\\*\"\n Potential IP \"1.0.0.23\" found in string \"\\\\?\\C:\\Users\\HAPUBWS\\AppData\\Local\\Microsoft\\Edge\\User Data\\Trust Protection Lists\\1.0.0.23\\Mu\\*\"\n Potential IP \"1.0.0.23\" found in string \"\\\\?\\C:\\Users\\HAPUBWS\\AppData\\Local\\Microsoft\\Edge\\User Data\\Trust Protection Lists\\1.0.0.23\\Sigma\\*\"\n Potential IP \"1.1.0.0\" found in string \"\\\\?\\C:\\Users\\HAPUBWS\\AppData\\Local\\Microsoft\\Edge\\User Data\\Web Notifications Deny List\\1.1.0.0\\*\"\n Potential IP \"3.0.0.0\" found in string \"\\\\?\\C:\\Users\\HAPUBWS\\AppData\\Local\\Microsoft\\Edge\\User Data\\ZxcvbnData\\3.0.0.0\\*\"",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.69055524,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.67017771,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.6677805,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.66582503,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.71743159,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.69650425,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.69328358,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.70359356,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.67866951,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.68137618,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.70764999,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.65044732,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.66821632,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.7098935,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.6985264,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.71203971,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.72826861,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.70073868,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.68242028,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.74129592,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "The input sample dropped very many files: The input sample dropped 1492 files (often an indicator for ransomware)",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.79308174,
                "Label": 1
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.7963113,
                "Label": 1
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.74043134,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.74611448,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.80594372,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.72669458,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.71478235,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.75863381,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.7237067,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.74710785,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.75206592,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.679241,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.70795721,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.74746549,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.73669507,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.77695822,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.71648941,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.7636166,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.72571625,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.73428013,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Found API related strings: \"IsWow64Process\" (Indicator: \"IsWow64Process\")\n \"Wow64DisableWow64FsRedirection\" (Indicator: \"Wow64DisableWow64FsRedirection\")\n \"Wow64RevertWow64FsRedirection\" (Indicator: \"Wow64RevertWow64FsRedirection\")\n \"FindFirstVolumeW\" (Indicator: \"FindFirstVolumeW\")\n \"FindNextVolumeW\" (Indicator: \"FindNextVolumeW\")\n \"FindVolumeClose\" (Indicator: \"FindVolumeClose\")\n \"GetDriveTypeW\" (Indicator: \"GetDriveTypeW\")\n \"GetVolumePathNamesForVolumeNameW\" (Indicator: \"GetVolumePathNamesForVolumeNameW\")\n \"CloseHandle\" (Indicator: \"CloseHandle\")\n \"GetLastError\" (Indicator: \"GetLastError\")\n \"GetCurrentProcess\" (Indicator: \"GetCurrentProcess\")\n \"TerminateProcess\" (Indicator: \"TerminateProcess\")\n \"OpenProcess\" (Indicator: \"OpenProcess\")\n \"GetTickCount\" (Indicator: \"GetTickCount\")\n \"GetModuleHandleA\" (Indicator: \"GetModuleHandleA\")\n \"GetProcAddress\" (Indicator: \"GetProcAddress\")\n \"LoadLibraryA\" (Indicator: \"LoadLibraryA\")\n \"GlobalAlloc\" (Indicator: \"GlobalAlloc\")\n \"SetVolumeMountPointW\" (Indicator: \"SetVolumeMountPointW\")\n \"CreateToolhelp32Snapshot\" (Indicator: \"CreateToolhelp32Snapshot\")",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.67110413,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.66522376,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.65481708,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.66132471,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.68604173,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.72965876,
                "Label": 1
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.72697363,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.66652648,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.69127195,
                "Label": 1
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.76399158,
                "Label": 1
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.76736908,
                "Label": 1
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.68066031,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.7198999,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.70913811,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.73777228,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.71038665,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.70563708,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.72575868,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.69616192,
                "Label": 1
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.8034016,
                "Label": 1
            }
        ]
    },
    {
        "Indicator": "Contains ability to discover network shares: WNetOpenEnumW@MPR.DLL at 00000000-00005464-41422-6-010F48D0",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.71689497,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.69998247,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.68430689,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.70949612,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.79514944,
                "Label": 1
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.75253713,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.72592249,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.70008834,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.74035613,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.75034429,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.76715342,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.72971082,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.73607607,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.76674623,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.80576672,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.73855991,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.75178131,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.75933341,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.73312314,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.7702333,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Calls an API typically used to get product type: \"<Input Sample.exe\" called \"RtlGetNtProductType\" with parameter  (UID: 00000000-00005464)\n \"<Input Sample.exe\" called \"RtlGetNtProductType\" (UID: 00000000-00005464)",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.65273917,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.64402887,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.6066077,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.62482676,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.65623741,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.69888883,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.69474897,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.62884612,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.6843567,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.67759243,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.70348586,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.67749456,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.67360062,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.74025183,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.70128417,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.70799037,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.69282307,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.71501531,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.6967826,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.7260794,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Installs hooks/patches the running process: \"<Input Sample.exe\" wrote bytes \"d04c7376d0157076a076707640187076\" to virtual address \"0x7710E190\" (part of module \"KERNELBASE.DLL\")\n \"<Input Sample.exe\" wrote bytes \"10f2437400b94274f0911c77109d437490924374c0b4437450884374d067437440b24374209c4374108c4374a0a44374507c437450a94374c0b34374805d4374c0e6437490754374c0ee4374a0c4437400c0437410d2427460aa4374\" to virtual address \"0x766B0228\" (part of module \"COMBASE.DLL\")\n \"<Input Sample.exe\" wrote bytes \"f0767476e077747640767476f07574763078747610157176b05e7476807874769077747690767476605e747640777476\" to virtual address \"0x7710E1D4\" (part of module \"KERNELBASE.DLL\")\n \"<Input Sample.exe\" wrote bytes \"1036097420360974\" to virtual address \"0x766B01A0\" (part of module \"COMBASE.DLL\")\n \"<Input Sample.exe\" wrote bytes \"b08a5b74a0615b7460905b74c01b5c74d0445b740059607470a85b74e0a75b7410a35b7460365b7410585b74408b5b7420a95b7430375b7490765b7420365b74c0375b74b0475b74f08c5b74\" to virtual address \"0x76D21140\" (part of module \"WINDOWS.STORAGE.DLL\")\n \"<Input Sample.exe\" wrote bytes \"309ffe73f0660174702afd7320a4fe737023fd73003bfe731060fe73b05bfe7300b0fe73805bfe73d081fe73d00dfc73\" to virtual address \"0x740BE018\" (part of module \"GDI32.DLL\")\n \"<Input Sample.exe\" wrote bytes \"8075717650787176600b7076f0747176b075717610297076e074717610757176500b707600757176\" to virtual address \"0x7710E144\" (part of module \"KERNELBASE.DLL\")\n \"<Input Sample.exe\" wrote bytes \"50167176c0857076\" to virtual address \"0x7710E184\" (part of module \"KERNELBASE.DLL\")\n \"<Input Sample.exe\" wrote bytes \"90431074100c1074\" to virtual address \"0x74B8432C\" (part of module \"SHELL32.DLL\")\n \"<Input Sample.exe\" wrote bytes \"40f65276b0075776409e5276d0d8527670f05976b0f0527680045376106e537670b75376b0ff5376e0ac627600ba597600415976608a517600915176603c577660f85876606e53765007567650b8567640f859769041597650da5976\" to virtual address \"0x7604D010\" (part of module \"SHCORE.DLL\")\n \"<Input Sample.exe\" wrote bytes \"409b7176c09b7176\" to virtual address \"0x7710E1C8\" (part of module \"KERNELBASE.DLL\")\n \"<Input Sample.exe\" wrote bytes \"00eb7076f0ea7076e00f7176e0ea7076900f717630eb7076b0eb7076f0db7076700e717670eb7076d0017176\" to virtual address \"0x7710E208\" (part of module \"KERNELBASE.DLL\")\n \"<Input Sample.exe\" wrote bytes \"e3ddcef2251b0000\" to virtual address \"0xB74C24D0\" (part of module \"NTDLL.DLL\")\n \"<Input Sample.exe\" wrote bytes \"a092da02b092da02b017010080f00600c0020100b0f0060060b20600e091da02f091da02\" to virtual address \"0x7449AC94\" (part of module \"USER32.DLL\")\n \"<Input Sample.exe\" wrote bytes \"80b9717670c9717600cb717620bb7176\" to virtual address \"0x7710E170\" (part of module \"KERNELBASE.DLL\")\n \"<Input Sample.exe\" wrote bytes \"702bbc754038bd754079bc756009bd75e026bc756016bc75a01abc75801dbc75e01abc75d077bc752022bc75b07bbc75e02abc75406bbd75c03dbc756045bc75206cbc751040bc757044bc75203dbc758063bc75303cbd755026bc75\" to virtual address \"0x74B84158\" (part of module \"SHELL32.DLL\")\n \"<Input Sample.exe\" wrote bytes \"d04f6676f0c2507690c6597600cb5076f0f3587640dd587660ef5876102d517680a6507620be577670425976a0be5776c0ff507640bf5776e0585976\" to virtual address \"0x76D215B0\" (part of module \"WINDOWS.STORAGE.DLL\")\n \"<Input Sample.exe\" wrote bytes \"5007567690415976106e5376606e537660f85876a0f95876b0f05276608a5176b0ff5376603c5776f0ef587670f058760041597680045376b0075776b0ff567600915176\" to virtual address \"0x71EA2048\" (part of module \"PROPSYS.DLL\")\n \"<Input Sample.exe\" wrote bytes \"00709d75\" to virtual address \"0x744A4EEC\" (part of module \"USER32.DLL\")\n \"<Input Sample.exe\" wrote bytes \"c0690076a02f007630690076\" to virtual address \"0x76D216F4\" (part of module \"WINDOWS.STORAGE.DLL\")",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.72018455,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.70769652,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.70223639,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.68657625,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.70173665,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.78181714,
                "Label": 1
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.76524407,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.69924608,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.73440102,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.74083303,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.76848154,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.67674771,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.72536824,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.76789066,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.73848692,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.73253875,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.73834801,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.74376384,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.75771174,
                "Label": 1
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.83161029,
                "Label": 1
            }
        ]
    },
    {
        "Indicator": "Reads the registry for installed applications: \"<Input Sample>.exe\" (Path: \"HKCU\\SOFTWARE\\MICROSOFT\\WINDOWS\\CURRENTVERSION\\APP PATHS\\CMD.EXE\")\n \"<Input Sample>.exe\" (Path: \"HKLM\\SOFTWARE\\WOW6432NODE\\MICROSOFT\\WINDOWS\\CURRENTVERSION\\APP PATHS\\CMD.EXE\")",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.68687651,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.68245736,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.63390942,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.6687523,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.68366071,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.73007299,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.73341227,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.65894307,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.72737279,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.7132384,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.7343238,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.68446027,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.70875214,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.73271124,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.75417625,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.75405807,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.76527694,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.74274082,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.73163247,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.76848866,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Creates new processes: \"cmd.exe\" is creating a new process (Name: \"%WINDIR%\\System32\\vssadmin.exe\", Handle: 80)",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.72035513,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.70364843,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.68903067,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.6911374,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.70941356,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.79778377,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.80772145,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.70159243,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.80566524,
                "Label": 1
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.75525997,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.77091184,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.71812723,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.76861697,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.77337118,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.75900186,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.72870488,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.72881996,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.77313458,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.78779027,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.79260342,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Modifies proxy settings: \"<Input Sample.exe\" (Access type: \"SETVAL\"; Path: \"HKCU\\SOFTWARE\\MICROSOFT\\WINDOWS\\CURRENTVERSION\\INTERNET SETTINGS\\ZONEMAP\"; Key: \"PROXYBYPASS\"; Value: \"01000000\")",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.73169575,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.72462826,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.70389504,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.69361585,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.72321444,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.72604292,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.72411834,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.71822848,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.75068435,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.76223834,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.754552,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.68242416,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.72528086,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.73802455,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.72865812,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.72502547,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.74436473,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.75089953,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.73995965,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.7486467,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Contains ability to retrieve information about the current system: GetSystemInfo@KERNEL32.DLL at 00000000-00005464-41422-1-010F49C0",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.7265571,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.69663282,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.694002,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.71080369,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.73150824,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.76717407,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.74003946,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.69051792,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.72761525,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.7353682,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.77863102,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.74267097,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.74280145,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.79403606,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.75730824,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.75424638,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.75933566,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.76290087,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.75748882,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.82474796,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Calls an API typically used to enable or disable privileges in the specified access token: \"vssadmin.exe\" called an API \"AdjustTokenPrivileges\"",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.70115673,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.69792972,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.68600165,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.67759244,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.70641189,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.72930718,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.72086185,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.68933419,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.76180327,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.75537386,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.74793062,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.70460198,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.73436785,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.74300925,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.72363443,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.71219967,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.71473099,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.7527898,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.73718722,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.74701853,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Contains ability to read software policies: \"<Input Sample.exe\" (Path: \"HKLM\\SOFTWARE\\POLICIES\\MICROSOFT\\WINDOWS\\SAFER\\CODEIDENTIFIERS\"; Key: \"TRANSPARENTENABLED\")\n \"<Input Sample.exe\" (Path: \"HKLM\\SOFTWARE\\POLICIES\\MICROSOFT\\WINDOWS\\SAFER\\CODEIDENTIFIERS\"; Key: \"AUTHENTICODEENABLED\")\n \"cmd.exe\" (Path: \"HKLM\\SOFTWARE\\POLICIES\\MICROSOFT\\WINDOWS\\SAFER\\CODEIDENTIFIERS\"; Key: \"TRANSPARENTENABLED\")\n \"cmd.exe\" (Path: \"HKLM\\SOFTWARE\\POLICIES\\MICROSOFT\\WINDOWS\\SAFER\\CODEIDENTIFIERS\"; Key: \"AUTHENTICODEENABLED\")\n \"vssadmin.exe\" (Path: \"HKLM\\SOFTWARE\\POLICIES\\MICROSOFT\\WINDOWS\\SAFER\\CODEIDENTIFIERS\"; Key: \"TRANSPARENTENABLED\")",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.72748224,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.70813739,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.67674963,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.70359819,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.71871321,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.74530379,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.75986955,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.70859325,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.74353867,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.72601664,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.75667799,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.70266779,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.76354034,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.7503339,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.74989596,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.75796692,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.7618873,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.7831906,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.74436688,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.77914789,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Queries the display settings of system associated file extensions: \"<Input Sample.exe\" (Access type: \"QUERYVAL\"; Path: \"HKLM\\SOFTWARE\\CLASSES\\SYSTEMFILEASSOCIATIONS\\.EXE\"; Key: \"ALWAYSSHOWEXT\")\n \"<Input Sample.exe\" (Access type: \"QUERYVAL\"; Path: \"HKLM\\SOFTWARE\\CLASSES\\SYSTEMFILEASSOCIATIONS\\.EXE\"; Key: \"NEVERSHOWEXT\")",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.66547134,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.69350837,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.62924848,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.65945495,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.66663971,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.69941674,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.71947088,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.65421116,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.72428238,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.72331972,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.72902617,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.68738272,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.70854407,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.71864884,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.71608325,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.74102558,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.71929905,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.73154748,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.71266868,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.73679234,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Contains ability to provide information and utilities for managing network resources (API string): Observed api string:\"WNetGetConnectionW  which can retrieves the name of the network resource associated with a local device\"[Source: 8203c2f00ecd3ae960cb3247a7d7bfb35e55c38939607c85dbdb5c92f0495fa9.bin]\n Observed api string:\"WNetOpenEnumW  which can Starts an enumeration of network resources or existing connections\"[Source: 8203c2f00ecd3ae960cb3247a7d7bfb35e55c38939607c85dbdb5c92f0495fa9.bin]\n Observed api string:\"WNetEnumResourceW  which can continues an enumeration of network resources\"[Source: 8203c2f00ecd3ae960cb3247a7d7bfb35e55c38939607c85dbdb5c92f0495fa9.bin]\n Observed api string:\"WNetCloseEnum  which can ends a network resource enumeration\"[Source: 8203c2f00ecd3ae960cb3247a7d7bfb35e55c38939607c85dbdb5c92f0495fa9.bin]",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.66823456,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.66523968,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.65295137,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.66350121,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.75993139,
                "Label": 1
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.72980614,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.69891517,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.66447249,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.70211049,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.7150037,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.72828872,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.72125114,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.72312675,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.75892543,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.74426818,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.7089503,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.73646621,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.75075842,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.69426009,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.76948254,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Contains ability to dynamically load libraries: LoadLibraryA@KERNEL32.DLL at 00000000-00005464-41422-3-010F2A30",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.73678792,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.71751609,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.71013645,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.72311918,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.74494171,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.76549109,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.73501467,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.70566968,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.72764871,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.74446193,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.7664959,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.73521512,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.73096906,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.79688715,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.77430446,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.74644704,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.76043894,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.76237863,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.75383688,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.82168289,
                "Label": 1
            }
        ]
    },
    {
        "Indicator": "Creates or modifies windows services: \"<Input Sample.exe\" (Access type: \"SETVAL\"; Path: \"HKLM\\SYSTEM\\CONTROLSET001\\SERVICES\\BAM\\USERSETTINGS\\S-1-5-21-735145574-3570218355-1207367261-1001\"; Key: \"\\DEVICE\\HARDDISKVOLUME2\\WINDOWS\\SYSTEM32\\CMD.EXE\"; Value: \"7E72D6A2D70FD90100000000000000000000000002000000\")",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.73431556,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.73213789,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.69342617,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.6987007,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.7102771,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.76195032,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.75424479,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.70524043,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.76483889,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.74683044,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.77726379,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.72169913,
                "Label": 1
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.779109,
                "Label": 1
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.76915707,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.73993143,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.74956134,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.75371062,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.76329829,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.76371328,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.77799249,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Reads the registry for installed applications: \"<Input Sample.exe\" (Path: \"HKLM\\SOFTWARE\\MICROSOFT\\WINDOWS\\CURRENTVERSION\\APP PATHS\\CMD.EXE\")",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.70627781,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.69119976,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.65102616,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.68757737,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.69782053,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.73640886,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.73916198,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.6721155,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.73751185,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.71114206,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.73505711,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.70011303,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.71822453,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.74144736,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.75939238,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.76089304,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.76175036,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.74981956,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.73995587,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.75833368,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Contains ability to execute program: ShellExecuteW@SHELL32.DLL at 00000000-00005464-41422-3-010F2A30",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.75074582,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.72143693,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.71230118,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.73516241,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.74402454,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.79135761,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.78393922,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.70771747,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.78696906,
                "Label": 1
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.76566319,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.78731854,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.71750114,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.75375639,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.78251831,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.79308096,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.74811738,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.77006423,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.78002952,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.78425505,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.81973918,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Reads configuration files: \"<Input Sample.exe\" read file \"%USERPROFILE%\\Desktop\\desktop.ini\"\n \"<Input Sample.exe\" read file \"%USERPROFILE%\\Documents\\desktop.ini\"\n \"<Input Sample.exe\" read file \"%USERPROFILE%\\Music\\desktop.ini\"\n \"<Input Sample.exe\" read file \"%USERPROFILE%\\Pictures\\desktop.ini\"\n \"<Input Sample.exe\" read file \"%USERPROFILE%\\Videos\\desktop.ini\"\n \"<Input Sample.exe\" read file \"%USERPROFILE%\\Downloads\\desktop.ini\"\n \"<Input Sample.exe\" read file \"%USERPROFILE%\\OneDrive\\desktop.ini\"\n \"<Input Sample.exe\" read file \"C:\\$Recycle.Bin\\S-1-5-21-735145574-3570218355-1207367261-1001\\desktop.ini\"",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.70120123,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.69109528,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.63157125,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.66348044,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.6866785,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.70386927,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.72591132,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.65880538,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.70391731,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.73012659,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.72704698,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.67550625,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.68875814,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.71249227,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.75549259,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.75617789,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.74890506,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.74918994,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.71493885,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.7188475,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Possibly tries to implement anti-virtualization techniques: \"vboxvideo.inf\" (Indicator: \"vbox\")",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.77629787,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.75547993,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.73747632,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.72535469,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.76219228,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.7297419,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.72605263,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.75687912,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.72538399,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.74430337,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.75894501,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.70380255,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.73792608,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.74352421,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.72069734,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.76058223,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.71709541,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.74263679,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.75382472,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.7671396,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Found potential URL in binary/memory: Pattern match: \"https://www.torproject.org/download/\"\n Pattern match: \"http://babukq4e2p4wu4iq.onion/login.php?id=8M60J4vCbbkKgM6QnA07E9qpkn0Qk7\"",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.73658766,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.71348495,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.68703537,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.69405338,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.71411108,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.6875947,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.67744645,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.7098504,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.66709349,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.67119915,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.70136295,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.64186366,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.6569161,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.6894203,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.68106735,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.73282927,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.715041,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.7061878,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.68198217,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.72472419,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Imports GetCommandLine API: Observed import api \"GetCommandLineA\" which can \"Retrieves the command-line string for the current process\" [Source: 8203c2f00ecd3ae960cb3247a7d7bfb35e55c38939607c85dbdb5c92f0495fa9.bin]",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.69451558,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.68518266,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.67380338,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.68148078,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.69582374,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.72768493,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.69984179,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.67947849,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.72358219,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.71249404,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.72959981,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.72081069,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.68783067,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.74416312,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.73233735,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.72102738,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.75153779,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.7253345,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.71258826,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.77558153,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Calls an API typically used to execute an application: \"<Input Sample.exe\" called \"ShellExecuteW\" with parameter cmd.exe (UID: 00000000-00005464)",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.70589845,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.69661277,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.67146724,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.68687516,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.70001489,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.7601524,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.74742389,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.67676146,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.78285516,
                "Label": 1
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.74386074,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.74381385,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.70400678,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.7129247,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.75396184,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.77184433,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.72519342,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.74386671,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.75295369,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.75943822,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.77159518,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Spawns new processes that are not known child processes: Spawned process \"cmd.exe\" with commandline \"/c vssadmin.exe delete shadows /all /quiet\" (UID: 00064566-00003848)\n Spawned process \"vssadmin.exe\" with commandline \"delete shadows /all /quiet\" (UID: 00064569-00003196)\n Spawned process \"DismHost.exe\" with commandline \"{82047E61-86A0-4474-A471-B6112DA7E946}\" (UID: 00073376-00003488)",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.71443752,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.70518144,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.72898988,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.68604826,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.71669751,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.78325364,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.80434485,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.75047052,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.85270069,
                "Label": 1
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.74040095,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.7896586,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.71781105,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.77224242,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.75181159,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.72473633,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.70077014,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.69833721,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.77609131,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.77546107,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.7774443,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Writes data to a remote process: \"cmd.exe\" wrote 4024 bytes to a remote process \"%WINDIR%\\System32\\vssadmin.exe\" (Handle: 268)\n \"cmd.exe\" wrote 8 bytes to a remote process \"%WINDIR%\\System32\\vssadmin.exe\" (Handle: 268)",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.70267252,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.68932381,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.66847594,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.67488686,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.70242313,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.75024347,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.75507967,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.67755458,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.77093272,
                "Label": 1
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.7426956,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.76657219,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.66314878,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.73340657,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.7529376,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.70657388,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.70911244,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.71523174,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.74171397,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.74427105,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.76878004,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Drops executable files: \"DISMHOST.EXE.5FEF4C01.bin\" has type \"PE32 executable (GUI) Intel 80386 for MS Windows\"",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.73624397,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.7514617,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.71584968,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.71983275,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.7468581,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.74665308,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.77245303,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.71719644,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.75841277,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.76090676,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.77899762,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.7015053,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.73649317,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.75895668,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.74317002,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.75772383,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.74150245,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.75715215,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.7720581,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.78137826,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Creates mutants: \"\\Sessions\\1\\BaseNamedObjects\\Local\\ZonesCacheCounterMutex\"\n \"\\Sessions\\1\\BaseNamedObjects\\Local\\ZonesLockedCacheCounterMutex\"\n \"Local\\RstrMgr3887CAB8-533F-4C85-B0DC-3E5639F8D511\"\n \"Local\\RstrMgr-3887CAB8-533F-4C85-B0DC-3E5639F8D511-Session0000\"\n \"Local\\ZonesCacheCounterMutex\"\n \"Local\\ZonesLockedCacheCounterMutex\"\n \"Local\\RstrMgr-3887CAB8-533F-4C85-B0DC-3E5639F8D511-Session0001\"\n \"Local\\RstrMgr-3887CAB8-533F-4C85-B0DC-3E5639F8D511-Session0002\"\n \"\\Sessions\\1\\BaseNamedObjects\\Local\\RstrMgr3887CAB8-533F-4C85-B0DC-3E5639F8D511\"\n \"\\Sessions\\1\\BaseNamedObjects\\Local\\RstrMgr-3887CAB8-533F-4C85-B0DC-3E5639F8D511-Session0001\"\n \"\\Sessions\\1\\BaseNamedObjects\\Local\\RstrMgr-3887CAB8-533F-4C85-B0DC-3E5639F8D511-Session0000\"\n \"\\Sessions\\1\\BaseNamedObjects\\Local\\RstrMgr-3887CAB8-533F-4C85-B0DC-3E5639F8D511-Session0002\"",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.68898176,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.71157894,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.66693747,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.6655056,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.68818114,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.71792511,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.71981626,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.71540622,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.70538609,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.69250073,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.72330717,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.67646561,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.71170194,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.7298201,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.7090782,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.70897221,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.71022228,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.76201757,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.69191433,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.72794021,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Touches files in the Windows directory: \"<Input Sample.exe\" touched file \"%LOCALAPPDATA%\\Microsoft\\Windows\\Caches\"",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.7396262,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.74159606,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.70518888,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.70935214,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.73115291,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.75355675,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.75340324,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.70531124,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.75685607,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.74990895,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.75626813,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.69005864,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.72340104,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.74189257,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.78666798,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.76752082,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.75394411,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.75490335,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.757586,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.7369625,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Contains ability to enumerate files inside a directory: FindFirstFileW@KERNEL32.DLL at 00000000-00005464-41422-7-010F4620",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.72734335,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.70356438,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.68215472,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.70908764,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.75147739,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.77396667,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.73894116,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.69711409,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.73482567,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.75118902,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.7636251,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.73234742,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.72321545,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.76695212,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.86693827,
                "Label": 1
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.75393735,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.75673912,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.77061586,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.7405529,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.77495762,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Opens file with deletion access rights: \"<Input Sample.exe\" opened \"C:\\$WINDOWS.~BT\\DUDownload\\Setup\\acmigration.dll\" with delete access\n \"<Input Sample.exe\" opened \"C:\\$WINDOWS.~BT\\DUDownload\\Setup\\appraiser.sdb\" with delete access\n \"<Input Sample.exe\" opened \"C:\\$WINDOWS.~BT\\DUDownload\\Setup\\diagtrack.dll\" with delete access\n \"<Input Sample.exe\" opened \"C:\\$WINDOWS.~BT\\DUDownload\\Setup\\mediasetupuimgr.dll\" with delete access\n \"<Input Sample.exe\" opened \"C:\\$WINDOWS.~BT\\DUDownload\\Setup\\migcore.dll\" with delete access\n \"<Input Sample.exe\" opened \"C:\\$WINDOWS.~BT\\DUDownload\\Setup\\reagent.dll\" with delete access\n \"<Input Sample.exe\" opened \"C:\\$WINDOWS.~BT\\DUDownload\\Setup\\replacementmanifests\\contentdeliverymanager.utilities-replacement.man\" with delete access\n \"<Input Sample.exe\" opened \"C:\\$WINDOWS.~BT\\DUDownload\\Setup\\replacementmanifests\\devicedirectory-devicedirectoryclient-desktop-replacement.man\" with delete access\n \"<Input Sample.exe\" opened \"C:\\$WINDOWS.~BT\\DUDownload\\Setup\\replacementmanifests\\gpbase-replacement.man\" with delete access\n \"<Input Sample.exe\" opened \"C:\\$WINDOWS.~BT\\DUDownload\\Setup\\replacementmanifests\\microsoft-windows-advertisingid-replacement.man\" with delete access\n \"<Input Sample.exe\" opened \"C:\\$WINDOWS.~BT\\DUDownload\\Setup\\replacementmanifests\\microsoft-windows-geolocation-replacement.man\" with delete access\n \"<Input Sample.exe\" opened \"C:\\$WINDOWS.~BT\\DUDownload\\Setup\\replacementmanifests\\microsoft-windows-ie-internetexplorer-repl-2.man\" with delete access\n \"<Input Sample.exe\" opened \"C:\\$WINDOWS.~BT\\DUDownload\\Setup\\replacementmanifests\\onecore_speechcommon-rep.man\" with delete access\n \"<Input Sample.exe\" opened \"C:\\$WINDOWS.~BT\\DUDownload\\Setup\\setupcore.dll\" with delete access\n \"<Input Sample.exe\" opened \"C:\\$WINDOWS.~BT\\DUDownload\\Setup\\setupmgr.dll\" with delete access\n \"<Input Sample.exe\" opened \"C:\\$WINDOWS.~BT\\DUDownload\\Setup\\setupplatform.dll\" with delete access\n \"<Input Sample.exe\" opened \"C:\\$WINDOWS.~BT\\DUDownload\\Setup\\setupplatform.exe\" with delete access\n \"<Input Sample.exe\" opened \"C:\\$WINDOWS.~BT\\DUDownload\\Setup\\setupprep.exe\" with delete access\n \"<Input Sample.exe\" opened \"C:\\$WINDOWS.~BT\\DUDownload\\Setup\\uninstall.xml\" with delete access\n \"<Input Sample.exe\" opened \"C:\\$WINDOWS.~BT\\DUDownload\\Setup\\upgrade_bulk.xml\" with delete access",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.70813799,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.71101203,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.69085182,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.67936827,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.69588854,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.75804898,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.78741699,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.71909505,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.76019336,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.74984148,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.76339499,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.69778208,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.72948725,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.74121626,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.74712323,
                "Label": 1
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.75294406,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.74252339,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.79162251,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.75808724,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.75910953,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Writes data to a remote process: \"cmd.exe\" wrote 32 bytes to a remote process \"%WINDIR%\\System32\\vssadmin.exe\" (Handle: 80)\n \"cmd.exe\" wrote 52 bytes to a remote process \"%WINDIR%\\System32\\vssadmin.exe\" (Handle: 80)\n \"cmd.exe\" wrote 4 bytes to a remote process \"%WINDIR%\\System32\\vssadmin.exe\" (Handle: 80)",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.70572636,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.69144589,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.67405808,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.677094,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.70449924,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.7585487,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.76037837,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.68635222,
                "Label": 1
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.77059281,
                "Label": 1
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.73918811,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.76853103,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.67135969,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.73562327,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.75718737,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.71258578,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.7106111,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.71617414,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.74433705,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.7444984,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.77362885,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Queries process information: \"<Input Sample>.exe\" queried SystemProcessInformation at 00065202-00003664-00000033-3370190",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.72789704,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.69833762,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.69188686,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.69367169,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.7108071,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.79829601,
                "Label": 1
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.79853531,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.7042422,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.7640844,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.74646595,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.78191869,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.72886132,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.7397178,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.77682919,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.75516251,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.74436914,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.734218,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.7695332,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.78917817,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.81310156,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Calls an API's typically used for searching a directory for a files: \"<Input Sample.exe\" called \"FindFirstFileW\" (UID: 00000000-00005464)\n \"<Input Sample.exe\" called \"FindNextFileW\" (UID: 00000000-00005464)",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.67564452,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.66911255,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.62688586,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.65389171,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.66594188,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.74053871,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.70112646,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.65068784,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.70633954,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.72436235,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.72141555,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.66974372,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.67019435,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.73357229,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.83092903,
                "Label": 1
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.71591577,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.72422415,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.73756124,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.70286561,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.75156371,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Process launched with changed environment: Process \"cmd.exe\" (UID: 00065413-00000868) was launched with new environment variables: \"PROCESSOR_ARCHITEW6432=\"AMD64\"\"\n Process \"cmd.exe\" (UID: 00065413-00000868) was launched with modified environment variables: \"CommonProgramFiles, PROCESSOR_ARCHITECTURE, ProgramFiles\"\n Process \"vssadmin.exe\" (UID: 00065417-00003716) was launched with new environment variables: \"PROMPT=\"$P$G\"\"\n Process \"vssadmin.exe\" (UID: 00065417-00003716) was launched with modified environment variables: \"CommonProgramFiles, PROCESSOR_ARCHITECTURE, ProgramFiles\"\n Process \"vssadmin.exe\" (UID: 00065417-00003716) was launched with missing environment variables: \"PROCESSOR_ARCHITEW6432\"\n Process \"DismHost.exe\" (UID: 00074149-00003180) was launched with modified environment variables: \"LOCALAPPDATA, USERDOMAIN, TEMP, APPDATA, USERPROFILE, TMP\"\n Process \"DismHost.exe\" (UID: 00074149-00003180) was launched with missing environment variables: \"LOGONSERVER, PROMPT, HOMEPATH, HOMEDRIVE\"",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.70189075,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.69706276,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.68051254,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.67119262,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.69719553,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.75523706,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.77846688,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.69431175,
                "Label": 1
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.76203238,
                "Label": 1
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.73847282,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.79721032,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.69277333,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.73766061,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.72994782,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.71140281,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.71054898,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.72790916,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.755682,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.75557624,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.79988177,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Queries volume information: \"BABUK.exe\" queries volume information of unknown location at 00064419-00002092-0000010C-3462764",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.78700538,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.78878048,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.76909109,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.70806545,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.73547195,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.79293387,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.73946774,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.76626101,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.7616994,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.73998707,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.79125351,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.75774737,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.74195337,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.80490288,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.75112594,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.7534743,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.78607076,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.7361782,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.80526095,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.786349,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Found mail information locations related strings: \"\\\\?\\%LOCALAPPDATA%\\Microsoft\\Outlook\\*\" in Source: 00000000-00005464-00000BD3-343671281572\n \"\\\\?\\%LOCALAPPDATA%\\Microsoft\\Outlook\\gliding\\*\" in Source: 00000000-00005464-00000BD3-343675851276",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.70752718,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.70922579,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.68588223,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.67869182,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.72577378,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.70689816,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.71530092,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.70887257,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.70945149,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.71956915,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.7306267,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.68067857,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.71566425,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.72149026,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.74015813,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.7535179,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.76032483,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.72925929,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.70263051,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.74902159,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Connects to LPC ports: \"<Input Sample>.exe\" connecting to \"\\ThemeApiPort\"",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.69038243,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.68065855,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.65652975,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.65826252,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.70250659,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.72127318,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.72540946,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.66514318,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.69699244,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.70672262,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.71526921,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.7000401,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.70736844,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.74250904,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.73673411,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.6897357,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.71815916,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.73698309,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.73000779,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.73644271,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Overview of unique CLSIDs touched in registry: \"BABUK.exe\" touched \"Computer\" (Path: \"HKCU\\CLSID\\{20D04FE0-3AEA-1069-A2D8-08002B30309D}\\SHELLFOLDER\")\n \"BABUK.exe\" touched \"Network\" (Path: \"HKCU\\CLSID\\{208D2C60-3AEA-1069-A2D7-08002B30309D}\\SHELLFOLDER\")\n \"BABUK.exe\" touched \"Recycle Bin\" (Path: \"HKCU\\CLSID\\{645FF040-5081-101B-9F08-00AA002F954E}\\SHELLFOLDER\")\n \"BABUK.exe\" touched \"Control Panel\" (Path: \"HKCU\\CLSID\\{26EE0668-A00A-44D7-9371-BEB064C98683}\\SHELLFOLDER\")\n \"BABUK.exe\" touched \"UsersFiles\" (Path: \"HKCU\\CLSID\\{59031A47-3F72-44A7-89C5-5595FE6B30EE}\\SHELLFOLDER\")\n \"BABUK.exe\" touched \"UsersLibraries\" (Path: \"HKCU\\CLSID\\{031E4825-7B94-4DC3-B131-E946B44C8DD5}\\SHELLFOLDER\")\n \"BABUK.exe\" touched \"CLSID_SearchFolder\" (Path: \"HKCU\\CLSID\\{04731B67-D933-450A-90E6-4ACD2E9408FE}\\SHELLFOLDER\")\n \"BABUK.exe\" touched \"Microsoft OneNote Namespace Extension for Windows Desktop Search\" (Path: \"HKCU\\CLSID\\{0875DCB6-C686-4243-9432-ADCCF0B9F2D7}\\SHELLFOLDER\")\n \"BABUK.exe\" touched \"IE History and Feeds Shell Data Source for Windows Search\" (Path: \"HKCU\\CLSID\\{11016101-E366-4D22-BC06-4ADA335C892B}\\SHELLFOLDER\")\n \"BABUK.exe\" touched \"@C:\\Program Files (x86)\\Microsoft Office\\Office15\\MAPISHELL.DLL,-110\" (Path: \"HKCU\\CLSID\\{138508BC-1E03-49EA-9C8F-EA9E1D05D65D}\\SHELLFOLDER\")\n \"BABUK.exe\" touched \"Public Folder\" (Path: \"HKCU\\CLSID\\{4336A54D-038B-4685-AB02-99BB52D3FB8B}\\SHELLFOLDER\")\n \"BABUK.exe\" touched \"Control Panel command object for Start menu and desktop\" (Path: \"HKCU\\CLSID\\{5399E694-6CE5-4D6C-8FCE-1D8870FDCBA0}\\SHELLFOLDER\")\n \"BABUK.exe\" touched \"@%systemroot%\\system32\\mssvp.dll,-110\" (Path: \"HKCU\\CLSID\\{89D83576-6BD1-4C86-9454-BEB04E94C819}\\SHELLFOLDER\")\n \"BABUK.exe\" touched \"DXP\" (Path: \"HKCU\\CLSID\\{8FD8B88D-30E1-4F25-AC2B-553D3D65F0EA}\\SHELLFOLDER\")\n \"BABUK.exe\" touched \"CLSID_SearchHome\" (Path: \"HKCU\\CLSID\\{9343812E-1C37-4A49-A12E-4B2D810D956B}\\SHELLFOLDER\")\n \"BABUK.exe\" touched \"Windows Search Service Media Center Namespace Extension Handler\" (Path: \"HKCU\\CLSID\\{98D99750-0B8A-4C59-9151-589053683D73}\\SHELLFOLDER\")\n \"BABUK.exe\" touched \"Other Users Folder\" (Path: \"HKCU\\CLSID\\{B4FB3F98-C1EA-428D-A78A-D1F5659CBA93}\\SHELLFOLDER\")\n \"BABUK.exe\" touched \"@%systemroot%\\system32\\mssvp.dll,-112\" (Path: \"HKCU\\CLSID\\{BD7A2E7B-21CB-41B2-A086-B309680C6B7E}\\SHELLFOLDER\")\n \"BABUK.exe\" touched \"CLSID_StartMenuProviderFolder\" (Path: \"HKCU\\CLSID\\{DAF95313-E44D-46AF-BE1B-CBACEA2C3065}\\SHELLFOLDER\")\n \"BABUK.exe\" touched \"CLSID_StartMenuPathCompleteProviderFolder\" (Path: \"HKCU\\CLSID\\{E345F35F-9397-435C-8F95-4E922C26259E}\\SHELLFOLDER\")",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.73948731,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.75813703,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.72151994,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.68352967,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.70752283,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.79613634,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.76230938,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.73155165,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.73287569,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.72538148,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.78207064,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.73512719,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.76470392,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.7806912,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.76055186,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.73627848,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.77175615,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.76242348,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.78663984,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.7813247,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Overview of unique CLSIDs touched in registry: \"<Input Sample>.exe\" touched \"Computer\" (Path: \"HKCU\\WOW6432NODE\\CLSID\\{20D04FE0-3AEA-1069-A2D8-08002B30309D}\\SHELLFOLDER\")\n \"<Input Sample>.exe\" touched \"Network\" (Path: \"HKCU\\WOW6432NODE\\CLSID\\{208D2C60-3AEA-1069-A2D7-08002B30309D}\\SHELLFOLDER\")\n \"<Input Sample>.exe\" touched \"Recycle Bin\" (Path: \"HKCU\\WOW6432NODE\\CLSID\\{645FF040-5081-101B-9F08-00AA002F954E}\\SHELLFOLDER\")\n \"<Input Sample>.exe\" touched \"Control Panel\" (Path: \"HKCU\\WOW6432NODE\\CLSID\\{26EE0668-A00A-44D7-9371-BEB064C98683}\\SHELLFOLDER\")\n \"<Input Sample>.exe\" touched \"UsersFiles\" (Path: \"HKCU\\WOW6432NODE\\CLSID\\{59031A47-3F72-44A7-89C5-5595FE6B30EE}\\SHELLFOLDER\")\n \"<Input Sample>.exe\" touched \"UsersLibraries\" (Path: \"HKCU\\WOW6432NODE\\CLSID\\{031E4825-7B94-4DC3-B131-E946B44C8DD5}\\SHELLFOLDER\")\n \"<Input Sample>.exe\" touched \"CLSID_SearchFolder\" (Path: \"HKCU\\WOW6432NODE\\CLSID\\{04731B67-D933-450A-90E6-4ACD2E9408FE}\\SHELLFOLDER\")\n \"<Input Sample>.exe\" touched \"IE History and Feeds Shell Data Source for Windows Search\" (Path: \"HKCU\\WOW6432NODE\\CLSID\\{11016101-E366-4D22-BC06-4ADA335C892B}\\SHELLFOLDER\")\n \"<Input Sample>.exe\" touched \"Public Folder\" (Path: \"HKCU\\WOW6432NODE\\CLSID\\{4336A54D-038B-4685-AB02-99BB52D3FB8B}\\SHELLFOLDER\")\n \"<Input Sample>.exe\" touched \"Control Panel command object for Start menu and desktop\" (Path: \"HKCU\\WOW6432NODE\\CLSID\\{5399E694-6CE5-4D6C-8FCE-1D8870FDCBA0}\\SHELLFOLDER\")\n \"<Input Sample>.exe\" touched \"@%systemroot%\\system32\\mssvp.dll,-110\" (Path: \"HKCU\\WOW6432NODE\\CLSID\\{89D83576-6BD1-4C86-9454-BEB04E94C819}\\SHELLFOLDER\")\n \"<Input Sample>.exe\" touched \"CLSID_SearchHome\" (Path: \"HKCU\\WOW6432NODE\\CLSID\\{9343812E-1C37-4A49-A12E-4B2D810D956B}\\SHELLFOLDER\")\n \"<Input Sample>.exe\" touched \"Other Users Folder\" (Path: \"HKCU\\WOW6432NODE\\CLSID\\{B4FB3F98-C1EA-428D-A78A-D1F5659CBA93}\\SHELLFOLDER\")\n \"<Input Sample>.exe\" touched \"@%systemroot%\\system32\\mssvp.dll,-112\" (Path: \"HKCU\\WOW6432NODE\\CLSID\\{BD7A2E7B-21CB-41B2-A086-B309680C6B7E}\\SHELLFOLDER\")\n \"<Input Sample>.exe\" touched \"CLSID_StartMenuProviderFolder\" (Path: \"HKCU\\WOW6432NODE\\CLSID\\{DAF95313-E44D-46AF-BE1B-CBACEA2C3065}\\SHELLFOLDER\")\n \"<Input Sample>.exe\" touched \"CLSID_StartMenuPathCompleteProviderFolder\" (Path: \"HKCU\\WOW6432NODE\\CLSID\\{E345F35F-9397-435C-8F95-4E922C26259E}\\SHELLFOLDER\")\n \"<Input Sample>.exe\" touched \"Games Explorer\" (Path: \"HKCU\\WOW6432NODE\\CLSID\\{ED228FDF-9EA8-4870-83B1-96B02CFE0D52}\\SHELLFOLDER\")\n \"<Input Sample>.exe\" touched \"Computers and Devices\" (Path: \"HKCU\\WOW6432NODE\\CLSID\\{F02C1A0D-BE21-4350-88B0-7367FC96EF3C}\\SHELLFOLDER\")\n \"<Input Sample>.exe\" touched \"Memory Mapped Cache Mgr\" (Path: \"HKCU\\WOW6432NODE\\CLSID\\{1F486A52-3CB1-48FD-8F50-B8DC300D9F9D}\")\n \"<Input Sample>.exe\" touched \"Security Manager\" (Path: \"HKCR\\SOFTWARE\\CLASSES\\WOW6432NODE\\CLSID\\{7B8A2D94-0AC9-11D1-896C-00C04FB6BFC4}\")",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.70360154,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.7072019,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.6721229,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.68430521,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.70605266,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.75477986,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.75314839,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.69948773,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.73734732,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.74491451,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.77421697,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.69052043,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.75087787,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.74120343,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.75950378,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.73586467,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.7320917,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.76198165,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.73906649,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.77321585,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Imports GetEnvironmentVariable API: Observed import api \"GetEnvironmentVariable\" which can \"read the host's architecture\" [Source: 8203c2f00ecd3ae960cb3247a7d7bfb35e55c38939607c85dbdb5c92f0495fa9.bin]",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.71723532,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.692428,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.68714838,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.70085134,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.72577852,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.71122603,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.68689662,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.69407393,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.70445223,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.7209592,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.74858565,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.71107666,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.6982474,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.7426377,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.71499106,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.71177027,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.76390456,
                "Label": 1
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.72296533,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.7041253,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.77423474,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Monitors specific registry key for changes: \"<Input Sample.exe\" monitors \"\\REGISTRY\\MACHINE\\SOFTWARE\\Microsoft\\Ole\" (Filter: 268435457; Subtree: 1973241088)\n \"<Input Sample.exe\" monitors \"\\REGISTRY\\USER\\S-1-5-21-735145574-3570218355-1207367261-1001_Classes\\Local Settings\\Software\\Microsoft\" (Filter: 268435457; Subtree: 1973241089)\n \"<Input Sample.exe\" monitors \"\\REGISTRY\\MACHINE\\SYSTEM\\ControlSet001\\Control\\NetworkProvider\\HwOrder\" (Filter: 4; Subtree: 13627392)\n \"<Input Sample.exe\" monitors \"\\REGISTRY\\MACHINE\\SYSTEM\\ControlSet001\\Control\\NetworkProvider\\ProviderOrder\" (Filter: 4; Subtree: 13627392)\n \"<Input Sample.exe\" monitors \"\\REGISTRY\\USER\\S-1-5-21-735145574-3570218355-1207367261-1001_Classes\" (Filter: 268435461; Subtree: 1973241089)\n \"<Input Sample.exe\" monitors \"\\REGISTRY\\MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Desktop\\NameSpace\" (Filter: 268435461; Subtree: 1973241089)\n \"<Input Sample.exe\" monitors \"\\REGISTRY\\USER\\S-1-5-21-735145574-3570218355-1207367261-1001\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Desktop\\NameSpace\" (Filter: 268435461; Subtree: 1973241089)\n \"<Input Sample.exe\" monitors \"\\REGISTRY\\MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Desktop\\NameSpace\\DelegateFolders\" (Filter: 268435461; Subtree: 1973241089)\n \"<Input Sample.exe\" monitors \"\\REGISTRY\\MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\SyncRootManager\" (Filter: 268435461; Subtree: 1973241089)\n \"vssadmin.exe\" monitors \"\\REGISTRY\\MACHINE\\SOFTWARE\\Microsoft\\Ole\" (Filter: 268435457; Subtree: 0)\n \"vssadmin.exe\" monitors \"\\REGISTRY\\USER\\S-1-5-21-735145574-3570218355-1207367261-1001_Classes\\Local Settings\\Software\\Microsoft\" (Filter: 268435457; Subtree: 1)\n \"vssadmin.exe\" monitors \"\\REGISTRY\\USER\\S-1-5-21-735145574-3570218355-1207367261-1001_Classes\" (Filter: 268435461; Subtree: 1)",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.69980326,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.69070556,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.66523376,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.68446329,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.69357288,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.74504601,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.75042448,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.69117324,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.72870402,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.72339075,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.7494843,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.68412246,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.75411656,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.72962803,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.74149287,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.72313683,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.71553911,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.75368223,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.7419596,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.75685055,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Deletes volume snapshots (often used by ransomware): Deletes volume snapshots files \"vssadmin.exe\" with commandline \"delete shadows /all /quiet\" (UID: 00065417-00003716)",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.74446095,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.75831561,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.76157508,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.73012418,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.76038718,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.75835186,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.7317342,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.77044553,
                "Label": 1
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.86576016,
                "Label": 1
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.76556132,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.79542801,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.69211255,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.7650898,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.72561602,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.73021078,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.7306437,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.72250441,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.76714777,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.73260845,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.74256367,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Imports windows networking related APIs: Observed import api \"WNetCloseEnum\" which can \"ends a network resource enumeration\" [Source: 8203c2f00ecd3ae960cb3247a7d7bfb35e55c38939607c85dbdb5c92f0495fa9.bin]\n Observed import api \"WNetEnumResource\" which can \"continues an enumeration of network resources\" [Source: 8203c2f00ecd3ae960cb3247a7d7bfb35e55c38939607c85dbdb5c92f0495fa9.bin]\n Observed import api \"WNetGetConnection\" which can \"retrieves the name of the network resource associated with a local device\" [Source: 8203c2f00ecd3ae960cb3247a7d7bfb35e55c38939607c85dbdb5c92f0495fa9.bin]\n Observed import api \"WNetOpenEnum\" which can \"starts an enumeration of network resources or existing connections.\" [Source: 8203c2f00ecd3ae960cb3247a7d7bfb35e55c38939607c85dbdb5c92f0495fa9.bin]",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.68445909,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.66733621,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.66162309,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.65676774,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.76673689,
                "Label": 1
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.75354362,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.73412064,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.67590467,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.71212408,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.73645385,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.74298909,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.7311062,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.73812257,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.75386266,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.75788373,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.70285403,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.71977043,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.75705932,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.7101565,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.77403108,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Drops files inside appdata directory: Dropped file: \"ecdh_pub_k.bin\"  - Location: [%APPDATA%\\ecdh_pub_k.bin]- [targetUID: 00000000-00005464]",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.74401845,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.75400173,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.69743831,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.7538251,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.72334304,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.71099189,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.71648448,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.73429966,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.7167775,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.72012311,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.73516283,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.67463191,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.70487359,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.73984502,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.73279393,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.7601643,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.84585458,
                "Label": 1
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.73136328,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.72911302,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.72428905,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Reads the registry for installed applications: \"BABUK.exe\" (Path: \"HKCU\\SOFTWARE\\MICROSOFT\\WINDOWS\\CURRENTVERSION\\APP PATHS\\CMD.EXE\")\n \"BABUK.exe\" (Path: \"HKLM\\SOFTWARE\\MICROSOFT\\WINDOWS\\CURRENTVERSION\\APP PATHS\\CMD.EXE\")",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.72991003,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.73616965,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.68687283,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.66660173,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.68603433,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.76870634,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.72811575,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.69476615,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.7094817,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.69102534,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.74268681,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.72356643,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.7102114,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.76398783,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.73333914,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.74423971,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.7977688,
                "Label": 1
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.73675752,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.77566173,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.7774553,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "CRC value set in PE header does not match actual value: \"DISMHOST.EXE.5FEF4C01.bin\" claimed CRC 103114 while the actual is CRC 46883",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.72839541,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.73321228,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.70256372,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.72403936,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.7285812,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.71060947,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.70246764,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.73158744,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.73739549,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.72646678,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.75027423,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.66946215,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.70326878,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.7517997,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.69971259,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.73564465,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.73309306,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.72225892,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.74553011,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.75718383,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Reads information about supported languages: \"<Input Sample.exe\" (Path: \"HKLM\\SYSTEM\\CONTROLSET001\\CONTROL\\NLS\\CUSTOMLOCALE\"; Key: \"EMPTY\")\n \"<Input Sample.exe\" (Path: \"HKLM\\SYSTEM\\CONTROLSET001\\CONTROL\\NLS\\EXTENDEDLOCALE\"; Key: \"EN-US\")\n \"<Input Sample.exe\" (Path: \"HKLM\\SYSTEM\\CONTROLSET001\\CONTROL\\NLS\\CUSTOMLOCALE\"; Key: \"EN-US\")\n \"cmd.exe\" (Path: \"HKLM\\SYSTEM\\CONTROLSET001\\CONTROL\\NLS\\LOCALE\"; Key: \"00000409\")\n \"cmd.exe\" (Path: \"HKLM\\SYSTEM\\CONTROLSET001\\CONTROL\\NLS\\EXTENDEDLOCALE\"; Key: \"EN-US\")\n \"cmd.exe\" (Path: \"HKLM\\SYSTEM\\CONTROLSET001\\CONTROL\\NLS\\CUSTOMLOCALE\"; Key: \"EN-US\")",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.69690538,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.69232719,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.65046011,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.6707356,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.69072151,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.71863248,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.72113885,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.67822616,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.71577481,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.70790561,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.73347941,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.70427262,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.71941088,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.7365797,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.74152393,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.75198706,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.74809986,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.73120584,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.71553402,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.75432273,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Touches files in the Windows directory: \"<Input Sample>.exe\" touched file \"C:\\Windows\\AppPatch\\sysmain.sdb\"\n \"<Input Sample>.exe\" touched file \"C:\\Windows\\SysWOW64\\ieframe.dll\"\n \"<Input Sample>.exe\" touched file \"C:\\Windows\\SysWOW64\\en-US\\ieframe.dll.mui\"\n \"<Input Sample>.exe\" touched file \"%LOCALAPPDATA%\\Microsoft\\Windows\\Caches\"\n \"<Input Sample>.exe\" touched file \"%LOCALAPPDATA%\\Microsoft\\Windows\\Caches\\cversions.1.db\"\n \"<Input Sample>.exe\" touched file \"%LOCALAPPDATA%\\Microsoft\\Windows\\Caches\\{AFBF9F1A-8EE8-4C77-AF34-C647E37CA0D9}.1.ver0x000000000000001d.db\"\n \"cmd.exe\" touched file \"C:\\Windows\\System32\\en-US\\cmd.exe.mui\"\n \"cmd.exe\" touched file \"C:\\Windows\\Globalization\\Sorting\\SortDefault.nls\"\n \"cmd.exe\" touched file \"C:\\Windows\\AppPatch\\AppPatch64\\sysmain.sdb\"\n \"vssadmin.exe\" touched file \"C:\\Windows\\System32\\en-US\\vssadmin.exe.mui\"\n \"vssadmin.exe\" touched file \"C:\\Windows\\System32\\rsaenh.dll\"\n \"vssadmin.exe\" touched file \"C:\\Windows\\Globalization\\Sorting\\SortDefault.nls\"\n \"DismHost.exe\" touched file \"C:\\Windows\\TEMP\\46138F86-2B0F-425C-B1E1-CD9252A034CF\\en-US\\dismhost.exe.mui\"\n \"DismHost.exe\" touched file \"C:\\Windows\\TEMP\\46138F86-2B0F-425C-B1E1-CD9252A034CF\\en\\dismhost.exe.mui\"\n \"DismHost.exe\" touched file \"C:\\Windows\\System32\\rsaenh.dll\"",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.71520607,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.72340366,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.70013352,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.68729226,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.70898588,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.7654566,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.78694748,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.71006727,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.75296615,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.75277554,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.77398623,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.68686303,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.739066,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.7493374,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.78078354,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.76126107,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.73410836,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.76670248,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.74647579,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.77367034,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Contains ability to empty the Recycle Bin on the specified drive: SHEmptyRecycleBinA@SHELL32.DLL at 00000000-00005464-41422-1-010F49C0",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.72349525,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.72164498,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.71734262,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.70464791,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.73503183,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.75701079,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.7223665,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.72245424,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.76862245,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.75307637,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.78448124,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.7015743,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.72449732,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.76927418,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.74488632,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.74259922,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.7399371,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.76725502,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.75019739,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.7674093,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Process launched with changed environment: Process \"cmd.exe\" (UID: 00000000-00006112) was launched with new environment variables: \"PROCESSOR_ARCHITEW6432=\"AMD64\"\"\n Process \"cmd.exe\" (UID: 00000000-00006112) was launched with modified environment variables: \"CommonProgramFiles, PROCESSOR_ARCHITECTURE, ProgramFiles\"\n Process \"vssadmin.exe\" (UID: 00000000-00004868) was launched with new environment variables: \"PROMPT=\"$P$G\"\"\n Process \"vssadmin.exe\" (UID: 00000000-00004868) was launched with modified environment variables: \"CommonProgramFiles, PROCESSOR_ARCHITECTURE, ProgramFiles\"\n Process \"vssadmin.exe\" (UID: 00000000-00004868) was launched with missing environment variables: \"PROCESSOR_ARCHITEW6432\"",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.69572102,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.69150138,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.67276716,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.66396232,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.68955185,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.75178849,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.77376081,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.68686256,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.76075764,
                "Label": 1
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.73113557,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.79522699,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.68853948,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.73282113,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.72460119,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.7048299,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.71058421,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.72049172,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.75215663,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.75378737,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.79730404,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Reads configuration files: \"BABUK.exe\" read file \"C:\\$Recycle.Bin\\S-1-5-21-2092356043-4041700817-663127204-1001\\desktop.ini\"",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.78098153,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.76642137,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.71226459,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.70620736,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.72615289,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.76641731,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.75007102,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.728038,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.73269451,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.74587258,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.77731409,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.74693979,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.7333496,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.78177349,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.77107556,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.77211214,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.8075256,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.76901388,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.78308342,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.76347991,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Reads the active computer name: \"<Input Sample>.exe\" (Path: \"HKLM\\SYSTEM\\CONTROLSET001\\CONTROL\\COMPUTERNAME\\ACTIVECOMPUTERNAME\"; Key: \"COMPUTERNAME\")\n \"vssadmin.exe\" (Path: \"HKLM\\SYSTEM\\CONTROLSET001\\CONTROL\\COMPUTERNAME\\ACTIVECOMPUTERNAME\"; Key: \"COMPUTERNAME\")\n \"DismHost.exe\" (Path: \"HKLM\\SYSTEM\\CONTROLSET001\\CONTROL\\COMPUTERNAME\\ACTIVECOMPUTERNAME\"; Key: \"COMPUTERNAME\")",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.68665133,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.67807707,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.6478263,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.66062692,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.68571864,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.72098103,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.74314367,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.66518997,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.75598699,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.71260298,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.73776288,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.6868592,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.74977079,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.72573536,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.725972,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.73669639,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.72650248,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.73050508,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.73001324,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.74440385,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Reads the cryptographic machine GUID: \"vssadmin.exe\" (Path: \"HKLM\\SOFTWARE\\MICROSOFT\\CRYPTOGRAPHY\"; Key: \"MACHINEGUID\")\n \"DismHost.exe\" (Path: \"HKLM\\SOFTWARE\\MICROSOFT\\CRYPTOGRAPHY\"; Key: \"MACHINEGUID\")",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.70678379,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.6990285,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.65459852,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.70411076,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.70387131,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.7055605,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.70332377,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.70175952,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.73852831,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.70267399,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.73040318,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.66249619,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.72484556,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.73066293,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.70415956,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.72584233,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.74190579,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.73952445,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.7140898,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.76100261,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Modifies proxy settings: \"<Input Sample>.exe\" (Access type: \"DELETEVAL\"; Path: \"HKCU\\SOFTWARE\\MICROSOFT\\WINDOWS\\CURRENTVERSION\\INTERNET SETTINGS\\ZONEMAP\"; Key: \"PROXYBYPASS\")\n \"<Input Sample>.exe\" (Access type: \"DELETEVAL\"; Path: \"HKLM\\SOFTWARE\\WOW6432NODE\\MICROSOFT\\WINDOWS\\CURRENTVERSION\\INTERNET SETTINGS\\ZONEMAP\"; Key: \"PROXYBYPASS\")",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.70518074,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.70821828,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.68264876,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.67494471,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.70693778,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.72045914,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.72441069,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.70830669,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.75454474,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.75097404,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.74740469,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.66938213,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.71294882,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.71899553,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.71485195,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.71674999,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.74112553,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.74419192,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.73196393,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.75172389,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Dropped files: \"ecdh_pub_k.bin\" has type \"data\"- Location: [%APPDATA%\\ecdh_pub_k.bin]- [targetUID: 00000000-00005464]\n \"How To Restore Your Files.txt\" has type \"ASCII text with CRLF line terminators\"- Location: [C:\\share\\How To Restore Your Files.txt]- [targetUID: 00000000-00005464]",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.73263203,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.77198062,
                "Label": 1
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.68836631,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.74780292,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.72723197,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.69804002,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.71502076,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.72322764,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.71386641,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.72154066,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.74762695,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.67341767,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.71381744,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.73860976,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.72785088,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.8182599,
                "Label": 1
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.82379745,
                "Label": 1
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.7472097,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.71597357,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.72882866,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Accesses potentially sensitive information from local browsers: \"<Input Sample.exe\" had access to \"%LOCALAPPDATA%\\Microsoft\\Edge\\User Data\\Default\\Safe Browsing Network\\Safe Browsing Cookies-journal\" (Type: \"FileHandle\")",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.7411614,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.73341934,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.69748998,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.71942583,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.75159818,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.73682172,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.73421287,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.71002008,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.71959233,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.72725571,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.73190101,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.69023794,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.71366091,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.73110769,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.74741558,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.75672075,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.75800935,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.76049155,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.74855882,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.75783177,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Contains ability to retrieve the host's architecture (API string): Observed api string:\"GetEnvironmentVariableW\" [Source: 8203c2f00ecd3ae960cb3247a7d7bfb35e55c38939607c85dbdb5c92f0495fa9.bin]",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.70963954,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.70030762,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.68961078,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.71285706,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.73952101,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.7274602,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.69978895,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.69199204,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.72650338,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.73321103,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.77247747,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.71844729,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.71434443,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.75216405,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.74226024,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.72995724,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.77659073,
                "Label": 1
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.73780607,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.72236935,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.79184883,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Opens the Kernel Security Device Driver (KsecDD) of Windows: \"<Input Sample>.exe\" opened \"\\Device\\KsecDD\"\n \"vssadmin.exe\" opened \"\\Device\\KsecDD\"",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.69648593,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.6782152,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.66102273,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.67950907,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.68002139,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.73026469,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.72919819,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.67685168,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.74825187,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.7196841,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.73714043,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.65746943,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.72163972,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.72768284,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.71712062,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.72388305,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.72124215,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.7339526,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.72003206,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.7518249,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Opens file with deletion access rights: \"BABUK.exe\" opened \"Z:\\1609517662041$OK\" with delete access\n \"BABUK.exe\" opened \"Z:\\BABUK.exe\" with delete access",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.7414792,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.75757482,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.71067018,
                "Label": 1
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.69118848,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.69471591,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.76816312,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.75469209,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.73103419,
                "Label": 1
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.75770178,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.72746156,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.76550023,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.71272049,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.70557728,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.75732913,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.74560529,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.75937896,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.7744874,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.78380887,
                "Label": 1
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.7856574,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.74115605,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Tries to access non-existent files: \"<Input Sample.exe\" trying to access non-existent file \"%WINDIR%\\system32\\rpcss.dll\"\n \"<Input Sample.exe\" trying to access non-existent file \"C:\\PROPSYS.dll\"\n \"<Input Sample.exe\" trying to access non-existent file \"C:\\cmd.exe\"\n \"<Input Sample.exe\" trying to access non-existent file \"C:\\CLDAPI.dll\"\n \"<Input Sample.exe\" trying to access non-existent file \"C:\\AEPIC.dll\"\n \"<Input Sample.exe\" trying to access non-existent file \"C:\\edputil.dll\"\n \"<Input Sample.exe\" trying to access non-existent file \"C:\\urlmon.dll\"\n \"<Input Sample.exe\" trying to access non-existent file \"C:\\iertutil.dll\"\n \"<Input Sample.exe\" trying to access non-existent file \"%WINDIR%\\System32\\cmd.exe:Zone.Identifier\"\n \"<Input Sample.exe\" trying to access non-existent file \"C:\\cscapi.dll\"\n \"cmd.exe\" trying to access non-existent file \"C:\\VSSADMIN.EXE\"\n \"cmd.exe\" trying to access non-existent file \"C:\\vssadmin.exe\"",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.70020799,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.7062268,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.66604849,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.66553066,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.70286778,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.74201116,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.76950702,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.6916717,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.74445734,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.74689661,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.75452557,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.68358965,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.71868409,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.76138663,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.76800101,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.75913118,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.72741533,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.7841498,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.7532903,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.77905546,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Hooks API calls: \"Wow64Transition@NTDLL.DLL\" in \"<Input Sample.exe\"",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.69852305,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.69570604,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.67337455,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.67190166,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.69461287,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.75891206,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.73156632,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.67399319,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.72304906,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.79463526,
                "Label": 1
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.79340939,
                "Label": 1
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.68930343,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.7096779,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.76175538,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.75030625,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.72835344,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.72114657,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.73151422,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.73680194,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.80877845,
                "Label": 1
            }
        ]
    },
    {
        "Indicator": "Creates mutants: \"\\Sessions\\1\\BaseNamedObjects\\Local\\RstrMgr3887CAB8-533F-4C85-B0DC-3E5639F8D511\"\n \"\\Sessions\\1\\BaseNamedObjects\\Local\\RstrMgr-3887CAB8-533F-4C85-B0DC-3E5639F8D511-Session0000\"\n \"Local\\RstrMgr-3887CAB8-533F-4C85-B0DC-3E5639F8D511-Session0000\"\n \"Local\\RstrMgr3887CAB8-533F-4C85-B0DC-3E5639F8D511\"\n \"Local\\SM0:5464:168:WilStaging_02\"\n \"Local\\ZonesLockedCacheCounterMutex\"\n \"Global\\SyncRootManager\"\n \"Local\\SM0:5464:64:WilError_01\"\n \"Local\\ZonesCacheCounterMutex\"\n \"Local\\RstrMgr-3887CAB8-533F-4C85-B0DC-3E5639F8D511-Session0001\"\n \"\\Sessions\\1\\BaseNamedObjects\\Local\\SM0:5464:168:WilStaging_02\"\n \"\\Sessions\\1\\BaseNamedObjects\\Local\\SM0:5464:64:WilError_01\"\n \"\\Sessions\\1\\BaseNamedObjects\\Global\\SyncRootManager\"\n \"\\Sessions\\1\\BaseNamedObjects\\Local\\ZonesCacheCounterMutex\"\n \"\\Sessions\\1\\BaseNamedObjects\\Local\\ZonesLockedCacheCounterMutex\"\n \"\\Sessions\\1\\BaseNamedObjects\\Local\\RstrMgr-3887CAB8-533F-4C85-B0DC-3E5639F8D511-Session0001\"",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.69434855,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.71599945,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.66971161,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.66405881,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.69541318,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.71925755,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.73107849,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.71557451,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.71455489,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.69944464,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.7328671,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.68829129,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.72674049,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.73655945,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.72017461,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.72879352,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.72529086,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.7771951,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.70191614,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.733386,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Calls an API typically used for taking snapshot of the specified processes: \"<Input Sample.exe\" called \"CreateToolhelp32Snapshot\" (UID: 00000000-00005464)",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.69814993,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.69175451,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.6932297,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.67459087,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.69564377,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.83351337,
                "Label": 1
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.76458177,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.69267674,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.75231275,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.74131564,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.7609221,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.72346658,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.7427289,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.77010742,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.73885275,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.7227572,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.71653541,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.76373633,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.77528326,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.79068506,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Possibly checks for the presence of a forensics/monitoring tool: \"ocssd.exe\" (Indicator: \"ocssd.exe\")\n \"dbsnmp.exe\" (Indicator: \"dbsnmp.exe\")\n \"synctime.exe\" (Indicator: \"synctime.exe\")\n \"agntsvc.exe\" (Indicator: \"agntsvc.exe\")\n \"xfssvccon.exe\" (Indicator: \"xfssvccon.exe\")\n \"mydesktopservice.exe\" (Indicator: \"mydesktopservice.exe\")\n \"ocautoupds.exe\" (Indicator: \"ocautoupds.exe\")\n \"encsvc.exe\" (Indicator: \"encsvc.exe\")\n \"mydesktopqos.exe\" (Indicator: \"mydesktopqos.exe\")\n \"ocomm.exe\" (Indicator: \"ocomm.exe\")\n \"dbeng50.exe\" (Indicator: \"dbeng50.exe\")\n \"infopath.exe\" (Indicator: \"infopath.exe\")\n \"mspub.exe\" (Indicator: \"mspub.exe\")\n \"onenote.exe\" (Indicator: \"onenote.exe\")\n \"steam.exe\" (Indicator: \"steam.exe\")\n \"thebat.exe\" (Indicator: \"thebat.exe\")\n \"visio.exe\" (Indicator: \"visio.exe\")",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.68394542,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.6850258,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.67981257,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.66900089,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.70255318,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.74405293,
                "Label": 1
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.81340084,
                "Label": 1
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.70163532,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.74174736,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.71664412,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.75754903,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.70547544,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.78003032,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.70742207,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.72107267,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.74443094,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.68989573,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.75866658,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.74016277,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.76282956,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Possibly tries to detect the presence of a debugger: GetProcessHeap@KERNEL32.DLL at 00000000-00005464-41422-5-010F4F90",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.72316942,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.70175719,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.71975516,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.6987873,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.72999132,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.78877225,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.77488892,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.72059217,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.75627713,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.74974469,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.78557499,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.72607849,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.73365783,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.77740464,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.75585682,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.75157461,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.74264747,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.75658967,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.79681628,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.83917405,
                "Label": 1
            }
        ]
    },
    {
        "Indicator": "Contains ability to determine disk drive type (API string): Observed api string:\"GetDriveTypeW\" [Source: 8203c2f00ecd3ae960cb3247a7d7bfb35e55c38939607c85dbdb5c92f0495fa9.bin]",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.69294078,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.68664827,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.66862513,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.70168934,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.72388609,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.71654672,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.69409132,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.6802044,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.7094972,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.74985561,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.76373603,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.70417038,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.71333287,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.75283008,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.76588596,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.7467694,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.73313039,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.72530811,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.71389911,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.77252182,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Queries kernel debugger information: \"vssadmin.exe\" at 00065417-00003716-00000033-106647377\n \"DismHost.exe\" at 00074149-00003180-00000033-2245216",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.70620114,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.70285992,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.69882799,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.68046371,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.71771568,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.75960925,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.77818392,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.70975205,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.77974503,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.741602,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.76938928,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.72186273,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.76944466,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.7544681,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.7208024,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.7397225,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.71970796,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.74409643,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.76650811,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.78830405,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Queries kernel debugger information: \"vssadmin.exe\" at 00064569-00003196-00000105-123032",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.72138987,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.71039379,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.70710173,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.69193631,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.72169678,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.75903087,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.76505923,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.71572493,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.79713229,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.74487467,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.7721143,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.73106665,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.76334489,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.75543382,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.72734727,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.75251359,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.72883203,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.73191012,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.76522611,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.77358682,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Contains ability to enumerates all mounted drives: GetDriveTypeW@KERNEL32.DLL at 00000000-00005464-41422-1-010F49C0",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.70392,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.68922847,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.68542942,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.69759331,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.74888884,
                "Label": 1
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.75850851,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.72043869,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.69028943,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.73844636,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.74500007,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.77203784,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.74585097,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.73287638,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.77285872,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.79882762,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.73557155,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.73102592,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.74774923,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.73488443,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.77329162,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Calls an API typically used to get system version information: \"<Input Sample.exe\" called \"RtlGetVersion\" with parameter  (UID: 00000000-00005464)\n \"<Input Sample.exe\" called \"RtlGetVersion\" with parameter  (UID: 00000000-00005464)\n \"<Input Sample.exe\" called \"RtlGetVersion\" (UID: 00000000-00005464)\n \"<Input Sample.exe\" called \"RtlGetVersion\" with parameter  (UID: 00000000-00005464)\n \"cmd.exe\" called \"RtlGetVersion\" (UID: 00000000-00006112)",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.68137912,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.67771862,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.63527812,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.65500981,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.68380567,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.72381199,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.71474861,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.65969427,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.73445318,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.71499417,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.74475366,
                "Label": 1
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.69597102,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.69207389,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.78175455,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.72752731,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.7113193,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.72181729,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.74076602,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.72599215,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.77773943,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Contains ability to dynamically determine API calls: Found GetProcAddress() and LoadLibraryA() in an import section (Source: 8203c2f00ecd3ae960cb3247a7d7bfb35e55c38939607c85dbdb5c92f0495fa9.bin)",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.73520205,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.70872121,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.70039552,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.71593732,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.73642921,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.75668458,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.71592659,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.70783733,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.70059237,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.74504905,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.76506919,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.73318309,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.71541525,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.78405572,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.78625107,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.73815373,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.76778534,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.76774895,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.72831634,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.82913625,
                "Label": 1
            }
        ]
    },
    {
        "Indicator": "Contains ability to enumerate files on disk (API string): Observed api string:\"FindFirstFileW\" [Source: 8203c2f00ecd3ae960cb3247a7d7bfb35e55c38939607c85dbdb5c92f0495fa9.bin]\n Observed api string:\"FindNextFileW\" [Source: 8203c2f00ecd3ae960cb3247a7d7bfb35e55c38939607c85dbdb5c92f0495fa9.bin]",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.71495738,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.69891784,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.66794674,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.70290477,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.73774695,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.75905291,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.71888837,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.69083447,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.7238495,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.75261029,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.75894628,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.71078742,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.71634324,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.76312349,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.85489664,
                "Label": 1
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.75191522,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.76402559,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.76814945,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.71779459,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.77447,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Drops files marked as clean: Antivirus vendors marked dropped file \"DISMHOST.EXE.5FEF4C01.bin\" as clean (type is \"PE32 executable (GUI) Intel 80386 for MS Windows\")",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.74769269,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.7618924,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.72831444,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.72247886,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.7456373,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.74137499,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.75774627,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.73335523,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.74538651,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.74713776,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.77078652,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.70174225,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.74603929,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.74811225,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.73286674,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.76724345,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.7310108,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.75843191,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.76543023,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.75990369,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Queries sensitive IE security settings: \"<Input Sample>.exe\" (Path: \"HKCU\\SOFTWARE\\MICROSOFT\\INTERNET EXPLORER\\SECURITY\"; Key: \"DISABLESECURITYSETTINGSCHECK\")",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.7221907,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.71937836,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.69884804,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.7053294,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.72545551,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.73094706,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.74601793,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.71797087,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.75489552,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.74573751,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.73790534,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.68343342,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.73097293,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.73716339,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.7281636,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.75541294,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.73670094,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.74526777,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.74593694,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.7565079,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Overview of unique CLSIDs touched in registry: \"<Input Sample.exe\" touched \"Computer\" (Path: \"HKLM\\SOFTWARE\\CLASSES\\WOW6432NODE\\CLSID\\{20D04FE0-3AEA-1069-A2D8-08002B30309D}\\INPROCSERVER32\")\n \"<Input Sample.exe\" touched \"Network\" (Path: \"HKCU\\WOW6432NODE\\CLSID\\{208D2C60-3AEA-1069-A2D7-08002B30309D}\\SHELLFOLDER\")\n \"<Input Sample.exe\" touched \"Recycle Bin\" (Path: \"HKCU\\WOW6432NODE\\CLSID\\{645FF040-5081-101B-9F08-00AA002F954E}\\SHELLFOLDER\")\n \"<Input Sample.exe\" touched \"Control Panel\" (Path: \"HKCU\\WOW6432NODE\\CLSID\\{26EE0668-A00A-44D7-9371-BEB064C98683}\\SHELLFOLDER\")\n \"<Input Sample.exe\" touched \"UsersFiles\" (Path: \"HKCU\\WOW6432NODE\\CLSID\\{59031A47-3F72-44A7-89C5-5595FE6B30EE}\\SHELLFOLDER\")\n \"<Input Sample.exe\" touched \"UsersLibraries\" (Path: \"HKCU\\WOW6432NODE\\CLSID\\{031E4825-7B94-4DC3-B131-E946B44C8DD5}\\SHELLFOLDER\")\n \"<Input Sample.exe\" touched \"CLSID_SearchFolder\" (Path: \"HKCU\\WOW6432NODE\\CLSID\\{04731B67-D933-450A-90E6-4ACD2E9408FE}\\SHELLFOLDER\")\n \"<Input Sample.exe\" touched \"IE History and Feeds Shell Data Source for Windows Search\" (Path: \"HKCU\\WOW6432NODE\\CLSID\\{11016101-E366-4D22-BC06-4ADA335C892B}\\SHELLFOLDER\")\n \"<Input Sample.exe\" touched \"Public Folder\" (Path: \"HKCU\\WOW6432NODE\\CLSID\\{4336A54D-038B-4685-AB02-99BB52D3FB8B}\\SHELLFOLDER\")\n \"<Input Sample.exe\" touched \"Control Panel command object for Start menu and desktop\" (Path: \"HKCU\\WOW6432NODE\\CLSID\\{5399E694-6CE5-4D6C-8FCE-1D8870FDCBA0}\\SHELLFOLDER\")\n \"<Input Sample.exe\" touched \"This Device\" (Path: \"HKCU\\WOW6432NODE\\CLSID\\{5B934B42-522B-4C34-BBFE-37A3EF7B9C90}\\SHELLFOLDER\")\n \"<Input Sample.exe\" touched \"@%systemroot%\\system32\\mssvp.dll,-110\" (Path: \"HKCU\\WOW6432NODE\\CLSID\\{89D83576-6BD1-4C86-9454-BEB04E94C819}\\SHELLFOLDER\")\n \"<Input Sample.exe\" touched \"CLSID_SearchHome\" (Path: \"HKCU\\WOW6432NODE\\CLSID\\{9343812E-1C37-4A49-A12E-4B2D810D956B}\\SHELLFOLDER\")\n \"<Input Sample.exe\" touched \"CLSID_StartMenuLauncherProviderFolder\" (Path: \"HKCU\\WOW6432NODE\\CLSID\\{98F275B4-4FFF-11E0-89E2-7B86DFD72085}\\SHELLFOLDER\")\n \"<Input Sample.exe\" touched \"CLSID_StartMenuCommandingProviderFolder\" (Path: \"HKCU\\WOW6432NODE\\CLSID\\{A00EE528-EBD9-48B8-944A-8942113D46AC}\\SHELLFOLDER\")\n \"<Input Sample.exe\" touched \"CLSID_AppInstanceFolder\" (Path: \"HKLM\\SOFTWARE\\WOW6432NODE\\MICROSOFT\\WINDOWS\\CURRENTVERSION\\EXPLORER\\CLSID\\{64693913-1C21-4F30-A98F-4E52906D3B56}\\SHELLFOLDER\")\n \"<Input Sample.exe\" touched \"Other Users Folder\" (Path: \"HKCU\\WOW6432NODE\\CLSID\\{B4FB3F98-C1EA-428D-A78A-D1F5659CBA93}\\SHELLFOLDER\")\n \"<Input Sample.exe\" touched \"@%systemroot%\\system32\\mssvp.dll,-112\" (Path: \"HKCU\\WOW6432NODE\\CLSID\\{BD7A2E7B-21CB-41B2-A086-B309680C6B7E}\\SHELLFOLDER\")\n \"<Input Sample.exe\" touched \"CLSID_StartMenuProviderFolder\" (Path: \"HKCU\\WOW6432NODE\\CLSID\\{DAF95313-E44D-46AF-BE1B-CBACEA2C3065}\\SHELLFOLDER\")\n \"<Input Sample.exe\" touched \"CLSID_StartMenuPathCompleteProviderFolder\" (Path: \"HKCU\\WOW6432NODE\\CLSID\\{E345F35F-9397-435C-8F95-4E922C26259E}\\SHELLFOLDER\")",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.69778368,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.69838423,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.66834221,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.67834997,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.7015221,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.75789079,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.75507561,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.69608974,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.73152074,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.74114888,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.77176911,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.69807632,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.75324214,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.74233498,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.76215938,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.73096379,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.73031541,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.76428932,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.73959293,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.77487642,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Possibly tries to communicate over SSL connection (HTTPS): \"d contact us.\n\nHow to contact us? \n----------------------------------------------\nUsing TOR Browser ( https://www.torproject.org/download/ ):\nhttp://babukq4e2p4wu4iq.onion/login.php?id=8M60J4vCbbkKgM6QnA07E9qpkn0Qk7\n\n!!! DANGER !!!\nDO NOT MODIFY or try to RECOVER any files yourself. We WILL NOT be able to RESTORE them. \n!!! DANGER !!\" (Indicator: \"https://\")",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.75588273,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.74816747,
                "Label": 1
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.69400352,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.73307331,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.74393225,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.68092372,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.67684211,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.70050949,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.66972762,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.68232934,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.69350699,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.6622108,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.6739947,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.68299163,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.68167614,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.74219396,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.72241961,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.7085464,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.70798552,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.71298656,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Touches files in the Windows directory: \"BABUK.exe\" touched file \"C:\\Windows\\Globalization\\Sorting\\SortDefault.nls\"\n \"BABUK.exe\" touched file \"%LOCALAPPDATA%\\Microsoft\\Windows\\Caches\"\n \"BABUK.exe\" touched file \"%LOCALAPPDATA%\\Microsoft\\Windows\\Caches\\cversions.1.db\"\n \"BABUK.exe\" touched file \"%LOCALAPPDATA%\\Microsoft\\Windows\\Caches\\{AFBF9F1A-8EE8-4C77-AF34-C647E37CA0D9}.1.ver0x0000000000000027.db\"\n \"cmd.exe\" touched file \"C:\\Windows\\Globalization\\Sorting\\SortDefault.nls\"\n \"cmd.exe\" touched file \"C:\\Windows\\AppPatch\\sysmain.sdb\"\n \"cmd.exe\" touched file \"C:\\Windows\\System32\\vssadmin.exe\"\n \"vssadmin.exe\" touched file \"C:\\Windows\\System32\\en-US\\vssadmin.exe.mui\"\n \"vssadmin.exe\" touched file \"C:\\Windows\\System32\\rsaenh.dll\"\n \"vssadmin.exe\" touched file \"C:\\Windows\\Globalization\\Sorting\\SortDefault.nls\"\n \"DismHost.exe\" touched file \"C:\\Windows\\TEMP\\AA4A7562-6CA9-4374-8CC6-55A2608F2E37\\en-US\\dismhost.exe.mui\"\n \"DismHost.exe\" touched file \"C:\\Windows\\TEMP\\AA4A7562-6CA9-4374-8CC6-55A2608F2E37\\en\\dismhost.exe.mui\"\n \"DismHost.exe\" touched file \"C:\\Windows\\System32\\kernel32.dll\"\n \"DismHost.exe\" touched file \"C:\\Windows\\Logs\\DISM\\dism.log\"\n \"DismHost.exe\" touched file \"C:\\Windows\\winsxs\\x86_microsoft-windows-servicingstack_31bf3856ad364e35_6.1.7601.23505_none_0bfc08bf3ea166ba\\CbsCore.dll\"",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.73653042,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.75187931,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.7258387,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.68676156,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.71436336,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.78739323,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.79185086,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.72627087,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.75536111,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.74979415,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.78534814,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.7187433,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.75833091,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.76612605,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.78263445,
                "Label": 1
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.77672041,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.74969593,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.76547789,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.77820798,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.77393861,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Queries volume information: \"<Input Sample.exe\" queries volume information of \"C:\\share\\network.pcapng\" at 00000000-00005464-00000049-6920416\n \"<Input Sample.exe\" queries volume information of \"C:\\$WINDOWS.~BT\\Sources\\Panther\\compatscancache.dat\" at 00000000-00005464-00000049-6927637\n \"<Input Sample.exe\" queries volume information of \"C:\\found.000\\dir0001.chk\\amd64_microsoft-windows-m..aphostres.resources_31bf3856ad364e35_10.0.17134.1_nl-nl_1290eff48e8094d0.manifest\" at 00000000-00005464-00000049-7054204\n \"<Input Sample.exe\" queries volume information of \"C:\\found.000\\dir0001.chk\\amd64_microsoft-windows-m..etmailcsp.resources_31bf3856ad364e35_10.0.17134.1_en-us_96611701049c6174\\internetmailcsp.dll.mui\" at 00000000-00005464-00000049-7399230\n \"<Input Sample.exe\" queries volume information of \"C:\\$WINDOWS.~BT\\Sources\\Panther\\appraiser.sdb\" at 00000000-00005464-00000049-7556756\n \"<Input Sample.exe\" queries volume information of \"C:\\$WINDOWS.~BT\\Sources\\wimprovider.dll\" at 00000000-00005464-00000049-7661136\n \"<Input Sample.exe\" queries volume information of \"C:\\found.000\\dir0001.chk\\amd64_microsoft-windows-m..aphostres.resources_31bf3856ad364e35_10.0.17134.1_zh-tw_bd07a659ea0b4f4b.manifest\" at 00000000-00005464-00000049-7731553\n \"<Input Sample.exe\" queries volume information of \"C:\\found.000\\dir0001.chk\\amd64_microsoft-windows-m..aphostres.resources_31bf3856ad364e35_10.0.17134.1_zh-tw_bd07a659ea0b4f4b.manifest\" at 00000000-00005464-00000049-7795606\n \"<Input Sample.exe\" queries volume information of \"C:\\found.000\\dir0001.chk\\amd64_microsoft-windows-m..aphostres.resources_31bf3856ad364e35_10.0.17134.1_nl-nl_1290eff48e8094d0.manifest\" at 00000000-00005464-00000049-7943506\n \"<Input Sample.exe\" queries volume information of \"C:\\$WINDOWS.~BT\\Sources\\appraiser.sdb\" at 00000000-00005464-00000049-7998527\n \"<Input Sample.exe\" queries volume information of \"C:\\$WINDOWS.~BT\\Sources\\appraiser.sdb\" at 00000000-00005464-00000049-8051150\n \"<Input Sample.exe\" queries volume information of \"C:\\found.000\\dir0001.chk\\amd64_microsoft-windows-m..aphostres.resources_31bf3856ad364e35_10.0.17134.1_nl-nl_1290eff48e8094d0.manifest\" at 00000000-00005464-00000049-8132729\n \"<Input Sample.exe\" queries volume information of \"C:\\found.000\\dir0001.chk\\amd64_microsoft-windows-m..aphostres.resources_31bf3856ad364e35_10.0.17134.1_nl-nl_1290eff48e8094d0.manifest\" at 00000000-00005464-00000049-8202982\n \"<Input Sample.exe\" queries volume information of \"C:\\$WINDOWS.~BT\\Sources\\wimprovider.dll\" at 00000000-00005464-00000049-8283742\n \"<Input Sample.exe\" queries volume information of \"C:\\found.000\\dir0001.chk\\amd64_microsoft-windows-m..aphostres.resources_31bf3856ad364e35_10.0.17134.1_nl-nl_1290eff48e8094d0.manifest\" at 00000000-00005464-00000049-8348030\n \"<Input Sample.exe\" queries volume information of \"C:\\$WINDOWS.~BT\\Sources\\appraiser.sdb\" at 00000000-00005464-00000049-8415380\n \"<Input Sample.exe\" queries volume information of \"M:\\Boot\\es-ES\\bootmgr.exe.mui\" at 00000000-00005464-00000049-8485538\n \"<Input Sample.exe\" queries volume information of \"C:\\$WINDOWS.~BT\\DUDownload\\Setup\\winsetup.dll\" at 00000000-00005464-00000049-8555240\n \"<Input Sample.exe\" queries volume information of \"C:\\found.000\\dir0001.chk\\amd64_microsoft-windows-m..aphostres.resources_31bf3856ad364e35_10.0.17134.1_hu-hu_437851c0dcd16fec.manifest\" at 00000000-00005464-00000049-8628117\n \"<Input Sample.exe\" queries volume information of \"C:\\$WINDOWS.~BT\\DUDownload\\Setup\\winsetup.dll\" at 00000000-00005464-00000049-8699417",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.6998603,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.69868776,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.68421849,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.68001983,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.71123049,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.74377362,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.73792082,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.70961974,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.75030245,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.73696723,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.76193321,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.70389095,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.72590561,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.74055614,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.76016339,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.74816313,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.73748336,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.74075034,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.72911335,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.77601392,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Installs hooks/patches the running process: \"<Input Sample>.exe\" wrote bytes \"b890125573ffe0\" to virtual address \"0x74B93AD8\" (part of module \"SSPICLI.DLL\")\n \"<Input Sample>.exe\" wrote bytes \"d83a0200\" to virtual address \"0x74B94E38\" (part of module \"SSPICLI.DLL\")\n \"<Input Sample>.exe\" wrote bytes \"d83a0200\" to virtual address \"0x74B94D78\" (part of module \"SSPICLI.DLL\")\n \"<Input Sample>.exe\" wrote bytes \"d83ab974\" to virtual address \"0x74BA0258\" (part of module \"SSPICLI.DLL\")\n \"<Input Sample>.exe\" wrote bytes \"b436b974\" to virtual address \"0x74BA0278\" (part of module \"SSPICLI.DLL\")\n \"<Input Sample>.exe\" wrote bytes \"b436b974\" to virtual address \"0x74BA025C\" (part of module \"SSPICLI.DLL\")\n \"<Input Sample>.exe\" wrote bytes \"d83ab974\" to virtual address \"0x74BA01FC\" (part of module \"SSPICLI.DLL\")\n \"<Input Sample>.exe\" wrote bytes \"b810155573ffe0\" to virtual address \"0x74B936B4\" (part of module \"SSPICLI.DLL\")\n \"<Input Sample>.exe\" wrote bytes \"c0df2f771cf92e77ccf82e770d64307700000000c011397600000000fc3e397600000000e0133976000000009457847525e02f77c6e02f7700000000bc6a837500000000cf3139760000000093198475000000002c32397600000000\" to virtual address \"0x758E1000\" (part of module \"NSI.DLL\")\n \"<Input Sample>.exe\" wrote bytes \"d83ab974\" to virtual address \"0x74BA0274\" (part of module \"SSPICLI.DLL\")\n \"<Input Sample>.exe\" wrote bytes \"a0115573\" to virtual address \"0x75D4E324\" (part of module \"WININET.DLL\")\n \"<Input Sample>.exe\" wrote bytes \"b4360200\" to virtual address \"0x74B94D68\" (part of module \"SSPICLI.DLL\")\n \"<Input Sample>.exe\" wrote bytes \"68130000\" to virtual address \"0x76341680\" (part of module \"WS2_32.DLL\")\n \"<Input Sample>.exe\" wrote bytes \"d83ab974\" to virtual address \"0x74BA01E0\" (part of module \"SSPICLI.DLL\")\n \"<Input Sample>.exe\" wrote bytes \"b436b974\" to virtual address \"0x74BA0200\" (part of module \"SSPICLI.DLL\")\n \"<Input Sample>.exe\" wrote bytes \"b880115573ffe0\" to virtual address \"0x76341368\" (part of module \"WS2_32.DLL\")\n \"<Input Sample>.exe\" wrote bytes \"71117c007a3b7b00ab8b02007f950200fc8c0200729602006cc805001ecd78007d267800\" to virtual address \"0x76B907E4\" (part of module \"USER32.DLL\")\n \"<Input Sample>.exe\" wrote bytes \"b4360200\" to virtual address \"0x74B94EA4\" (part of module \"SSPICLI.DLL\")\n \"<Input Sample>.exe\" wrote bytes \"b436b974\" to virtual address \"0x74BA01E4\" (part of module \"SSPICLI.DLL\")",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.71926699,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.70386641,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.7019824,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.69162587,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.70173926,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.77800205,
                "Label": 1
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.75937063,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.69738123,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.739047,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.74147596,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.76411204,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.67472744,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.72388684,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.75985333,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.73954517,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.72961286,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.74065896,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.7431721,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.75068976,
                "Label": 1
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.83067694,
                "Label": 1
            }
        ]
    },
    {
        "Indicator": "Queries process information: \"BABUK.exe\" queried SystemProcessInformation at 00064419-00002092-00000105-3483748\n \"BABUK.exe\" queried SystemProcessInformation at 00064419-00002092-00000105-3484011\n \"BABUK.exe\" queried SystemProcessInformation at 00064419-00002092-00000105-3486600\n \"BABUK.exe\" queried SystemProcessInformation at 00064419-00002092-00000105-3486988\n \"BABUK.exe\" queried SystemProcessInformation at 00064419-00002092-00000105-3489563\n \"BABUK.exe\" queried SystemProcessInformation at 00064419-00002092-00000105-3490049\n \"BABUK.exe\" queried SystemProcessInformation at 00064419-00002092-00000105-3490257",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.76288916,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.74918274,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.74707184,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.67723567,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.70398144,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.84871083,
                "Label": 1
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.80430199,
                "Label": 1
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.75163832,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.73860797,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.71807754,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.78954111,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.7700307,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.75105689,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.8094299,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.74739613,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.74243677,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.77807057,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.7623604,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.8409621,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.82170616,
                "Label": 0
            }
        ]
    },
    {
        "Indicator": "Process launched with changed environment: Process \"vssadmin.exe\" (UID: 00064569-00003196) was launched with new environment variables: \"PROMPT=\"$P$G\"\"\n Process \"DismHost.exe\" (UID: 00073376-00003488) was launched with modified environment variables: \"Path, LOCALAPPDATA, USERDOMAIN, TEMP, APPDATA, USERPROFILE, TMP\"\n Process \"DismHost.exe\" (UID: 00073376-00003488) was launched with missing environment variables: \"LOGONSERVER, PROMPT, HOMEPATH, HOMEDRIVE\"",
        "Threshold": 0.0,
        "Matched_Reports": [
            {
                "Report": "After effectively infiltrating the system, Babuk begins encrypting files using its own encryption algorithm based on the Salsa20 and RSA ciphers.",
                "Score": 0.70931894,
                "Label": 0
            },
            {
                "Report": "Babuk changes the extension of encrypted files to include its own unique extension and leaves a ransom message to restore the files.",
                "Score": 0.71093397,
                "Label": 0
            },
            {
                "Report": "Babuk also removes spear shadows and backups to increase pressure on the victim.",
                "Score": 0.69108208,
                "Label": 0
            },
            {
                "Report": "It protects its keys and encrypts files using its own implementation of SHA256 hashing, ChaCha8 encryption, and Elliptic-curve Diffie–Hellman (ECDH) key generation and exchange algorithm.",
                "Score": 0.66851758,
                "Label": 0
            },
            {
                "Report": "Similar to other ransomware, it can propagate its encryption by enumerating available network resources.",
                "Score": 0.71404777,
                "Label": 0
            },
            {
                "Report": "Using CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW to investigate all of the running processes on the system, Babuk can iterate and search for processes that need to be closed.",
                "Score": 0.75622734,
                "Label": 0
            },
            {
                "Report": "It will execute TerminateProcess to terminate any found processes. Here is the list of processes to be closed: sql.exe, oracle.exe, ocssd.exe, dbsnmp.exe, synctime.exe, agntsvc.exe, isqlplussvc.exe, xfssvccon.exe, mydesktopservice.exe, ocautoupds.exe, encsvc.exe, firefox.exe, tbirdconfig.exe, mydesktopqos.exe, ocomm.exe, dbeng50.exe, sqbcoreservice.exe, excel.exe, infopath.exe, msaccess.exe, mspub.exe, onenote.exe, outlook.exe, powerpnt.exe, steam.exe, thebat.exe, thunderbird.exe, visio.exe, winword.exe, wordpad.exe, notepad.exe",
                "Score": 0.78007161,
                "Label": 0
            },
            {
                "Report": "Babuk attempts to remove shadow duplicates prior to and following encryption.",
                "Score": 0.6994011,
                "Label": 0
            },
            {
                "Report": "Before invoking ShellExecuteW to execute the following command: cmd.exe /c vssadmin.exe delete shadows /all /quiet",
                "Score": 0.77395807,
                "Label": 0
            },
            {
                "Report": "Wow64DisableWow64FsRedirection is called to disable file system redirection.",
                "Score": 0.74493406,
                "Label": 0
            },
            {
                "Report": "After removing the shadow copies, Babuk verifies whether the system is powered by a 64-bit processor. If so, Wow64RevertWow64FsRedirection is invoked to re-enable file system redirection.",
                "Score": 0.7890953,
                "Label": 0
            },
            {
                "Report": "Babuk will call EnumDependentServicesA prior to terminating a service to retrieve the name and status of each dependent service.",
                "Score": 0.70418957,
                "Label": 0
            },
            {
                "Report": "It will then invoke ControlService with the control code SERVICE_CONTROL_STOP to halt them prior to terminating the primary service in the same manner. List of sevices: vss, sql, svc$, memtas, mepocs, sophos, veeam, backup, GxVss, GxBlr, GxFWD, GxCVD, GxCIMgr, DefWatch, ccEvtMgr, ccSetMgr, SavRoam, RTVscan, QBFCService, QBIDPService, Intuit.QuickBooks.FCS, QBCFMonitorService, YooBackup, YooIT, zhudongfangyu, sophos, stc_raw_agent, VSNAPVSS, VeeamTransportSvc, VeeamDeploymentService, VeeamNFSSvc, veeam, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, AcrSch2Svc, AcronisAgent, CASAD2DWebSvc, CAARCUpdateSvc",
                "Score": 0.75445095,
                "Label": 0
            },
            {
                "Report": "Babuk generates four random buffers using RtlGenRandom: RtlGenRandom - This function is available as a resource named SystemFunction036 in Advapi32.dll.",
                "Score": 0.72755988,
                "Label": 0
            },
            {
                "Report": "It navigates through each directory by using the FindFirstFileW and FindNextFileW methods in order to search for files and subdirectories.",
                "Score": 0.71939901,
                "Label": 0
            },
            {
                "Report": "When it comes across a file, it will perform a check to see if the file name is How To Restore Your data.txt or if the file extension is __NIST_K571__.",
                "Score": 0.71604482,
                "Label": 0
            },
            {
                "Report": "In order for Babuk to be able to decrypt files, the local public key is saved in the file ecdh_pub_k.bin, which is located in the APPDATA folder, something like this re-implementation: GetEnvironmentVariableW(L\"APPDATA\", pubkeypath, MAX_PATH); lstrcatW(pubkeypath, L\"\\\\ecdh_pub_k.bin\");",
                "Score": 0.7333677,
                "Label": 0
            },
            {
                "Report": "This makes sure that there is nothing that can stop it from opening the files and encrypting them: RmStartSession, RmRegisterResources, and RmGetList are the calls that must be made in order to fulfill this goal of retrieving a list of processes that are utilizing a particular file.",
                "Score": 0.7674413,
                "Label": 0
            },
            {
                "Report": "Babuk will attempt to terminate the process by using TerminateProcess if the process in question is not explorer.exe or a critical process.",
                "Score": 0.76969176,
                "Label": 0
            },
            {
                "Report": "Also re-implementing some utilities for tricks used in Babuk ransomware. Checks if the process is runnning of a 64bit machine: GetModuleHandleA(\"kernel32.dll\"), IsWow64Process_ = (pdef_IsWow64Process)GetProcAddress(hModule, \"IsWow64Process\"), if(IsWow64Process_ != NULL) if(!IsWow64Process_(GetCurrentProcess(), &bIsWow)), HeapAlloc, HeapFree, GetProcessHeap",
                "Score": 0.78442124,
                "Label": 0
            }
        ]
    }
]